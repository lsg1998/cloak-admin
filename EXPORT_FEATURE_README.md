# 订单导出功能升级说明

## 功能概述

本次更新将订单导出功能从CSV格式升级为XLSX格式，并添加了字段选择功能，让用户可以根据需要选择要导出的字段。

## 主要改进

### 1. 导出格式升级
- **之前**: 导出为CSV格式文件
- **现在**: 导出为XLSX格式文件（Excel格式）

### 2. 字段选择功能
- 新增字段选择对话框，用户可以选择要导出的字段
- 默认选择当前表格显示的主要字段
- 支持按字段分组显示（基本信息、商品信息、地址信息等）
- 提供全选、全不选、默认选择等快捷操作

### 3. 可导出字段列表

#### 基本信息
- 订单号
- 客户姓名
- 手机号
- 邮箱
- 订单状态
- 下单时间

#### 商品信息
- 商品标题
- 商品价格
- 数量
- 商品类型

#### 地址信息
- 省份
- 城市
- 区县
- 详细地址
- 邮编

#### 金额信息
- 订单金额
- 货币类型
- 支付方式

#### 时间信息
- 确认时间
- 发货时间
- 送达时间
- 更新时间

#### 技术信息
- IP地址
- 语言代码
- 来源URL
- 用户代理
- PD值

#### 其他信息
- 备注

## 技术实现

### 1. 新增依赖
- `xlsx`: 用于生成Excel文件
- `@types/xlsx`: TypeScript类型定义

### 2. 新增组件
- `ExportDialog`: 导出字段选择对话框组件
  - 位置: `src/components/ExportDialog/index.vue`
  - 功能: 字段选择、分组显示、快捷操作

### 3. API接口更新
- 更新了`ExportOrdersParams`接口，添加了`fields`和`format`参数
- 支持字段选择和格式指定

### 4. 页面功能更新
- 订单列表页面添加了导出字段选择功能
- 导出按钮现在会打开字段选择对话框
- 支持XLSX格式文件下载

## 使用方法

1. 在订单列表页面点击"导出"按钮
2. 在弹出的字段选择对话框中选择要导出的字段
3. 可以使用"全选"、"全不选"、"默认"等快捷操作
4. 点击"确认导出"开始导出
5. 系统会生成XLSX格式的Excel文件并自动下载

## 文件结构

```
admin/
├── src/
│   ├── components/
│   │   └── ExportDialog/
│   │       └── index.vue          # 导出字段选择对话框
│   ├── views/
│   │   └── order/
│   │       └── list/
│   │           └── index.vue       # 订单列表页面（已更新）
│   └── api/
│       └── modules/
│           └── order.ts           # 订单API接口（已更新）
└── package.json                   # 依赖包（已更新）
```

## 注意事项

1. 确保后端API支持字段选择和XLSX格式导出
2. 导出的文件名为：`订单列表_YYYY-MM-DD.xlsx`
3. 默认选择的字段与当前表格显示的主要字段保持一致
4. 支持按搜索条件导出，导出的数据会根据当前的搜索条件进行过滤

## 兼容性

- 支持现代浏览器
- 需要后端API支持新的导出参数
- 建议使用最新版本的Excel或WPS打开导出的文件
