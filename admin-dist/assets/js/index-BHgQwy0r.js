import{d as y,h as i,P as R,aq as W,ar as q,as as G,at as J,Z as Q,r,Q as Z,c as g,o as d,b as a,w as o,F as j,f as H,g as h,a as l,z as K,y as X,t as m,W as ee,e as k,u as te,au as ae,M as oe,N as se}from"./index-BnedJ701.js";import"./index-BpCvQqaw.js";import{O as le,a as re,g as ne}from"./order-DpqhS0jv.js";import{aU as D}from"./installCanvasRenderer-Bf4uGEF_.js";import{_ as z}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ce={class:"order-statistics-component"},ie={class:"stat-content"},de={class:"stat-info"},ue={class:"stat-value"},_e={class:"stat-label"},pe={class:"chart-header"},me={class:"table-header"},fe={class:"amount"},ve=y({__name:"index",setup(O){const f=i(!1),u=i([new Date(Date.now()-30*24*60*60*1e3).toISOString().slice(0,10),new Date().toISOString().slice(0,10)]),b=i(),S=i(),A=i(null),_=R([{key:"total",label:"总订单数",value:"0",icon:W,color:"#409EFF"},{key:"amount",label:"总销售额",value:"¥0",icon:q,color:"#67C23A"},{key:"pending",label:"待处理",value:"0",icon:G,color:"#E6A23C"},{key:"completed",label:"已完成",value:"0",icon:J,color:"#67C23A"}]),C=i([]),E=e=>le[e]||"info",F=e=>re[e]||e,L=e=>{_[0].value=e.total_orders.toLocaleString();const t=Y(e.currency);_[1].value=`${t}${e.total_amount.toLocaleString()}`,_[2].value=e.pending_orders.toLocaleString(),_[3].value=e.completed_orders.toLocaleString()},Y=e=>({JPY:"¥",USD:"$",EUR:"€",CNY:"¥",GBP:"£"})[e]||e,M=e=>{const t=D(b.value),c={title:{text:"订单趋势",left:"center",textStyle:{fontSize:14,color:"#666"}},tooltip:{trigger:"axis"},legend:{data:["订单数量","销售额"],bottom:0},xAxis:{type:"category",data:e.trend_data.dates},yAxis:[{type:"value",name:"订单数",position:"left"},{type:"value",name:"销售额",position:"right"}],series:[{name:"订单数量",type:"line",data:e.trend_data.order_counts,smooth:!0,itemStyle:{color:"#409EFF"}},{name:"销售额",type:"bar",yAxisIndex:1,data:e.trend_data.amounts,itemStyle:{color:"#67C23A"}}]};t.setOption(c),window.addEventListener("resize",()=>{t.resize()})},T=e=>{const t=D(S.value),c={title:{text:"订单状态分布",left:"center",textStyle:{fontSize:14,color:"#666"}},tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},legend:{orient:"vertical",left:"left"},series:[{name:"订单状态",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"18",fontWeight:"bold"}},labelLine:{show:!1},data:e.status_distribution.map(n=>({value:n.value,name:n.name,itemStyle:{color:$(n.status)}}))}]};t.setOption(c),window.addEventListener("resize",()=>{t.resize()})},$=e=>({pending:"#E6A23C",confirmed:"#409EFF",processing:"#909399",shipped:"#67C23A",delivered:"#67C23A",cancelled:"#F56C6C",refunded:"#F56C6C"})[e]||"#909399",V=e=>{e&&w()},w=async()=>{f.value=!0;try{const{data:e}=await ne({start_date:u.value[0],end_date:u.value[1],limit:5});A.value=e,C.value=e.recent_orders,L(e),await oe(),M(e),T(e)}catch(e){console.error("加载统计数据失败:",e),se.error("加载统计数据失败")}finally{f.value=!1}};return Q(async()=>{await w()}),(e,t)=>{const c=r("el-icon"),n=r("el-card"),v=r("el-col"),x=r("el-row"),B=r("el-date-picker"),I=r("el-button"),p=r("el-table-column"),N=r("el-tag"),U=r("el-table"),P=Z("loading");return d(),g("div",ce,[a(x,{gutter:20,class:"stats-cards"},{default:o(()=>[(d(!0),g(j,null,H(_,s=>(d(),h(v,{xs:24,sm:12,md:6,key:s.key},{default:o(()=>[a(n,{class:"stat-card",shadow:"hover"},{default:o(()=>[l("div",ie,[l("div",{class:"stat-icon",style:K({backgroundColor:s.color})},[a(c,{size:24},{default:o(()=>[(d(),h(X(s.icon)))]),_:2},1024)],4),l("div",de,[l("div",ue,m(s.value),1),l("div",_e,m(s.label),1)])])]),_:2},1024)]),_:2},1024))),128))]),_:1}),a(x,{gutter:20,class:"charts-section"},{default:o(()=>[a(v,{xs:24,lg:12},{default:o(()=>[a(n,{class:"chart-card",shadow:"never"},{header:o(()=>[l("div",pe,[t[2]||(t[2]=l("span",null,"订单趋势",-1)),a(B,{modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=s=>u.value=s),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",onChange:V,size:"small"},null,8,["modelValue"])])]),default:o(()=>[l("div",{ref_key:"orderTrendChart",ref:b,class:"chart-container"},null,512)]),_:1})]),_:1}),a(v,{xs:24,lg:12},{default:o(()=>[a(n,{class:"chart-card",shadow:"never"},{header:o(()=>[...t[3]||(t[3]=[l("span",null,"订单状态分布",-1)])]),default:o(()=>[l("div",{ref_key:"orderStatusChart",ref:S,class:"chart-container"},null,512)]),_:1})]),_:1})]),_:1}),a(n,{class:"table-card",shadow:"never"},{header:o(()=>[l("div",me,[t[5]||(t[5]=l("span",null,"最近订单",-1)),a(I,{type:"primary",size:"small",onClick:t[1]||(t[1]=s=>e.$router.push("/order/list"))},{default:o(()=>[t[4]||(t[4]=k(" 查看全部 ",-1)),a(c,{class:"el-icon--right"},{default:o(()=>[a(te(ae))]),_:1})]),_:1})])]),default:o(()=>[ee((d(),h(U,{data:C.value,stripe:""},{default:o(()=>[a(p,{prop:"order_number",label:"订单号",width:"180"}),a(p,{prop:"customer_name",label:"客户",width:"120"}),a(p,{prop:"total_amount",label:"金额",width:"100",align:"center"},{default:o(({row:s})=>[l("span",fe,m(s.total_amount)+" "+m(s.currency),1)]),_:1}),a(p,{prop:"status",label:"状态",width:"100",align:"center"},{default:o(({row:s})=>[a(N,{type:E(s.status),size:"small"},{default:o(()=>[k(m(F(s.status)),1)]),_:2},1032,["type"])]),_:1}),a(p,{prop:"created_at",label:"下单时间","show-overflow-tooltip":""})]),_:1},8,["data"])),[[P,f.value]])]),_:1})])}}}),he=z(ve,[["__scopeId","data-v-7ab03bd6"]]),ge={class:"home"},ye=y({name:"home"}),be=y({...ye,setup(O){return(f,u)=>(d(),g("div",ge,[a(he)]))}}),De=z(be,[["__scopeId","data-v-36be5fae"]]);export{De as default};
