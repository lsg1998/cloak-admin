import{d as Q,h as k,P as G,Z as se,r as p,c as N,o as c,a as s,b as e,w as t,F as oe,f as ne,g as f,e as n,u as d,x as re,E as A,aP as K,t as i,n as M,aQ as T,aN as x,aA as ie,aR as de,aS as ue,aT as ce,aU as _e,aV as pe,aW as fe,ay as ve,N as z}from"./index-CFy-F2qQ.js";import{g as me}from"./product-D_7Hp4fP.js";import{_ as ge}from"./_plugin-vue_export-helper-DlAUqK2U.js";const he={class:"pixel-analytics"},be={class:"overview-stats"},ye={class:"stat-content"},Ce={class:"stat-icon total"},ke={class:"stat-info"},we={class:"stat-number"},Re={class:"stat-content"},Ve={class:"stat-icon revenue"},Me={class:"stat-info"},ze={class:"stat-number"},Pe={class:"stat-content"},Ie={class:"stat-icon cost"},Te={class:"stat-info"},xe={class:"stat-number"},De={class:"stat-content"},Ye={class:"stat-icon roi"},Fe={class:"stat-info"},Ne={class:"stat-number"},Ae={class:"card-header"},Oe={class:"platform-info"},Se={class:"platform-name"},Ue={class:"card-header"},Be={key:1},Le={class:"product-info"},Ee={class:"product-title"},qe={class:"card-header"},Ge={class:"chart-controls"},Ke={class:"chart-placeholder"},Qe=Q({name:"PixelAnalytics"}),We=Q({...Qe,setup(Ze){const O=k(!1),W=k(),D=k("conversions"),m=G({dateRange:[],platform:"",productId:""}),S=k([]),r=G({totalConversions:0,totalRevenue:0,totalCost:0,roi:0,conversionChange:0,revenueChange:0,costChange:0,roiChange:0}),P=k([]),Z=k([]),j=()=>{y()},U=()=>{y()},H=()=>{m.dateRange=[],m.platform="",m.productId="",y()},y=async()=>{O.value=!0;try{await new Promise(o=>setTimeout(o,1e3)),B(),z.success("数据加载成功")}catch{z.error("数据加载失败")}finally{O.value=!1}},J=async()=>{try{await new Promise(o=>setTimeout(o,500)),z.success("排行数据已更新")}catch{z.error("排行数据加载失败")}},B=()=>{const o=P.value.reduce((v,h)=>v+h.conversions,0),l=P.value.reduce((v,h)=>v+h.revenue,0),w=P.value.reduce((v,h)=>v+h.cost,0),C=w>0?Math.round((l/w-1)*100):0;r.totalConversions=o,r.totalRevenue=l,r.totalCost=w,r.roi=C,r.conversionChange=Math.random()*20-10,r.revenueChange=Math.random()*20-10,r.costChange=Math.random()*20-10,r.roiChange=Math.random()*20-10},X=()=>{D.value},$=o=>{z.info(`查看商品 ${o.title} 的详细数据`)},g=o=>o>=1e6?(o/1e6).toFixed(1)+"M":o>=1e3?(o/1e3).toFixed(1)+"K":o.toString(),L=o=>o>=5?"success":o>=3?"warning":"danger",E=o=>o>=300?"success":o>=200?"warning":"danger",ee=async()=>{try{const{data:o}=await me({page:1,size:1e3});S.value=o.list}catch(o){console.error("加载商品列表失败:",o)}};return se(()=>{ee(),y(),B()}),(o,l)=>{const w=p("el-date-picker"),C=p("el-form-item"),v=p("el-option"),h=p("el-select"),u=p("el-icon"),R=p("el-button"),te=p("el-form"),b=p("el-card"),I=p("el-col"),ae=p("el-row"),Y=p("el-avatar"),_=p("el-table-column"),V=p("el-tag"),q=p("el-table"),F=p("el-radio-button"),le=p("el-radio-group");return c(),N("div",he,[l[20]||(l[20]=s("div",{class:"page-header"},[s("h2",null,"像素跟踪数据"),s("p",null,"查看各平台的像素跟踪效果和转化数据")],-1)),e(b,{class:"filter-card",shadow:"never"},{default:t(()=>[e(te,{model:m,inline:"",class:"filter-form"},{default:t(()=>[e(C,{label:"时间范围"},{default:t(()=>[e(w,{modelValue:m.dateRange,"onUpdate:modelValue":l[0]||(l[0]=a=>m.dateRange=a),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",onChange:j},null,8,["modelValue"])]),_:1}),e(C,{label:"平台"},{default:t(()=>[e(h,{modelValue:m.platform,"onUpdate:modelValue":l[1]||(l[1]=a=>m.platform=a),placeholder:"选择平台",clearable:"",onChange:U},{default:t(()=>[e(v,{label:"全部平台",value:""}),e(v,{label:"Google Ads",value:"google_ads"}),e(v,{label:"Facebook",value:"facebook"}),e(v,{label:"TikTok",value:"tiktok"})]),_:1},8,["modelValue"])]),_:1}),e(C,{label:"商品"},{default:t(()=>[e(h,{modelValue:m.productId,"onUpdate:modelValue":l[2]||(l[2]=a=>m.productId=a),placeholder:"选择商品",clearable:"",filterable:"",onChange:U},{default:t(()=>[e(v,{label:"全部商品",value:""}),(c(!0),N(oe,null,ne(S.value,a=>(c(),f(v,{key:a.id,label:a.title,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(C,null,{default:t(()=>[e(R,{type:"primary",onClick:y},{default:t(()=>[e(u,null,{default:t(()=>[e(d(re))]),_:1}),l[4]||(l[4]=n(" 查询 ",-1))]),_:1}),e(R,{onClick:H},{default:t(()=>[e(u,null,{default:t(()=>[e(d(A))]),_:1}),l[5]||(l[5]=n(" 重置 ",-1))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),s("div",be,[e(ae,{gutter:20},{default:t(()=>[e(I,{span:6},{default:t(()=>[e(b,{class:"stat-card"},{default:t(()=>[s("div",ye,[s("div",Ce,[e(u,null,{default:t(()=>[e(d(K))]),_:1})]),s("div",ke,[s("div",we,i(r.totalConversions),1),l[6]||(l[6]=s("div",{class:"stat-label"},"总转化数",-1)),s("div",{class:M(["stat-change",r.conversionChange>=0?"positive":"negative"])},[e(u,null,{default:t(()=>[r.conversionChange>=0?(c(),f(d(T),{key:0})):(c(),f(d(x),{key:1}))]),_:1}),n(" "+i(Math.abs(r.conversionChange))+"% ",1)],2)])])]),_:1})]),_:1}),e(I,{span:6},{default:t(()=>[e(b,{class:"stat-card"},{default:t(()=>[s("div",Re,[s("div",Ve,[e(u,null,{default:t(()=>[e(d(ie))]),_:1})]),s("div",Me,[s("div",ze,"¥"+i(g(r.totalRevenue)),1),l[7]||(l[7]=s("div",{class:"stat-label"},"总收入",-1)),s("div",{class:M(["stat-change",r.revenueChange>=0?"positive":"negative"])},[e(u,null,{default:t(()=>[r.revenueChange>=0?(c(),f(d(T),{key:0})):(c(),f(d(x),{key:1}))]),_:1}),n(" "+i(Math.abs(r.revenueChange))+"% ",1)],2)])])]),_:1})]),_:1}),e(I,{span:6},{default:t(()=>[e(b,{class:"stat-card"},{default:t(()=>[s("div",Pe,[s("div",Ie,[e(u,null,{default:t(()=>[e(d(de))]),_:1})]),s("div",Te,[s("div",xe,"¥"+i(g(r.totalCost)),1),l[8]||(l[8]=s("div",{class:"stat-label"},"总成本",-1)),s("div",{class:M(["stat-change",r.costChange>=0?"positive":"negative"])},[e(u,null,{default:t(()=>[r.costChange>=0?(c(),f(d(T),{key:0})):(c(),f(d(x),{key:1}))]),_:1}),n(" "+i(Math.abs(r.costChange))+"% ",1)],2)])])]),_:1})]),_:1}),e(I,{span:6},{default:t(()=>[e(b,{class:"stat-card"},{default:t(()=>[s("div",De,[s("div",Ye,[e(u,null,{default:t(()=>[e(d(ue))]),_:1})]),s("div",Fe,[s("div",Ne,i(r.roi)+"%",1),l[9]||(l[9]=s("div",{class:"stat-label"},"ROI",-1)),s("div",{class:M(["stat-change",r.roiChange>=0?"positive":"negative"])},[e(u,null,{default:t(()=>[r.roiChange>=0?(c(),f(d(T),{key:0})):(c(),f(d(x),{key:1}))]),_:1}),n(" "+i(Math.abs(r.roiChange))+"% ",1)],2)])])]),_:1})]),_:1})]),_:1})]),e(b,{class:"platform-comparison",shadow:"never"},{header:t(()=>[s("div",Ae,[l[11]||(l[11]=s("span",null,"平台效果对比",-1)),e(R,{size:"small",onClick:y},{default:t(()=>[e(u,null,{default:t(()=>[e(d(A))]),_:1}),l[10]||(l[10]=n(" 刷新 ",-1))]),_:1})])]),default:t(()=>[e(q,{data:P.value,stripe:"",border:""},{default:t(()=>[e(_,{prop:"platform",label:"平台",width:"120"},{default:t(({row:a})=>[s("div",Oe,[e(Y,{size:32,class:M(`platform-avatar ${a.platform}`)},{default:t(()=>[a.platform==="google_ads"?(c(),f(u,{key:0},{default:t(()=>[e(d(ce))]),_:1})):a.platform==="facebook"?(c(),f(u,{key:1},{default:t(()=>[e(d(_e))]),_:1})):(c(),f(u,{key:2},{default:t(()=>[e(d(pe))]),_:1}))]),_:2},1032,["class"]),s("span",Se,i(a.platformName),1)])]),_:1}),e(_,{prop:"impressions",label:"展示次数",width:"120",align:"right"},{default:t(({row:a})=>[n(i(g(a.impressions)),1)]),_:1}),e(_,{prop:"clicks",label:"点击次数",width:"120",align:"right"},{default:t(({row:a})=>[n(i(g(a.clicks)),1)]),_:1}),e(_,{prop:"conversions",label:"转化次数",width:"120",align:"right"},{default:t(({row:a})=>[n(i(g(a.conversions)),1)]),_:1}),e(_,{prop:"conversionRate",label:"转化率",width:"100",align:"right"},{default:t(({row:a})=>[e(V,{type:L(a.conversionRate),size:"small"},{default:t(()=>[n(i(a.conversionRate)+"% ",1)]),_:2},1032,["type"])]),_:1}),e(_,{prop:"cost",label:"成本",width:"120",align:"right"},{default:t(({row:a})=>[n(" ¥"+i(g(a.cost)),1)]),_:1}),e(_,{prop:"revenue",label:"收入",width:"120",align:"right"},{default:t(({row:a})=>[n(" ¥"+i(g(a.revenue)),1)]),_:1}),e(_,{prop:"roi",label:"ROI",width:"100",align:"right"},{default:t(({row:a})=>[e(V,{type:E(a.roi),size:"small"},{default:t(()=>[n(i(a.roi)+"% ",1)]),_:2},1032,["type"])]),_:1}),e(_,{prop:"cpa",label:"CPA",width:"120",align:"right"},{default:t(({row:a})=>[n(" ¥"+i(g(a.cpa)),1)]),_:1})]),_:1},8,["data"])]),_:1}),e(b,{class:"product-ranking",shadow:"never"},{header:t(()=>[s("div",Ue,[l[13]||(l[13]=s("span",null,"商品效果排行",-1)),e(R,{size:"small",onClick:J},{default:t(()=>[e(u,null,{default:t(()=>[e(d(A))]),_:1}),l[12]||(l[12]=n(" 刷新 ",-1))]),_:1})])]),default:t(()=>[e(q,{data:Z.value,stripe:"",border:""},{default:t(()=>[e(_,{type:"index",label:"排名",width:"80",align:"center"},{default:t(({$index:a})=>[a<3?(c(),f(V,{key:0,type:a===0?"danger":a===1?"warning":"success",size:"small"},{default:t(()=>[n(i(a+1),1)]),_:2},1032,["type"])):(c(),N("span",Be,i(a+1),1))]),_:1}),e(_,{prop:"title",label:"商品标题","min-width":"200","show-overflow-tooltip":""},{default:t(({row:a})=>[s("div",Le,[a.image_urls&&a.image_urls[0]?(c(),f(Y,{key:0,size:32,src:a.image_urls[0],shape:"square"},null,8,["src"])):(c(),f(Y,{key:1,size:32,shape:"square"},{default:t(()=>[e(u,null,{default:t(()=>[e(d(fe))]),_:1})]),_:1})),s("span",Ee,i(a.title),1)])]),_:1}),e(_,{prop:"conversions",label:"转化数",width:"100",align:"right"},{default:t(({row:a})=>[n(i(g(a.conversions)),1)]),_:1}),e(_,{prop:"revenue",label:"收入",width:"120",align:"right"},{default:t(({row:a})=>[n(" ¥"+i(g(a.revenue)),1)]),_:1}),e(_,{prop:"conversionRate",label:"转化率",width:"100",align:"right"},{default:t(({row:a})=>[e(V,{type:L(a.conversionRate),size:"small"},{default:t(()=>[n(i(a.conversionRate)+"% ",1)]),_:2},1032,["type"])]),_:1}),e(_,{prop:"roi",label:"ROI",width:"100",align:"right"},{default:t(({row:a})=>[e(V,{type:E(a.roi),size:"small"},{default:t(()=>[n(i(a.roi)+"% ",1)]),_:2},1032,["type"])]),_:1}),e(_,{label:"操作",width:"120",align:"center"},{default:t(({row:a})=>[e(R,{size:"small",type:"primary",link:"",onClick:je=>$(a)},{default:t(()=>[e(u,null,{default:t(()=>[e(d(ve))]),_:1}),l[14]||(l[14]=n(" 查看详情 ",-1))]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),e(b,{class:"trend-chart",shadow:"never"},{header:t(()=>[s("div",qe,[l[18]||(l[18]=s("span",null,"转化趋势",-1)),s("div",Ge,[e(le,{modelValue:D.value,"onUpdate:modelValue":l[3]||(l[3]=a=>D.value=a),size:"small",onChange:X},{default:t(()=>[e(F,{label:"conversions"},{default:t(()=>[...l[15]||(l[15]=[n("转化数",-1)])]),_:1}),e(F,{label:"revenue"},{default:t(()=>[...l[16]||(l[16]=[n("收入",-1)])]),_:1}),e(F,{label:"roi"},{default:t(()=>[...l[17]||(l[17]=[n("ROI",-1)])]),_:1})]),_:1},8,["modelValue"])])])]),default:t(()=>[s("div",{class:"chart-container",ref_key:"chartContainer",ref:W},[s("div",Ke,[e(u,{class:"chart-icon"},{default:t(()=>[e(d(K))]),_:1}),l[19]||(l[19]=s("p",null,"图表加载中...",-1))])],512)]),_:1})])}}}),$e=ge(We,[["__scopeId","data-v-e9ed0a92"]]);export{$e as default};
