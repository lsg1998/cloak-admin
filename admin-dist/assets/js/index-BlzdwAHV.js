import{a5 as Fe,d as Je,af as sa,h as v,ag as oa,D as Vl,ah as na,ai as ia,s as Ae,r as w,c as m,o as u,b as l,a as o,g as S,R as A,n as Oe,w as t,F as K,u as y,as as Tl,ba as ua,U as Ge,q as da,a7 as xl,N as c,$ as pe,P as be,a8 as nl,Z as ra,Q as pa,_ as ca,x as il,e as i,E as Sl,W as ul,aF as Ne,t as g,f as L,aE as Ul,aG as Cl,at as _a,ar as ma,aR as fa,bb as ga,bc as zl,bd as $l,G as Dl,be as va,bf as dl,aq as rl,aP as ya,a0 as he}from"./index-BffqHnU8.js";import{d as ka,c as ba,u as ha,a as wa,g as Pl,b as Ml,e as Kl,f as Va}from"./product-C1YgZwIS.js";import{c as xa}from"./cloakRule-BBkNAxEn.js";import{a as Sa}from"./domainConfig-CsbAFS9w.js";import{W as Ua}from"./index-BY3g7jGi.js";import{_ as Ll}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./upload-D36NVPSS.js";const Ca=M=>Fe.get(`/admin/products/${M}/skus`),Al=M=>Fe.post("/admin/product-skus",M),za=(M,ue)=>Fe.put(`/admin/product-skus/${M}`,ue),$a=M=>Fe.delete(`/admin/product-skus/${M}`),Da={class:"product-upload-box"},Pa=["src"],Ma={key:1,class:"upload-empty"},Ka={class:"el-upload__tip"},Aa=Je({name:"ProductUploadImg"}),Fa=Je({...Aa,props:{imageUrl:{default:""},drag:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},fileSize:{default:2},fileType:{default:()=>["image/jpeg","image/png","image/gif","image/webp"]},height:{default:"150px"},width:{default:"150px"},borderRadius:{default:"8px"}},emits:["update:imageUrl","update:image-url"],setup(M,{emit:ue}){sa(U=>({v5f6650a9:U.borderRadius,v6111d75b:U.width,b14bcb9c:U.height}));const Y=M,H=v("id-"+oa()),ee=v(!1),j=Vl(na,void 0),le=Vl(ia,void 0),E=Ae(()=>Y.disabled||(j==null?void 0:j.disabled)),ce=Ae(()=>"https://goworldshop.shop/admin/upload/image"),te=ue,we=()=>{te("update:imageUrl",""),te("update:image-url","")},ae=()=>{const U=document.querySelector(`#${H.value} .el-upload__input`);U&&U.dispatchEvent(new MouseEvent("click"))},Ve=U=>{const z=U.type.startsWith("image/"),I=U.size/1024/1024<Y.fileSize,q=Y.fileType.includes(U.type);return z?q?I?!0:(c.error(`图片大小不能超过 ${Y.fileSize}MB!`),!1):(c.error(`上传图片格式不正确，支持格式：${Y.fileType.join(", ")}`),!1):(c.error("只能上传图片文件!"),!1)},xe=U=>{U&&U.success&&U.data&&U.data.url?(te("update:imageUrl",U.data.url),te("update:image-url",U.data.url),c.success("图片上传成功!"),le!=null&&le.prop&&(j==null||j.validateField([le.prop]))):c.error("图片上传失败: "+(U.error||"未知错误"))},Se=()=>{c.error("图片上传失败，请重新上传!")};return(U,z)=>{const I=w("el-icon"),q=w("el-upload"),Z=w("el-image-viewer");return u(),m("div",Da,[l(q,{id:H.value,action:ce.value,class:Oe(["upload",E.value?"disabled":"",M.drag?"no-border":""]),multiple:!1,disabled:E.value,"show-file-list":!1,"before-upload":Ve,"on-success":xe,"on-error":Se,drag:M.drag,accept:M.fileType.join(",")},{default:t(()=>[M.imageUrl?(u(),m(K,{key:0},[o("img",{src:M.imageUrl,class:"upload-image"},null,8,Pa),o("div",{class:"upload-handle",onClick:z[1]||(z[1]=da(()=>{},["stop"]))},[E.value?A("",!0):(u(),m("div",{key:0,class:"handle-icon",onClick:ae},[l(I,null,{default:t(()=>[l(y(Tl))]),_:1}),z[3]||(z[3]=o("span",null,"编辑",-1))])),o("div",{class:"handle-icon",onClick:z[0]||(z[0]=B=>ee.value=!0)},[l(I,null,{default:t(()=>[l(y(ua))]),_:1}),z[4]||(z[4]=o("span",null,"查看",-1))]),E.value?A("",!0):(u(),m("div",{key:1,class:"handle-icon",onClick:we},[l(I,null,{default:t(()=>[l(y(Ge))]),_:1}),z[5]||(z[5]=o("span",null,"删除",-1))]))])],64)):(u(),m("div",Ma,[xl(U.$slots,"empty",{},()=>[l(I,null,{default:t(()=>[l(y(pe))]),_:1}),z[6]||(z[6]=o("span",null,"请上传图片",-1))],!0)]))]),_:3},8,["id","action","class","disabled","drag","accept"]),o("div",Ka,[xl(U.$slots,"tip",{},void 0,!0)]),ee.value?(u(),S(Z,{key:0,"url-list":[M.imageUrl],onClose:z[2]||(z[2]=B=>ee.value=!1)},null,8,["url-list"])):A("",!0)])}}}),Fl=Ll(Fa,[["__scopeId","data-v-937c0afd"]]),Ta={class:"product-management"},La={class:"table-header"},Ba={class:"table-title"},ja={class:"table-actions"},Ea={class:"product-info"},Ia=["src","alt"],qa={class:"product-details"},Ra={class:"product-title"},Na={class:"product-subtitle"},Oa={key:0,style:{"font-weight":"bold",color:"#ef3f52"}},Ga={key:1,style:{color:"#999999"}},Ja={key:0,style:{color:"#666666","text-decoration":"line-through"}},Wa={key:1,style:{color:"#999999"}},Ha={key:1,style:{color:"#999999"}},Za={key:0},Qa={key:0},Xa={key:1,style:{color:"#999999"}},Ya={key:1},es={style:{display:"flex","flex-wrap":"wrap",gap:"4px","align-items":"center"}},ls={key:2,style:{color:"#f56c6c"}},ts={key:0},as={key:1,style:{color:"#999999"}},ss={class:"count-info"},os={class:"count-info"},ns={class:"time-info"},is={class:"action-buttons"},us={class:"pagination-wrapper"},ds={style:{display:"flex","align-items":"center","justify-content":"space-between"}},rs={style:{"font-size":"12px",color:"#999999"}},ps={style:{display:"flex","align-items":"center","justify-content":"space-between"}},cs={class:"form-tip",style:{color:"#909399","font-size":"12px"}},_s={style:{display:"flex","align-items":"center",gap:"8px"}},ms={style:{display:"flex","align-items":"center",gap:"8px"}},fs={style:{display:"flex","align-items":"center",gap:"8px"}},gs={style:{display:"flex","align-items":"center",gap:"12px"}},vs={class:"editor-controls"},ys={class:"dialog-footer"},ks={class:"sku-management"},bs={class:"sku-list-section"},hs={class:"section-header"},ws={class:"sku-actions"},Vs=["src","alt"],xs={class:"sku-attributes"},Ss={class:"price"},Us={key:1,style:{color:"#999999"}},Cs={class:"sort-header"},zs={class:"sort-actions"},$s={class:"sort-tabs"},Ds={class:"attribute-sort-section"},Ps={class:"attribute-list"},Ms=["onDragstart","onDrop"],Ks={class:"attribute-content"},As={class:"sort-handle"},Fs={class:"attribute-info"},Ts={class:"attribute-name"},Ls={class:"attribute-count"},Bs={class:"sort-order"},js={class:"value-sort-section"},Es={class:"section-title"},Is={class:"value-list"},qs=["onDragstart","onDrop"],Rs={class:"value-content"},Ns={class:"sort-handle"},Os={class:"value-info"},Gs={class:"value-name"},Js={class:"value-count"},Ws={class:"sort-order"},Hs={class:"dialog-footer"},Zs={class:"batch-sku-generator"},Qs={style:{display:"flex","align-items":"center","justify-content":"space-between"}},Xs={key:0,class:"batch-preview"},Ys={class:"preview-grid"},eo={class:"sku-info"},lo={class:"sku-name"},to={class:"sku-specs"},ao={class:"dialog-footer"},so={class:"sku-specs"},oo={class:"add-spec-form"},no={key:0,class:"specs-list"},io={class:"specs-grid"},uo={class:"spec-content"},ro={class:"spec-name"},po={class:"spec-actions"},co={class:"image-input-section"},_o={class:"input-mode-selector"},mo={key:0,class:"url-input-mode"},fo={key:0,class:"url-preview"},go={class:"image-error"},vo={key:1,class:"upload-mode"},yo={class:"dialog-footer"},ko={class:"fake-product-selection"},bo={key:0,class:"product-summary"},ho=["src","alt"],wo={class:"product-info"},Vo={class:"product-title"},xo={class:"product-price"},So={style:{display:"flex","align-items":"center","justify-content":"space-between"}},Uo={class:"search-section"},Co={class:"fake-products-grid"},zo=["onClick"],$o=["src","alt"],Do={class:"card-content"},Po={class:"card-title"},Mo={class:"card-price"},Ko={class:"card-check"},Ao={key:0,class:"empty-state"},Fo={key:0,class:"fake-pagination"},To={class:"dialog-footer"},Lo={key:0,class:"domain-select-dialog"},Bo={class:"product-info"},jo={class:"domain-card"},Eo={class:"domain-header"},Io={class:"domain-name"},qo={class:"domain-url"},Ro={key:0,class:"domain-description"},No={class:"dialog-footer"},Oo=Je({name:"ProductList"}),Go=Je({...Oo,setup(M){const ue=v(!1),Y=v(!1),H=v(!1),ee=v(!1),j=v(null),le=v([]),E=v(null),ce=v(""),te=v(),we=v(!1),ae=v(!1),Ve=v(""),xe=v(!1),Se=v(!1),U=v(),z=v(null),I=v([]),q=v(""),Z=v(""),B=v([]),Ue=v("url"),O=be({title:"",status:null,product_type:""}),R=be({current:1,size:20,total:0}),Ce=v([]),G=v([]),_e=v(!1),p=be({id:null,spu_id:"",title:"",sell_price:0,origin_price:0,discount:0,image_urls:[],rich_text_content:"",specification_list:[],variants:[],status:"active",product_type:"original",b_page_product_id:[],cloak_rule_id:null,country:"JA",template:"classic",page_primary_color:"#007d65",head_w_marquee:""}),Te=v([]),Bl=v(["#007d65","#3498db","#e74c3c","#f39c12","#9b59b6","#e91e63","#1abc9c","#3f51b5"]),Le=v([]),ze=v(!1),me=v(!1),$=v(null),Be=v([]),je=v(!1),se=v(""),Ee=v(""),N=be({current:1,size:12,total:0}),$e=v(!1),We=v(!1),V=be({sell_price:0,origin_price:0,cost_price:0,discount_percent:0,stock_quantity:1e3,specs:[]}),J=v([]),De=v(!1),He=v(!1),pl=v("attribute"),oe=v([]),Pe=v({}),fe=v(-1),ge=v(-1),Ze=v(""),de=v(!1),ve=v(!1),jl=[{label:"日本",value:"JA"},{label:"中国",value:"ZH"},{label:"英国",value:"EN"},{label:"斯洛伐克",value:"SK"},{label:"斯洛文尼亚",value:"SI"},{label:"波兰",value:"PL"},{label:"葡萄牙",value:"PT"},{label:"匈牙利",value:"HU"},{label:"意大利",value:"IT"},{label:"西班牙",value:"ES"},{label:"捷克",value:"CZ"}],El=Ae(()=>ve.value?"calc(100vh - 200px)":"500px"),Il=Ae(()=>({placeholder:"请输入商品描述内容...",MENU_CONF:{uploadImage:{server:cl.value,fieldName:"file",maxFileSize:2*1024*1024,allowedFileTypes:["image/*"]}}})),cl=Ae(()=>"https://goworldshop.shop/admin/upload/image"),f=be({id:null,product_id:"",sku_code:"",sku_name:"",sell_price:0,origin_price:0,cost_price:0,discount_percent:0,stock_quantity:0,warning_stock:10,main_image:"",status:"active",attributes:[]}),ql={title:[{required:!0,message:"请输入商品标题",trigger:"blur"},{min:2,max:500,message:"商品标题长度在 2 到 500 个字符",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"change"}],page_primary_color:[{pattern:/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,message:"请输入有效的颜色代码，如 #007d65",trigger:"blur"}]},Rl={sku_name:[{required:!0,message:"请输入SKU名称",trigger:"blur"}],sell_price:[{required:!0,message:"请输入销售价格",trigger:"blur"}],stock_quantity:[{required:!0,message:"请输入库存数量",trigger:"blur"}]},Nl=()=>{if(f.origin_price>0&&f.sell_price>0){const s=Math.round((f.origin_price-f.sell_price)/f.origin_price*100);f.discount_percent=Math.max(0,Math.min(100,s))}else f.discount_percent=0};nl(()=>[f.sell_price,f.origin_price],()=>{Nl()},{deep:!0}),nl(()=>[p.sell_price,p.origin_price],()=>{Ye()},{deep:!0});const Ol=s=>({active:"success",inactive:"danger",draft:"warning",deleted:"info"})[s]||"info",Gl=s=>({active:"上架",inactive:"下架",draft:"草稿",deleted:"已删除"})[s]||s,Jl=s=>({active:"success",inactive:"danger",out_of_stock:"warning"})[s]||"info",Wl=s=>({active:"正常",inactive:"禁用",out_of_stock:"缺货"})[s]||s,Qe=()=>{R.current=1,W()},Hl=()=>{Object.assign(O,{title:"",status:null,product_type:""}),Qe()},Zl=()=>{ce.value="添加商品",Object.assign(p,{id:null,spu_id:"",title:"",sell_price:0,origin_price:0,discount:0,image_urls:[],rich_text_content:"",specification_list:[],variants:[],status:"active",product_type:"original",b_page_product_id:"",cloak_rule_id:null,country:"JA"}),Te.value=[],Le.value=[],G.value.length===0&&!_e.value&&tl(),G.value.length,G.value,H.value=!0},Ql=s=>{p.page_primary_color=s,c.success(`已切换到主题色：${s}`)},Xe=async s=>{j.value=s;try{const e=await Sa();le.value=e.data,le.value.length>0&&(E.value=le.value[0])}catch(e){console.error("加载域名配置失败:",e),c.error("加载域名配置失败")}ee.value=!0},Xl=()=>{if(!j.value||!E.value){c.warning("请选择域名");return}const s=`${E.value.protocol}://${E.value.domain}/product/${j.value.id}`;window.open(s,"_blank"),c.success("正在跳转到商品页面..."),ee.value=!1},Yl=s=>{ce.value="编辑商品",s.cloak_rule_id,s.cloak_rule_id;const e={...s,sell_price:parseFloat(s.sell_price)||0,origin_price:parseFloat(s.origin_price)||0,discount:parseFloat(s.discount)||0,product_type:s.product_type||"original",b_page_product_id:s.linked_original_ids&&s.linked_original_ids.length>0?s.linked_original_ids:s.b_page_product_id?[s.b_page_product_id]:[],country:s.country||"JA",template:s.template||"classic",cloak_rule_id:s.cloak_rule_id||null};e.cloak_rule_id,Object.assign(p,e),Te.value=(s.image_urls||[]).map((n,r)=>({name:`image_${r}.jpg`,url:n,response:{success:!0,data:{url:n,file_name:`image_${r}.jpg`}}})),G.value.length===0&&!_e.value&&tl(),G.value.length,p.cloak_rule_id,G.value,H.value=!0},et=s=>{he.confirm(`确定要删除商品 "${s.title}" 吗？删除后无法恢复！`,"删除确认",{confirmButtonText:"确定删除",cancelButtonText:"取消",type:"warning",confirmButtonClass:"el-button--danger"}).then(async()=>{try{await ka(s.id),c.success("删除成功"),W()}catch{c.error("删除失败")}})},lt=s=>{he.confirm(`确定要复制商品 "${s.title}" 吗？复制后的商品将以草稿状态保存，标题会添加"(复制)"后缀。`,"复制确认",{confirmButtonText:"确定复制",cancelButtonText:"取消",type:"info"}).then(async()=>{var e,n;try{const r=await ba(s.id);c.success(`复制成功！新商品ID: ${r.data.id}`),W()}catch(r){const d=((n=(e=r==null?void 0:r.response)==null?void 0:e.data)==null?void 0:n.message)||(r==null?void 0:r.message)||"复制失败";c.error(d),console.error("复制商品失败:",r)}})},tt=async()=>{te.value&&te.value.validate(async s=>{if(s){Y.value=!0;try{p.cloak_rule_id,p.cloak_rule_id,p.id?(p.id,await ha(p.id,p),c.success("更新成功")):(await wa(p),c.success("添加成功")),H.value=!1,W()}catch(e){console.error("提交失败:",e),c.error(p.id?"更新失败":"添加失败")}finally{Y.value=!1}}})},at=s=>{R.size=s,W()},st=s=>{R.current=s,W()},ot=s=>{const e=s.type.startsWith("image/"),n=s.size/1024/1024<2;return e?n?!0:(c.error("图片大小不能超过 2MB!"),!1):(c.error("只能上传图片文件!"),!1)},nt=(s,e)=>{s&&s.success&&s.data&&s.data.url?(p.image_urls.push(s.data.url),e.fileName=s.data.file_name,c.success("图片上传成功")):c.error("图片上传失败: "+(s.error||"未知错误"))},it=s=>{let e=null;if(s.response&&s.response.data&&s.response.data.url?e=s.response.data.url:s.url&&(e=s.url),e){const n=p.image_urls.indexOf(e);n>-1&&(p.image_urls.splice(n,1),p.image_urls)}},ut=()=>{c.error("图片上传失败")},dt=()=>{ve.value=!ve.value},rt=s=>{p.rich_text_content=s},pt=()=>{he.confirm("确定要清空商品描述内容吗？","清空确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{p.rich_text_content="",c.success("内容已清空")})},W=async()=>{ue.value=!0;try{const s={page:R.current,size:R.size,title:O.title||void 0,status:O.status||void 0,product_type:O.product_type||void 0},{data:e}=await Pl(s);e.list[0],Ce.value=e.list,R.total=e.total}catch{c.error("获取商品列表失败")}finally{ue.value=!1}},ct=async s=>{z.value=s,we.value=!0,await Ie(s.id)},Ie=async s=>{xe.value=!0;try{const{data:e}=await Ca(s);I.value=e}catch{c.error("获取SKU列表失败")}finally{xe.value=!1}},_t=()=>{if(!q.value.trim()||!Z.value.trim()){c.warning("请输入规格名称和值");return}const s=q.value.trim(),e=Z.value.trim();if(B.value.find(_=>_.name===s&&_.value===e)){c.warning(`规格 "${s}: ${e}" 已存在，请勿重复添加`);return}const r=B.value.find(_=>_.name===s);if(r){c.warning(`属性 "${s}" 已存在值 "${r.value}"，一个SKU的同一属性只能设置一个值。如需修改，请先删除现有规格。`);return}const d={name:s,value:e};B.value.push(d),q.value="",Z.value="",c.success("规格添加成功")},mt=s=>{B.value.splice(s,1),c.success("规格删除成功")},ft=s=>{const e=B.value[s];q.value=e.name,Z.value=e.value,B.value.splice(s,1),c.info("请修改规格信息后点击添加按钮")},gt=()=>{var r;Ve.value="添加SKU";const s=Date.now(),e=Math.floor(Math.random()*1e3).toString().padStart(3,"0"),n=`SKU${s}${e}`;Object.assign(f,{id:null,product_id:((r=z.value)==null?void 0:r.id)||"",sku_code:n,sku_name:"",sell_price:0,origin_price:0,cost_price:0,discount_percent:0,stock_quantity:0,warning_stock:10,main_image:"",status:"active",attributes:[]}),B.value=[],q.value="",Z.value="",ae.value=!0},vt=s=>{Ve.value="编辑SKU";const e={...s,sell_price:parseFloat(s.sell_price)||0,origin_price:parseFloat(s.origin_price)||0,cost_price:parseFloat(s.cost_price)||0,discount_percent:parseFloat(s.discount_percent)||0,stock_quantity:parseInt(s.stock_quantity)||0,warning_stock:parseInt(s.warning_stock)||10};Object.assign(f,e),B.value=s.attributes.map(n=>({name:n.attribute_name||n.display_name||"",value:n.value||n.display_value||"",attribute_id:n.attribute_id||null,attribute_value_id:n.attribute_value_id||null})),ae.value=!0},yt=s=>{he.confirm(`确定要删除SKU "${s.sku_name}" 吗？`,"删除确认",{confirmButtonText:"确定删除",cancelButtonText:"取消",type:"warning"}).then(async()=>{var e,n,r;try{await $a(s.id),c.success("删除成功"),await Ie(((e=z.value)==null?void 0:e.id)||"")}catch(d){console.error("删除SKU失败:",d);let _="删除失败";(r=(n=d.response)==null?void 0:n.data)!=null&&r.message?_=d.response.data.message:d.message&&(_=d.message),c.error(_)}})},kt=()=>{const s=B.value.map(n=>n.name),e=s.filter((n,r)=>s.indexOf(n)!==r);if(e.length>0)throw c.error(`检测到重复的属性名: ${e.join(", ")}，请检查规格设置`),new Error("存在重复的属性名");return B.value.map(n=>n.attribute_id&&n.attribute_value_id?{attribute_id:n.attribute_id,attribute_value_id:n.attribute_value_id}:{attribute_name:n.name,value:n.value})},bt=async()=>{U.value&&U.value.validate(async s=>{var e;if(s){Se.value=!0;try{const n={...f,attributes:kt()};f.id?(await za(f.id,n),c.success("更新成功")):(await Al(n),c.success("添加成功")),ae.value=!1,await Ie(((e=z.value)==null?void 0:e.id)||"")}catch(n){if(n.message==="存在重复的属性名")return;c.error(f.id?"更新失败":"添加失败")}finally{Se.value=!1}}})},ht=s=>{s!==Ue.value&&(f.main_image="")},wt=s=>{s==="original"?p.b_page_product_id=[]:s==="fake"&&(!p.b_page_product_id||p.b_page_product_id.length===0)&&ll()},Ye=()=>{const s=p.sell_price||0,e=p.origin_price||0;if(e>0&&s>0){const n=Math.round((e-s)/e*100);p.discount=Math.max(0,Math.min(100,n))}else(e===0||s===0)&&(p.discount=0)},Vt=()=>{Object.assign(V,{sell_price:0,origin_price:0,cost_price:0,discount_percent:0,stock_quantity:1e3,specs:[]}),J.value=[],$e.value=!0},_l=()=>{const s=V.origin_price||0,e=V.sell_price||0;if(s>0&&e>0){const n=Math.round((s-e)/s*100);V.discount_percent=Math.max(0,Math.min(100,n))}else V.discount_percent=0},xt=()=>{V.specs.push({name:"",values:""}),el()},St=s=>{V.specs.splice(s,1),el()},el=()=>{const s=V.specs.filter(_=>_.name.trim()&&_.values.trim());if(s.length===0){J.value=[];return}const e=s.map(_=>_.name.trim()),n=e.filter((_,P)=>e.indexOf(_)!==P);if(n.length>0){c.warning(`检测到重复的规格名称: ${n.join(", ")}，请确保每个规格名称唯一`),J.value=[];return}const r=s.map(_=>({name:_.name.trim(),values:_.values.split(`
`).map(P=>P.trim()).filter(P=>P)})),d=ml(r);J.value=d.map(_=>({sku_name:_.map(h=>`${h.name}:${h.value}`).join(" "),attributes:_}))},ml=s=>{if(s.length===0)return[];if(s.length===1)return s[0].values.map(_=>[{name:s[0].name,value:_}]);const e=[],n=s[0],r=s.slice(1),d=ml(r);for(const _ of n.values)for(const P of d)e.push([{name:n.name,value:_},...P]);return e};nl(()=>V.specs,()=>{el()},{deep:!0});const Ut=async()=>{var r;if(J.value.length===0){c.warning("请配置规格信息");return}if(!V.sell_price||!V.stock_quantity){c.warning("请填写销售价格和库存数量");return}const e=V.specs.filter(d=>d.name.trim()&&d.values.trim()).map(d=>d.name.trim()),n=e.filter((d,_)=>e.indexOf(d)!==_);if(n.length>0){c.error(`检测到重复的规格名称: ${n.join(", ")}，请确保每个规格名称唯一`);return}We.value=!0;try{const d=Date.now(),_=J.value.map(async(P,h)=>{var C;const b=d+h,ye=Math.floor(Math.random()*1e4).toString().padStart(4,"0"),ne=()=>{const X=V.origin_price||0,Me=V.sell_price||0;if(X>0&&Me>0){const Re=Math.round((X-Me)/X*100);return Math.max(0,Math.min(100,Re))}return 0},Q={product_id:((C=z.value)==null?void 0:C.id)||"",sku_code:`SKU${b}${ye}`,sku_name:P.sku_name,sell_price:V.sell_price,origin_price:V.origin_price,cost_price:V.cost_price,discount_percent:ne(),stock_quantity:V.stock_quantity,warning_stock:10,main_image:"",status:"active",attributes:P.attributes.map(X=>({attribute_name:X.name,value:X.value}))};return Al(Q)});await Promise.all(_),c.success(`成功生成 ${J.value.length} 个SKU`),$e.value=!1,await Ie(((r=z.value)==null?void 0:r.id)||"")}catch(d){console.error("批量生成SKU失败:",d),c.error("批量生成失败")}finally{We.value=!1}},Ct=()=>{$t(),de.value=!1,De.value=!0},zt=()=>{de.value=!de.value},$t=()=>{const s=new Map;I.value.forEach(e=>{e.attributes.forEach(n=>{const r=n.display_name||n.attribute_name,d=n.display_value||n.value;s.has(r)||s.set(r,new Map);const _=s.get(r);_.has(d)||_.set(d,[]),_.get(d).push(e)})}),oe.value=Array.from(s.keys()).map(e=>{const n=s.get(e),r=Array.from(n.values()).reduce((d,_)=>d+_.length,0);return{name:e,count:r,values:Array.from(n.keys())}}),Pe.value={},s.forEach((e,n)=>{Pe.value[n]=Array.from(e.keys()).map(r=>{const d=e.get(r);return{value:r,count:d.length,skus:d}})})},Dt=s=>Pe.value[s]||[],Pt=(s,e)=>{fe.value=e,s.dataTransfer&&(s.dataTransfer.effectAllowed="move")},Mt=(s,e)=>{if(s.preventDefault(),fe.value===-1||fe.value===e)return;const n=oe.value[fe.value];oe.value.splice(fe.value,1),oe.value.splice(e,0,n),fe.value=-1},Kt=(s,e,n)=>{ge.value=n,Ze.value=e,s.dataTransfer&&(s.dataTransfer.effectAllowed="move")},At=(s,e,n)=>{if(s.preventDefault(),ge.value===-1||Ze.value!==e||ge.value===n)return;const r=Pe.value[e],d=r[ge.value];r.splice(ge.value,1),r.splice(n,0,d),ge.value=-1,Ze.value=""},fl=s=>{s.preventDefault(),s.dataTransfer&&(s.dataTransfer.dropEffect="move")},Ft=async()=>{if(oe.value.length===0){c.warning("没有属性需要排序");return}He.value=!0;try{const s=[];oe.value.forEach(e=>{Pe.value[e.name].forEach(r=>{r.skus.forEach(d=>{s.find(_=>_.id===d.id)||s.push(d)})})}),I.value=s,await Tt(s),c.success("排序保存成功"),De.value=!1}catch(s){console.error("保存排序失败:",s),c.error("保存排序失败")}finally{He.value=!1}},Tt=async s=>{try{const e=s.map((r,d)=>({sku_id:r.id,sort_order:d+1})),n=await Fe.put(`/admin/products/${z.value.id}/skus/sort`,{sort_data:e});if(n.code!==200)throw new Error(n.message||"保存排序失败")}catch(e){throw console.error("保存排序到后端失败:",e),e}},Lt=()=>{const s=p.origin_price||0,e=p.discount||0;s>0&&e>=0&&(p.sell_price=Math.round(s*(1-e/100)*100)/100)},gl=()=>{const s=f.sell_price||0,e=f.origin_price||0;if(e>0&&s>0){const n=Math.round((e-s)/e*100);f.discount_percent=Math.max(0,Math.min(100,n))}else(e===0||s===0)&&(f.discount_percent=0)},Bt=()=>{const s=f.origin_price||0,e=f.discount_percent||0;s>0&&e>=0&&(f.sell_price=Math.round(s*(1-e/100)*100)/100)},jt=async s=>{if(!s){await ll();return}ze.value=!0;try{const{data:e}=await Ml(s);Le.value=e}catch{c.error("搜索正品商品失败")}finally{ze.value=!1}},ll=async()=>{ze.value=!0;try{const{data:s}=await Ml();Le.value=s}catch{c.error("加载正品商品列表失败")}finally{ze.value=!1}},vl=(s,e=!1)=>{const n=Ce.value.find(r=>r.id===s);return n?e&&n.title.length>10?n.title.substring(0,10)+"...":n.title:"未知商品"},yl=s=>Ce.value.filter(e=>e.product_type!=="fake"?!1:e.linked_original_ids&&Array.isArray(e.linked_original_ids)?e.linked_original_ids.includes(s):e.b_page_product_id===s),Et=s=>{const e=Ce.value.find(n=>n.id===s);e&&Xe(e)},It=s=>{$.value=s,se.value="",Ee.value="",N.current=1,me.value=!0,qe()},qe=async()=>{je.value=!0;try{const s={page:N.current,size:N.size,product_type:"fake",title:Ee.value||void 0},{data:e}=await Pl(s);Be.value=e.list.filter(n=>!n.b_page_product_id),N.total=e.total}catch{c.error("加载仿品商品列表失败")}finally{je.value=!1}},qt=()=>{N.current=1,qe()},Rt=s=>{N.size=s,qe()},Nt=s=>{N.current=s,qe()},Ot=async()=>{if(!(!se.value||!$.value))try{await Kl(se.value,$.value.id),c.success("仿品关联成功"),me.value=!1,W()}catch{c.error("仿品关联失败")}},Gt=async s=>{try{await he.confirm(`确定要取消仿品 "${s.title}" 的关联吗？取消后该仿品将不再关联任何正品。`,"取消关联确认",{confirmButtonText:"确定取消",cancelButtonText:"取消",type:"warning",confirmButtonClass:"el-button--danger"}),s.id,await Kl(s.id,null),c.success("取消关联成功"),W()}catch(e){e!=="cancel"&&c.error("取消关联失败")}},Jt=async s=>{try{await he.confirm(`确定要取消商品 "${s.title}" 的斗篷规则设置吗？取消后该商品将不再使用任何斗篷规则。`,"取消斗篷规则确认",{confirmButtonText:"确定取消",cancelButtonText:"取消",type:"warning",confirmButtonClass:"el-button--danger"}),s.id,await Va(s.id,null),c.success("取消斗篷规则设置成功"),W()}catch(e){e!=="cancel"&&c.error("取消斗篷规则设置失败")}},Wt=()=>{$.value&&(me.value=!1,ce.value="基于正品创建仿品",Object.assign(p,{id:null,spu_id:"",title:`${$.value.title} - 仿品版`,sell_price:Math.round(($.value.sell_price||0)*.6),origin_price:$.value.sell_price||0,discount:40,image_urls:[...$.value.image_urls||[]],rich_text_content:$.value.rich_text_content||"",specification_list:[...$.value.specification_list||[]],variants:[...$.value.variants||[]],status:"draft",product_type:"fake",b_page_product_id:$.value.id,cloak_rule_id:null,country:$.value.country||"JA"}),Te.value=($.value.image_urls||[]).map((s,e)=>({name:`image_${e}.jpg`,url:s,response:{success:!0,data:{url:s,file_name:`image_${e}.jpg`}}})),ll(),H.value=!0,c.success(`已基于正品"${$.value.title}"创建仿品，请修改相关信息后保存`))},tl=async()=>{if(!_e.value)try{_e.value=!0;const s=await xa.getCloakRules({page:1,size:1e3});if(s.code===200){const e=s.data.list,n=e.filter(r=>r.is_active===1);G.value=n,G.value}else console.error("斗篷规则API返回错误:",s)}catch(s){console.error("加载斗篷规则失败:",s),c.error("加载斗篷规则失败")}finally{_e.value=!1}},kl=s=>({cloak:"warning",green:"success",open:"info",audit:"danger"})[s]||"info",bl=s=>({cloak:"斗篷",green:"绿色",open:"全开",audit:"审核"})[s]||s,Ht=s=>{p.cloak_rule_id=s,s&&(G.value.find(n=>n.id===s)||console.warn("未找到对应的斗篷规则，ID:",s))};return ra(()=>{W(),tl()}),(s,e)=>{const n=w("el-icon"),r=w("el-input"),d=w("el-form-item"),_=w("el-option"),P=w("el-select"),h=w("el-tag"),b=w("el-button"),ye=w("el-form"),ne=w("el-card"),Q=w("el-avatar"),C=w("el-table-column"),X=w("el-tooltip"),Me=w("el-table"),Re=w("el-pagination"),F=w("el-input-number"),x=w("el-col"),T=w("el-row"),ke=w("el-radio"),al=w("el-radio-group"),Zt=w("el-color-picker"),Qt=w("arrow-down"),ie=w("el-dropdown-item"),Xt=w("el-dropdown-menu"),Yt=w("el-dropdown"),ea=w("el-upload"),re=w("el-dialog"),sl=w("el-alert"),hl=w("el-tab-pane"),la=w("el-tabs"),wl=w("el-divider"),ta=w("el-image"),aa=w("el-empty"),ol=pa("loading");return u(),m("div",Ta,[l(ne,{class:"search-card",shadow:"never"},{default:t(()=>[l(ye,{model:O,inline:"",class:"search-form"},{default:t(()=>[l(d,{label:"商品标题"},{default:t(()=>[l(r,{modelValue:O.title,"onUpdate:modelValue":e[0]||(e[0]=a=>O.title=a),placeholder:"请输入商品标题",clearable:"",style:{width:"200px"},onKeyup:ca(Qe,["enter"])},{prefix:t(()=>[l(n,null,{default:t(()=>[l(y(il))]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"状态"},{default:t(()=>[l(P,{modelValue:O.status,"onUpdate:modelValue":e[1]||(e[1]=a=>O.status=a),placeholder:"请选择状态",clearable:"",style:{width:"120px"}},{default:t(()=>[l(_,{label:"上架",value:"active"}),l(_,{label:"下架",value:"inactive"}),l(_,{label:"草稿",value:"draft"})]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"商品类型"},{default:t(()=>[l(P,{modelValue:O.product_type,"onUpdate:modelValue":e[2]||(e[2]=a=>O.product_type=a),placeholder:"请选择类型",clearable:"",style:{width:"120px"}},{default:t(()=>[l(_,{label:"全部",value:""},{default:t(()=>[l(h,{type:"info",size:"small"},{default:t(()=>[...e[60]||(e[60]=[i("全部",-1)])]),_:1})]),_:1}),l(_,{label:"正品",value:"original"},{default:t(()=>[l(h,{type:"success",size:"small"},{default:t(()=>[...e[61]||(e[61]=[i("正品",-1)])]),_:1})]),_:1}),l(_,{label:"仿品",value:"fake"},{default:t(()=>[l(h,{type:"warning",size:"small"},{default:t(()=>[...e[62]||(e[62]=[i("仿品",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(d,null,{default:t(()=>[l(b,{type:"primary",onClick:Qe},{default:t(()=>[l(n,null,{default:t(()=>[l(y(il))]),_:1}),e[63]||(e[63]=i(" 搜索 ",-1))]),_:1}),l(b,{onClick:Hl},{default:t(()=>[l(n,null,{default:t(()=>[l(y(Sl))]),_:1}),e[64]||(e[64]=i(" 重置 ",-1))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),l(ne,{class:"table-card",shadow:"never"},{header:t(()=>[o("div",La,[o("div",Ba,[l(b,{type:"primary",onClick:Zl},{default:t(()=>[l(n,null,{default:t(()=>[l(y(pe))]),_:1}),e[65]||(e[65]=i(" 添加商品 ",-1))]),_:1}),e[66]||(e[66]=o("span",null,"商品列表",-1)),l(h,{type:"info",size:"small"},{default:t(()=>[i(g(R.total)+" 条记录",1)]),_:1})]),o("div",ja,[l(b,{size:"small",onClick:W},{default:t(()=>[l(n,null,{default:t(()=>[l(y(Sl))]),_:1}),e[67]||(e[67]=i(" 刷新 ",-1))]),_:1})])])]),default:t(()=>[ul((u(),S(Me,{data:Ce.value,stripe:"",border:"",style:{width:"100%"},"header-cell-style":{background:"#f8f9fa",color:"#606266"}},{default:t(()=>[l(C,{prop:"title",label:"商品标题","min-width":"200","show-overflow-tooltip":""},{default:t(({row:a})=>[o("div",Ea,[a.image_urls&&a.image_urls[0]?(u(),S(Q,{key:0,size:40,class:"product-avatar"},{default:t(()=>[o("img",{src:a.image_urls[0],alt:a.title,style:{width:"100%",height:"100%","object-fit":"cover"}},null,8,Ia)]),_:2},1024)):(u(),S(Q,{key:1,size:40,class:"product-avatar"},{default:t(()=>[l(n,null,{default:t(()=>[l(y(Ne))]),_:1})]),_:1})),o("div",qa,[o("div",Ra,g(a.title),1),o("div",Na,g(a.sell_price?"¥"+a.sell_price:"暂未定价"),1)])])]),_:1}),l(C,{prop:"sell_price",label:"销售价",width:"90",align:"center"},{default:t(({row:a})=>[a.sell_price?(u(),m("span",Oa," ¥"+g(a.sell_price),1)):(u(),m("span",Ga,"--"))]),_:1}),l(C,{prop:"origin_price",label:"原价",width:"90",align:"center"},{default:t(({row:a})=>[a.origin_price&&a.origin_price>0?(u(),m("span",Ja," ¥"+g(a.origin_price),1)):(u(),m("span",Wa,"--"))]),_:1}),l(C,{prop:"discount",label:"折扣",width:"80",align:"center"},{default:t(({row:a})=>[a.discount&&a.discount>0?(u(),S(h,{key:0,type:"success",size:"small"},{default:t(()=>[i(g(a.discount)+"% OFF ",1)]),_:2},1024)):(u(),m("span",Ha,"--"))]),_:1}),l(C,{prop:"product_type",label:"类型",width:"100",align:"center"},{default:t(({row:a})=>[l(h,{type:a.product_type==="original"?"success":"warning",size:"small"},{default:t(()=>[i(g(a.product_type==="original"?"正品":"仿品"),1)]),_:2},1032,["type"])]),_:1}),l(C,{label:"关联关系",width:"150",align:"center"},{default:t(({row:a})=>[a.product_type==="original"?(u(),m("div",Za,[yl(a.id).length>0?(u(),m("div",Qa,[(u(!0),m(K,null,L(yl(a.id),k=>(u(),S(X,{key:k.id,content:`仿品: ${k.title}`,placement:"top"},{default:t(()=>[l(h,{type:"warning",size:"small",style:{margin:"2px",cursor:"pointer"},onClick:D=>Xe(k)},{default:t(()=>[...e[68]||(e[68]=[i(" 仿品 ",-1)])]),_:1},8,["onClick"])]),_:2},1032,["content"]))),128))])):(u(),m("span",Xa,"-"))])):a.linked_original_ids&&a.linked_original_ids.length>0?(u(),m("div",Ya,[o("div",es,[(u(!0),m(K,null,L(a.linked_original_ids,k=>(u(),S(X,{key:k,content:`关联正品: ${vl(k)}`,placement:"top"},{default:t(()=>[l(h,{type:"success",size:"small",style:{cursor:"pointer"},onClick:D=>Et(k)},{default:t(()=>[i(g(vl(k,!0)),1)]),_:2},1032,["onClick"])]),_:2},1032,["content"]))),128)),l(b,{size:"small",type:"danger",link:"",onClick:k=>Gt(a)},{default:t(()=>[l(n,null,{default:t(()=>[l(y(Ul))]),_:1}),e[69]||(e[69]=i(" 取消 ",-1))]),_:1},8,["onClick"])])])):(u(),m("span",ls,"未关联"))]),_:1}),l(C,{prop:"country",label:"国家",width:"80",align:"center"},{default:t(({row:a})=>[l(h,{type:"primary",size:"small"},{default:t(()=>[i(g(a.country||"JA"),1)]),_:2},1024)]),_:1}),l(C,{prop:"template",label:"展示模板",width:"120",align:"center"},{default:t(({row:a})=>[a.template==="shopline"?(u(),S(h,{key:0,type:"success",size:"small"},{default:t(()=>[...e[70]||(e[70]=[i(" Shopline ",-1)])]),_:1})):a.template==="standard"?(u(),S(h,{key:1,type:"warning",size:"small"},{default:t(()=>[...e[71]||(e[71]=[i(" Standard ",-1)])]),_:1})):(u(),S(h,{key:2,type:"info",size:"small"},{default:t(()=>[...e[72]||(e[72]=[i(" Classic ",-1)])]),_:1}))]),_:1}),l(C,{prop:"cloak_rule_name",label:"斗篷规则",width:"200",align:"center"},{default:t(({row:a})=>[a.cloak_rule_name?(u(),m("div",ts,[l(X,{content:`规则: ${a.cloak_rule_name}`,placement:"top"},{default:t(()=>[l(h,{type:kl(a.cloak_rule_mode),size:"small"},{default:t(()=>[i(g(a.cloak_rule_name),1)]),_:2},1032,["type"])]),_:2},1032,["content"]),l(b,{size:"small",type:"danger",link:"",onClick:k=>Jt(a),style:{"margin-left":"8px"}},{default:t(()=>[l(n,null,{default:t(()=>[l(y(Ul))]),_:1}),e[73]||(e[73]=i(" 取消设置 ",-1))]),_:1},8,["onClick"])])):(u(),m("span",as,"未设置"))]),_:1}),l(C,{prop:"status",label:"状态",width:"100",align:"center"},{default:t(({row:a})=>[l(h,{type:Ol(a.status),size:"small",effect:"light"},{default:t(()=>[i(g(Gl(a.status)),1)]),_:2},1032,["type"])]),_:1}),l(C,{prop:"view_count",label:"浏览量",width:"100",align:"center"},{default:t(({row:a})=>[o("div",ss,[l(n,{class:"count-icon"},{default:t(()=>[l(y(Cl))]),_:1}),o("span",null,g(a.view_count||0),1)])]),_:1}),l(C,{prop:"sale_count",label:"销量",width:"100",align:"center"},{default:t(({row:a})=>[o("div",os,[l(n,{class:"count-icon"},{default:t(()=>[l(y(_a))]),_:1}),o("span",null,g(a.sale_count||0),1)])]),_:1}),l(C,{prop:"created_at",label:"创建时间",width:"180","show-overflow-tooltip":""},{default:t(({row:a})=>[o("div",ns,[l(n,{class:"time-icon"},{default:t(()=>[l(y(ma))]),_:1}),o("span",null,g(a.created_at),1)])]),_:1}),l(C,{label:"操作",width:"420",fixed:"right",align:"center"},{default:t(({row:a})=>[o("div",is,[l(b,{size:"small",type:"primary",link:"",onClick:k=>Xe(a)},{default:t(()=>[l(n,null,{default:t(()=>[l(y(Cl))]),_:1}),e[74]||(e[74]=i(" 查看 ",-1))]),_:1},8,["onClick"]),l(b,{size:"small",type:"success",link:"",onClick:k=>ct(a)},{default:t(()=>[l(n,null,{default:t(()=>[l(y(fa))]),_:1}),e[75]||(e[75]=i(" SKU管理 ",-1))]),_:1},8,["onClick"]),a.product_type==="original"?(u(),S(b,{key:0,size:"small",type:"info",link:"",onClick:k=>It(a)},{default:t(()=>[l(n,null,{default:t(()=>[l(y(pe))]),_:1}),e[76]||(e[76]=i(" 关联仿品 ",-1))]),_:1},8,["onClick"])):A("",!0),l(b,{size:"small",type:"warning",link:"",onClick:k=>Yl(a)},{default:t(()=>[l(n,null,{default:t(()=>[l(y(Tl))]),_:1}),e[77]||(e[77]=i(" 编辑 ",-1))]),_:1},8,["onClick"]),l(b,{size:"small",type:"info",link:"",onClick:k=>lt(a)},{default:t(()=>[l(n,null,{default:t(()=>[l(y(ga))]),_:1}),e[78]||(e[78]=i(" 复制 ",-1))]),_:1},8,["onClick"]),l(b,{size:"small",type:"danger",link:"",onClick:k=>et(a)},{default:t(()=>[l(n,null,{default:t(()=>[l(y(Ge))]),_:1}),e[79]||(e[79]=i(" 删除 ",-1))]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["data"])),[[ol,ue.value]]),o("div",us,[l(Re,{"current-page":R.current,"onUpdate:currentPage":e[3]||(e[3]=a=>R.current=a),"page-size":R.size,"onUpdate:pageSize":e[4]||(e[4]=a=>R.size=a),"page-sizes":[10,20,50,100],total:R.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:at,onCurrentChange:st},null,8,["current-page","page-size","total"])])]),_:1}),l(re,{modelValue:H.value,"onUpdate:modelValue":e[20]||(e[20]=a=>H.value=a),title:ce.value,fullscreen:!0,"close-on-click-modal":!1,"destroy-on-close":"",class:"product-dialog"},{footer:t(()=>[o("div",ys,[l(b,{onClick:e[19]||(e[19]=a=>H.value=!1)},{default:t(()=>[...e[117]||(e[117]=[i("取消",-1)])]),_:1}),l(b,{type:"primary",onClick:tt,loading:Y.value},{default:t(()=>[...e[118]||(e[118]=[i(" 确定 ",-1)])]),_:1},8,["loading"])])]),default:t(()=>[l(ye,{model:p,rules:ql,ref_key:"formRef",ref:te,"label-width":"100px",class:"product-form"},{default:t(()=>[l(d,{label:"SPU ID"},{default:t(()=>[l(r,{modelValue:p.spu_id,"onUpdate:modelValue":e[5]||(e[5]=a=>p.spu_id=a),placeholder:"保存后生成",readonly:""},null,8,["modelValue"]),e[80]||(e[80]=o("div",{class:"form-tip"},"SPU ID由后端自动生成，创建商品后自动显示",-1))]),_:1}),l(d,{label:"商品标题",prop:"title"},{default:t(()=>[l(r,{modelValue:p.title,"onUpdate:modelValue":e[6]||(e[6]=a=>p.title=a),placeholder:"请输入商品标题"},null,8,["modelValue"])]),_:1}),l(T,{gutter:20},{default:t(()=>[l(x,{span:12},{default:t(()=>[l(d,{label:"销售价格",prop:"sell_price"},{default:t(()=>[l(F,{modelValue:p.sell_price,"onUpdate:modelValue":e[7]||(e[7]=a=>p.sell_price=a),precision:2,min:0,placeholder:"请输入销售价格",style:{width:"100%"},onChange:Ye},{append:t(()=>[...e[81]||(e[81]=[i("元",-1)])]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(x,{span:12},{default:t(()=>[l(d,{label:"原价",prop:"origin_price"},{default:t(()=>[l(F,{modelValue:p.origin_price,"onUpdate:modelValue":e[8]||(e[8]=a=>p.origin_price=a),precision:2,min:0,placeholder:"请输入原价",style:{width:"100%"},onChange:Ye},{append:t(()=>[...e[82]||(e[82]=[i("元",-1)])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(T,{gutter:20},{default:t(()=>[l(x,{span:12},{default:t(()=>[l(d,{label:"折扣(%)",prop:"discount"},{default:t(()=>[l(F,{modelValue:p.discount,"onUpdate:modelValue":e[9]||(e[9]=a=>p.discount=a),precision:0,min:0,max:100,placeholder:"自动计算",style:{width:"100%"},onChange:Lt},{append:t(()=>[...e[83]||(e[83]=[i("%",-1)])]),_:1},8,["modelValue"]),e[84]||(e[84]=o("div",{class:"form-tip"},"输入销售价和原价后自动计算，或手动输入折扣",-1))]),_:1})]),_:1}),l(x,{span:12},{default:t(()=>[l(d,{label:"状态",prop:"status"},{default:t(()=>[l(P,{modelValue:p.status,"onUpdate:modelValue":e[10]||(e[10]=a=>p.status=a),style:{width:"100%"}},{default:t(()=>[l(_,{label:"上架",value:"active"},{default:t(()=>[l(h,{type:"success",size:"small"},{default:t(()=>[...e[85]||(e[85]=[i("上架",-1)])]),_:1})]),_:1}),l(_,{label:"下架",value:"inactive"},{default:t(()=>[l(h,{type:"danger",size:"small"},{default:t(()=>[...e[86]||(e[86]=[i("下架",-1)])]),_:1})]),_:1}),l(_,{label:"草稿",value:"draft"},{default:t(()=>[l(h,{type:"warning",size:"small"},{default:t(()=>[...e[87]||(e[87]=[i("草稿",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(T,{gutter:20},{default:t(()=>[l(x,{span:12},{default:t(()=>[l(d,{label:"商品类型",prop:"product_type"},{default:t(()=>[l(al,{modelValue:p.product_type,"onUpdate:modelValue":e[11]||(e[11]=a=>p.product_type=a),onChange:wt},{default:t(()=>[l(ke,{value:"original"},{default:t(()=>[l(h,{type:"success",size:"small"},{default:t(()=>[...e[88]||(e[88]=[i("正品",-1)])]),_:1}),e[89]||(e[89]=i(" 正品商品 ",-1))]),_:1}),l(ke,{value:"fake"},{default:t(()=>[l(h,{type:"warning",size:"small"},{default:t(()=>[...e[90]||(e[90]=[i("仿品",-1)])]),_:1}),e[91]||(e[91]=i(" 仿品商品 ",-1))]),_:1})]),_:1},8,["modelValue"]),e[92]||(e[92]=o("div",{class:"form-tip"},"正品：用户默认看到的商品；仿品：替代展示的商品",-1))]),_:1})]),_:1}),l(x,{span:12},{default:t(()=>[p.product_type==="fake"?(u(),S(d,{key:0,label:"关联正品",prop:"b_page_product_id"},{default:t(()=>[l(P,{modelValue:p.b_page_product_id,"onUpdate:modelValue":e[12]||(e[12]=a=>p.b_page_product_id=a),placeholder:"请选择对应的正品商品（支持多选）",filterable:"",multiple:"","collapse-tags":"","collapse-tags-tooltip":"",remote:"","remote-method":jt,loading:ze.value,style:{width:"100%"}},{default:t(()=>[(u(!0),m(K,null,L(Le.value,a=>(u(),S(_,{key:a.id,label:`${a.title} - ¥${a.sell_price}`,value:a.id},{default:t(()=>[o("div",ds,[o("span",null,g(a.title),1),o("span",rs,"¥"+g(a.sell_price),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","loading"]),e[93]||(e[93]=o("div",{class:"form-tip"},"选择这个仿品对应的正品商品",-1))]),_:1})):A("",!0)]),_:1})]),_:1}),l(T,{gutter:20},{default:t(()=>[l(x,{span:12},{default:t(()=>[l(d,{label:"目标国家",prop:"country"},{default:t(()=>[l(P,{modelValue:p.country,"onUpdate:modelValue":e[13]||(e[13]=a=>p.country=a),placeholder:"请选择目标国家",style:{width:"100%"}},{default:t(()=>[(u(),m(K,null,L(jl,a=>l(_,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),e[94]||(e[94]=o("div",{class:"form-tip"},"选择商品投放的目标国家/地区",-1))]),_:1})]),_:1}),l(x,{span:12},{default:t(()=>[l(d,{label:"斗篷规则",prop:"cloak_rule_id"},{default:t(()=>[l(P,{modelValue:p.cloak_rule_id,"onUpdate:modelValue":e[14]||(e[14]=a=>p.cloak_rule_id=a),placeholder:"请选择斗篷规则",clearable:"",filterable:"",style:{width:"100%"},onChange:Ht,loading:_e.value},{default:t(()=>[(u(!0),m(K,null,L(G.value,a=>(u(),S(_,{key:a.id,label:`${a.name} (${bl(a.mode)})`,value:a.id},{default:t(()=>[o("div",ps,[o("span",null,g(a.name),1),l(h,{type:kl(a.mode),size:"small"},{default:t(()=>[i(g(bl(a.mode)),1)]),_:2},1032,["type"])])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","loading"]),e[95]||(e[95]=o("div",{class:"form-tip"},"选择商品使用的斗篷规则，控制不同用户看到的内容",-1)),o("div",cs,"当前加载了 "+g(G.value.length)+" 个斗篷规则",1)]),_:1})]),_:1})]),_:1}),l(T,{gutter:20},{default:t(()=>[l(x,{span:12},{default:t(()=>[l(d,{label:"展示模板",prop:"template"},{default:t(()=>[l(P,{modelValue:p.template,"onUpdate:modelValue":e[15]||(e[15]=a=>p.template=a),placeholder:"请选择展示模板",style:{width:"100%"}},{default:t(()=>[l(_,{label:"经典模板 (Classic)",value:"classic"},{default:t(()=>[o("div",_s,[l(h,{type:"info",size:"small"},{default:t(()=>[...e[96]||(e[96]=[i("Classic",-1)])]),_:1}),e[97]||(e[97]=o("span",null,"经典模板 - 单页表单设计",-1))])]),_:1}),l(_,{label:"现代模板 (Shopline)",value:"shopline"},{default:t(()=>[o("div",ms,[l(h,{type:"success",size:"small"},{default:t(()=>[...e[98]||(e[98]=[i("Shopline",-1)])]),_:1}),e[99]||(e[99]=o("span",null,"现代模板 - 分离式结账设计",-1))])]),_:1}),l(_,{label:"标准模板 (Standard)",value:"standard"},{default:t(()=>[o("div",fs,[l(h,{type:"warning",size:"small"},{default:t(()=>[...e[100]||(e[100]=[i("Standard",-1)])]),_:1}),e[101]||(e[101]=o("span",null,"标准模板 - 模块化高性能设计",-1))])]),_:1})]),_:1},8,["modelValue"]),e[102]||(e[102]=o("div",{class:"form-tip"},[o("strong",null,"Classic:"),i(" 传统单页设计，商品详情和表单在同一页 "),o("br"),o("strong",null,"Shopline:"),i(" 现代化设计，商品展示和结账分离，纯黑白简洁风格 "),o("br"),o("strong",null,"Standard:"),i(" 🔥 新版标准模板，模块化架构，高性能，易通过Google审核 ")],-1))]),_:1})]),_:1})]),_:1}),l(T,{gutter:20},{default:t(()=>[l(x,{span:12},{default:t(()=>[l(d,{label:"页面主题颜色",prop:"page_primary_color"},{default:t(()=>[o("div",gs,[l(Zt,{modelValue:p.page_primary_color,"onUpdate:modelValue":e[16]||(e[16]=a=>p.page_primary_color=a),"show-alpha":"",predefine:Bl.value,size:"large"},null,8,["modelValue","predefine"]),l(r,{modelValue:p.page_primary_color,"onUpdate:modelValue":e[17]||(e[17]=a=>p.page_primary_color=a),placeholder:"#007d65",style:{flex:"1"}},{prepend:t(()=>[...e[103]||(e[103]=[i("HEX",-1)])]),_:1},8,["modelValue"]),l(Yt,{trigger:"click",onCommand:Ql},{dropdown:t(()=>[l(Xt,null,{default:t(()=>[l(ie,{command:"#007d65"},{default:t(()=>[...e[105]||(e[105]=[o("div",{style:{display:"flex","align-items":"center",gap:"8px"}},[o("span",{style:{display:"inline-block",width:"16px",height:"16px",background:"#007d65","border-radius":"3px"}}),o("span",null,"森林绿（默认）")],-1)])]),_:1}),l(ie,{command:"#3498db"},{default:t(()=>[...e[106]||(e[106]=[o("div",{style:{display:"flex","align-items":"center",gap:"8px"}},[o("span",{style:{display:"inline-block",width:"16px",height:"16px",background:"#3498db","border-radius":"3px"}}),o("span",null,"海洋蓝")],-1)])]),_:1}),l(ie,{command:"#e74c3c"},{default:t(()=>[...e[107]||(e[107]=[o("div",{style:{display:"flex","align-items":"center",gap:"8px"}},[o("span",{style:{display:"inline-block",width:"16px",height:"16px",background:"#e74c3c","border-radius":"3px"}}),o("span",null,"日落红")],-1)])]),_:1}),l(ie,{command:"#f39c12"},{default:t(()=>[...e[108]||(e[108]=[o("div",{style:{display:"flex","align-items":"center",gap:"8px"}},[o("span",{style:{display:"inline-block",width:"16px",height:"16px",background:"#f39c12","border-radius":"3px"}}),o("span",null,"晨曦橙")],-1)])]),_:1}),l(ie,{command:"#9b59b6"},{default:t(()=>[...e[109]||(e[109]=[o("div",{style:{display:"flex","align-items":"center",gap:"8px"}},[o("span",{style:{display:"inline-block",width:"16px",height:"16px",background:"#9b59b6","border-radius":"3px"}}),o("span",null,"皇家紫")],-1)])]),_:1}),l(ie,{command:"#e91e63"},{default:t(()=>[...e[110]||(e[110]=[o("div",{style:{display:"flex","align-items":"center",gap:"8px"}},[o("span",{style:{display:"inline-block",width:"16px",height:"16px",background:"#e91e63","border-radius":"3px"}}),o("span",null,"甜蜜粉")],-1)])]),_:1}),l(ie,{command:"#1abc9c"},{default:t(()=>[...e[111]||(e[111]=[o("div",{style:{display:"flex","align-items":"center",gap:"8px"}},[o("span",{style:{display:"inline-block",width:"16px",height:"16px",background:"#1abc9c","border-radius":"3px"}}),o("span",null,"现代青")],-1)])]),_:1}),l(ie,{command:"#3f51b5"},{default:t(()=>[...e[112]||(e[112]=[o("div",{style:{display:"flex","align-items":"center",gap:"8px"}},[o("span",{style:{display:"inline-block",width:"16px",height:"16px",background:"#3f51b5","border-radius":"3px"}}),o("span",null,"深邃靛")],-1)])]),_:1})]),_:1})]),default:t(()=>[l(b,{type:"primary",plain:""},{default:t(()=>[e[104]||(e[104]=i(" 预设主题 ",-1)),l(n,{class:"el-icon--right"},{default:t(()=>[l(Qt)]),_:1})]),_:1})]),_:1})]),e[113]||(e[113]=o("div",{class:"form-tip"},[i(" 🎨 "),o("strong",null,"主题色："),i("系统会自动生成深色和浅色变体，应用于按钮、链接、标签等所有UI元素"),o("br"),i(" 💡 "),o("strong",null,"提示："),i("可以使用颜色选择器、直接输入hex值，或从预设主题中快速选择 ")],-1))]),_:1})]),_:1}),l(x,{span:12},{default:t(()=>[l(d,{label:"头部跑马灯内容",prop:"head_w_marquee"},{default:t(()=>[l(r,{modelValue:p.head_w_marquee,"onUpdate:modelValue":e[18]||(e[18]=a=>p.head_w_marquee=a),type:"textarea",rows:3,placeholder:"留空则显示产品标题",style:{width:"100%"}},null,8,["modelValue"]),e[114]||(e[114]=o("div",{class:"form-tip"},"设置头部跑马灯显示内容，留空则显示产品标题",-1))]),_:1})]),_:1})]),_:1}),l(d,{label:"商品图片",prop:"image_urls"},{default:t(()=>[l(ea,{class:"upload-demo",drag:"",action:cl.value,multiple:"","file-list":Te.value,"before-upload":ot,"on-success":nt,"on-remove":it,"on-error":ut,"list-type":"picture-card",accept:"image/*"},{default:t(()=>[l(n,{class:"el-icon--upload"},{default:t(()=>[l(y(zl))]),_:1}),e[115]||(e[115]=o("div",{class:"el-upload__text"},[i("将图片拖到此处，或"),o("em",null,"点击上传")],-1))]),_:1},8,["action","file-list"])]),_:1}),l(d,{label:"商品描述",prop:"rich_text_content"},{default:t(()=>[o("div",{class:Oe(["wang-editor-wrapper",ve.value?"fullscreen":""])},[l(Ua,{value:p.rich_text_content||"",height:El.value,"editor-config":Il.value,"onUpdate:value":rt},null,8,["value","height","editor-config"]),o("div",vs,[l(b,{size:"small",onClick:dt,title:"调整编辑器大小"},{default:t(()=>[l(n,null,{default:t(()=>[ve.value?(u(),S(y($l),{key:0})):(u(),S(y(Dl),{key:1}))]),_:1}),i(" "+g(ve.value?"恢复":"全屏编辑"),1)]),_:1}),l(b,{size:"small",onClick:pt,title:"清空内容"},{default:t(()=>[l(n,null,{default:t(()=>[l(y(Ge))]),_:1}),e[116]||(e[116]=i(" 清空内容 ",-1))]),_:1})])],2)]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),l(re,{modelValue:we.value,"onUpdate:modelValue":e[21]||(e[21]=a=>we.value=a),title:"SKU管理",width:"1200px","close-on-click-modal":!1,"destroy-on-close":""},{default:t(()=>[o("div",ks,[o("div",bs,[o("div",hs,[e[122]||(e[122]=o("h3",null,"SKU列表",-1)),o("div",ws,[l(b,{type:"success",onClick:Vt},{default:t(()=>[l(n,null,{default:t(()=>[l(y(va))]),_:1}),e[119]||(e[119]=i(" 批量生成SKU ",-1))]),_:1}),l(b,{type:"primary",onClick:gt},{default:t(()=>[l(n,null,{default:t(()=>[l(y(pe))]),_:1}),e[120]||(e[120]=i(" 添加SKU ",-1))]),_:1}),I.value.length>1?(u(),S(b,{key:0,type:"warning",onClick:Ct},{default:t(()=>[l(n,null,{default:t(()=>[l(y(dl))]),_:1}),e[121]||(e[121]=i(" 排序SKU ",-1))]),_:1})):A("",!0)])]),ul((u(),S(Me,{data:I.value,stripe:"",border:"",style:{width:"100%"}},{default:t(()=>[l(C,{label:"图片",width:"80",align:"center"},{default:t(({row:a})=>[a.main_image?(u(),S(Q,{key:0,size:50,class:"sku-avatar"},{default:t(()=>[o("img",{src:a.main_image,alt:a.sku_name,style:{width:"100%",height:"100%","object-fit":"cover"}},null,8,Vs)]),_:2},1024)):(u(),S(Q,{key:1,size:50,class:"sku-avatar"},{default:t(()=>[l(n,null,{default:t(()=>[l(y(Ne))]),_:1})]),_:1}))]),_:1}),l(C,{prop:"sku_code",label:"SKU编码",width:"120"}),l(C,{prop:"sku_name",label:"SKU名称",width:"150"}),l(C,{label:"属性组合","min-width":"200"},{default:t(({row:a})=>[o("div",xs,[(u(!0),m(K,null,L(a.attributes,k=>(u(),S(h,{key:k.attribute_name,size:"small",class:"attr-tag"},{default:t(()=>[i(g(k.display_name)+": "+g(k.display_value),1)]),_:2},1024))),128))])]),_:1}),l(C,{prop:"sell_price",label:"销售价格",width:"100",align:"center"},{default:t(({row:a})=>[o("span",Ss,"¥"+g(a.sell_price),1)]),_:1}),l(C,{prop:"discount_percent",label:"折扣",width:"80",align:"center"},{default:t(({row:a})=>[a.discount_percent&&a.discount_percent>0?(u(),S(h,{key:0,type:"success",size:"small"},{default:t(()=>[i(g(a.discount_percent)+"% ",1)]),_:2},1024)):(u(),m("span",Us,"--"))]),_:1}),l(C,{prop:"stock_quantity",label:"库存",width:"80",align:"center"}),l(C,{prop:"status",label:"状态",width:"100",align:"center"},{default:t(({row:a})=>[l(h,{type:Jl(a.status),size:"small"},{default:t(()=>[i(g(Wl(a.status)),1)]),_:2},1032,["type"])]),_:1}),l(C,{label:"操作",width:"150",align:"center"},{default:t(({row:a})=>[l(b,{size:"small",type:"primary",link:"",onClick:k=>vt(a)},{default:t(()=>[...e[123]||(e[123]=[i("编辑",-1)])]),_:1},8,["onClick"]),l(b,{size:"small",type:"danger",link:"",onClick:k=>yt(a)},{default:t(()=>[...e[124]||(e[124]=[i("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ol,xe.value]])])])]),_:1},8,["modelValue"]),l(re,{modelValue:De.value,"onUpdate:modelValue":e[26]||(e[26]=a=>De.value=a),title:"SKU分层排序",width:"1200px",fullscreen:de.value,"close-on-click-modal":!1,"destroy-on-close":""},{footer:t(()=>[o("div",Hs,[l(b,{onClick:e[25]||(e[25]=a=>De.value=!1)},{default:t(()=>[...e[127]||(e[127]=[i("取消",-1)])]),_:1}),l(b,{type:"primary",onClick:Ft,loading:He.value},{default:t(()=>[...e[128]||(e[128]=[i(" 保存排序 ",-1)])]),_:1},8,["loading"])])]),default:t(()=>[o("div",{class:Oe(["sku-sort-container",{fullscreen:de.value}])},[o("div",Cs,[l(sl,{title:"分层排序说明",type:"info",closable:!1,"show-icon":"",style:{"margin-bottom":"20px"}},{default:t(()=>[...e[125]||(e[125]=[o("div",null,[o("p",null,"• 第一层：按属性类型排序（如：size、color）"),o("p",null,"• 第二层：按属性值排序（如：size1、size2、size3）"),o("p",null,"• 拖拽项目可以调整显示顺序")],-1)])]),_:1}),o("div",zs,[l(b,{type:"primary",icon:de.value?"ScaleToOriginal":"FullScreen",onClick:zt,circle:"",size:"small"},{default:t(()=>[l(n,null,{default:t(()=>[de.value?(u(),S(y($l),{key:0})):(u(),S(y(Dl),{key:1}))]),_:1})]),_:1},8,["icon"])])]),o("div",$s,[l(la,{modelValue:pl.value,"onUpdate:modelValue":e[24]||(e[24]=a=>pl.value=a),type:"card"},{default:t(()=>[l(hl,{label:"属性类型排序",name:"attribute"},{default:t(()=>[o("div",Ds,[e[126]||(e[126]=o("div",{class:"section-title"},"拖拽调整属性类型的显示顺序",-1)),o("div",Ps,[(u(!0),m(K,null,L(oe.value,(a,k)=>(u(),m("div",{key:a.name,class:"attribute-item",draggable:!0,onDragstart:D=>Pt(D,k),onDragover:e[22]||(e[22]=D=>fl(D)),onDrop:D=>Mt(D,k)},[o("div",Ks,[o("div",As,[l(n,null,{default:t(()=>[l(y(dl))]),_:1})]),o("div",Fs,[o("div",Ts,g(a.name),1),o("div",Ls,g(a.count)+"个SKU",1)]),o("div",Bs,g(k+1),1)])],40,Ms))),128))])])]),_:1}),(u(!0),m(K,null,L(oe.value,a=>(u(),S(hl,{key:a.name,label:`${a.name}排序`,name:a.name},{default:t(()=>[o("div",js,[o("div",Es,g(a.name)+" 属性值排序",1),o("div",Is,[(u(!0),m(K,null,L(Dt(a.name),(k,D)=>(u(),m("div",{key:`${a.name}-${k.value}`,class:"value-item",draggable:!0,onDragstart:Ke=>Kt(Ke,a.name,D),onDragover:e[23]||(e[23]=Ke=>fl(Ke)),onDrop:Ke=>At(Ke,a.name,D)},[o("div",Rs,[o("div",Ns,[l(n,null,{default:t(()=>[l(y(dl))]),_:1})]),o("div",Os,[o("div",Gs,g(k.value),1),o("div",Js,g(k.count)+"个SKU",1)]),o("div",Ws,g(D+1),1)])],40,qs))),128))])])]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"])])],2)]),_:1},8,["modelValue","fullscreen"]),l(re,{modelValue:$e.value,"onUpdate:modelValue":e[34]||(e[34]=a=>$e.value=a),title:"批量生成SKU",width:"900px","close-on-click-modal":!1,"destroy-on-close":""},{footer:t(()=>[o("div",ao,[l(b,{onClick:e[33]||(e[33]=a=>$e.value=!1)},{default:t(()=>[...e[136]||(e[136]=[i("取消",-1)])]),_:1}),l(b,{type:"primary",onClick:Ut,loading:We.value},{default:t(()=>[i(" 生成 "+g(J.value.length)+" 个SKU ",1)]),_:1},8,["loading"])])]),default:t(()=>[o("div",Zs,[l(sl,{title:"批量生成说明",type:"info",closable:!1,"show-icon":"",style:{"margin-bottom":"20px"}},{default:t(()=>[...e[129]||(e[129]=[o("div",null,[o("p",null,"• 可以一次性为商品生成多个不同规格的SKU"),o("p",null,"• 系统会自动创建所有规格组合的SKU"),o("p",null,"• 规格值输入：每行输入一个值，系统自动识别"),o("p",null,"• 示例：颜色(红、蓝) × 尺寸(M、L) = 4个SKU")],-1)])]),_:1}),l(ye,{model:V,"label-width":"120px"},{default:t(()=>[l(ne,{class:"form-card",shadow:"never"},{header:t(()=>[...e[130]||(e[130]=[o("span",{style:{"font-weight":"600"}},"基础信息",-1)])]),default:t(()=>[l(T,{gutter:20},{default:t(()=>[l(x,{span:12},{default:t(()=>[l(d,{label:"销售价格",required:""},{default:t(()=>[l(F,{modelValue:V.sell_price,"onUpdate:modelValue":e[27]||(e[27]=a=>V.sell_price=a),min:0,precision:2,style:{width:"100%"},onChange:_l},null,8,["modelValue"])]),_:1})]),_:1}),l(x,{span:12},{default:t(()=>[l(d,{label:"原价"},{default:t(()=>[l(F,{modelValue:V.origin_price,"onUpdate:modelValue":e[28]||(e[28]=a=>V.origin_price=a),min:0,precision:2,style:{width:"100%"},onChange:_l},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(T,{gutter:20},{default:t(()=>[l(x,{span:12},{default:t(()=>[l(d,{label:"折扣(%)",prop:"discount_percent"},{default:t(()=>[l(F,{modelValue:V.discount_percent,"onUpdate:modelValue":e[29]||(e[29]=a=>V.discount_percent=a),min:0,max:100,precision:0,style:{width:"100%"},disabled:""},{append:t(()=>[...e[131]||(e[131]=[i("%",-1)])]),_:1},8,["modelValue"]),e[132]||(e[132]=o("div",{class:"form-tip"},"根据销售价和原价自动计算",-1))]),_:1})]),_:1}),l(x,{span:12},{default:t(()=>[l(d,{label:"成本价"},{default:t(()=>[l(F,{modelValue:V.cost_price,"onUpdate:modelValue":e[30]||(e[30]=a=>V.cost_price=a),min:0,precision:2,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(T,{gutter:20},{default:t(()=>[l(x,{span:12},{default:t(()=>[l(d,{label:"库存数量",required:""},{default:t(()=>[l(F,{modelValue:V.stock_quantity,"onUpdate:modelValue":e[31]||(e[31]=a=>V.stock_quantity=a),min:0,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),l(x,{span:12},{default:t(()=>[l(d,{label:"成本价"},{default:t(()=>[l(F,{modelValue:V.cost_price,"onUpdate:modelValue":e[32]||(e[32]=a=>V.cost_price=a),min:0,precision:2,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),l(ne,{class:"form-card",shadow:"never",style:{"margin-top":"20px"}},{header:t(()=>[o("div",Qs,[e[134]||(e[134]=o("span",{style:{"font-weight":"600"}},"规格配置",-1)),l(b,{type:"primary",size:"small",onClick:xt},{default:t(()=>[l(n,null,{default:t(()=>[l(y(pe))]),_:1}),e[133]||(e[133]=i(" 添加规格 ",-1))]),_:1})])]),default:t(()=>[(u(!0),m(K,null,L(V.specs,(a,k)=>(u(),m("div",{key:k,class:"batch-spec-item"},[l(T,{gutter:10,style:{"margin-bottom":"10px"}},{default:t(()=>[l(x,{span:6},{default:t(()=>[l(r,{modelValue:a.name,"onUpdate:modelValue":D=>a.name=D,placeholder:"规格名称，如：颜色"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(x,{span:14},{default:t(()=>[l(r,{modelValue:a.values,"onUpdate:modelValue":D=>a.values=D,type:"textarea",rows:3,placeholder:`每行输入一个规格值，例如：
红色
蓝色
绿色`,style:{resize:"vertical"}},null,8,["modelValue","onUpdate:modelValue"]),e[135]||(e[135]=o("div",{class:"form-tip"},"每行输入一个规格值，系统会自动识别",-1))]),_:2},1024),l(x,{span:4},{default:t(()=>[l(b,{type:"danger",size:"small",onClick:D=>St(k)},{default:t(()=>[l(n,null,{default:t(()=>[l(y(Ge))]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]))),128)),J.value.length>0?(u(),m("div",Xs,[l(wl,{"content-position":"left"},{default:t(()=>[i("预览生成的SKU ("+g(J.value.length)+"个)",1)]),_:1}),o("div",Ys,[(u(!0),m(K,null,L(J.value,(a,k)=>(u(),m("div",{key:k,class:"preview-sku-item"},[o("div",eo,[o("div",lo,g(a.sku_name),1),o("div",to,[(u(!0),m(K,null,L(a.attributes,D=>(u(),S(h,{key:D.name,size:"small",class:"spec-tag"},{default:t(()=>[i(g(D.name)+": "+g(D.value),1)]),_:2},1024))),128))])])]))),128))])])):A("",!0)]),_:1})]),_:1},8,["model"])])]),_:1},8,["modelValue"]),l(re,{modelValue:ae.value,"onUpdate:modelValue":e[50]||(e[50]=a=>ae.value=a),title:Ve.value,width:"800px","close-on-click-modal":!1,"destroy-on-close":""},{footer:t(()=>[o("div",yo,[l(b,{onClick:e[49]||(e[49]=a=>ae.value=!1)},{default:t(()=>[...e[149]||(e[149]=[i("取消",-1)])]),_:1}),l(b,{type:"primary",onClick:bt,loading:Se.value},{default:t(()=>[...e[150]||(e[150]=[i("确定",-1)])]),_:1},8,["loading"])])]),default:t(()=>[l(ye,{model:f,rules:Rl,ref_key:"skuFormRef",ref:U,"label-width":"100px"},{default:t(()=>[l(T,{gutter:20},{default:t(()=>[l(x,{span:12},{default:t(()=>[l(d,{label:"SKU编码",prop:"sku_code"},{default:t(()=>[l(r,{modelValue:f.sku_code,"onUpdate:modelValue":e[35]||(e[35]=a=>f.sku_code=a),placeholder:"自动生成"},null,8,["modelValue"])]),_:1})]),_:1}),l(x,{span:12},{default:t(()=>[l(d,{label:"SKU名称",prop:"sku_name"},{default:t(()=>[l(r,{modelValue:f.sku_name,"onUpdate:modelValue":e[36]||(e[36]=a=>f.sku_name=a),placeholder:"请输入SKU名称"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(T,{gutter:20},{default:t(()=>[l(x,{span:12},{default:t(()=>[l(d,{label:"销售价格",prop:"sell_price"},{default:t(()=>[l(F,{modelValue:f.sell_price,"onUpdate:modelValue":e[37]||(e[37]=a=>f.sell_price=a),min:0,precision:2,style:{width:"100%"},onChange:gl},null,8,["modelValue"])]),_:1})]),_:1}),l(x,{span:12},{default:t(()=>[l(d,{label:"原价",prop:"origin_price"},{default:t(()=>[l(F,{modelValue:f.origin_price,"onUpdate:modelValue":e[38]||(e[38]=a=>f.origin_price=a),min:0,precision:2,style:{width:"100%"},onChange:gl},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(T,{gutter:20},{default:t(()=>[l(x,{span:12},{default:t(()=>[l(d,{label:"折扣(%)",prop:"discount_percent"},{default:t(()=>[l(F,{modelValue:f.discount_percent,"onUpdate:modelValue":e[39]||(e[39]=a=>f.discount_percent=a),min:0,max:100,precision:0,style:{width:"100%"},onChange:Bt},{append:t(()=>[...e[137]||(e[137]=[i("%",-1)])]),_:1},8,["modelValue"]),e[138]||(e[138]=o("div",{class:"form-tip"},"输入销售价和原价后自动计算，或手动输入折扣",-1))]),_:1})]),_:1}),l(x,{span:12},{default:t(()=>[l(d,{label:"成本价",prop:"cost_price"},{default:t(()=>[l(F,{modelValue:f.cost_price,"onUpdate:modelValue":e[40]||(e[40]=a=>f.cost_price=a),min:0,precision:2,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(T,{gutter:20},{default:t(()=>[l(x,{span:12},{default:t(()=>[l(d,{label:"库存数量",prop:"stock_quantity"},{default:t(()=>[l(F,{modelValue:f.stock_quantity,"onUpdate:modelValue":e[41]||(e[41]=a=>f.stock_quantity=a),min:0,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),l(x,{span:12},{default:t(()=>[l(d,{label:"预警库存",prop:"warning_stock"},{default:t(()=>[l(F,{modelValue:f.warning_stock,"onUpdate:modelValue":e[42]||(e[42]=a=>f.warning_stock=a),min:0,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(d,{label:"SKU图片",prop:"main_image"},{default:t(()=>[l(Fl,{"image-url":f.main_image,"onUpdate:imageUrl":e[43]||(e[43]=a=>f.main_image=a),"file-size":2,"file-type":["image/jpg","image/jpeg","image/png","image/gif","image/webp"],drag:!0,width:"120px",height:"120px"},null,8,["image-url"])]),_:1}),l(d,{label:"SKU规格",prop:"attributes"},{default:t(()=>[o("div",so,[l(sl,{title:"SKU规格设置说明",type:"info",closable:!1,"show-icon":"",style:{"margin-bottom":"16px"}},{default:t(()=>[...e[139]||(e[139]=[o("div",null,[o("p",null,[i("• "),o("strong",null,"每个SKU代表一个具体的商品规格组合")]),o("p",null,"• 一个SKU的同一属性只能设置一个值（如：尺寸只能是M或L，不能同时是两种）"),o("p",null,"• 如需不同规格，请创建多个SKU"),o("p",null,"• 示例：红色M码为一个SKU，红色L码为另一个SKU"),o("p",null,'• 提示：使用"添加SKU"按钮为每个规格组合创建独立的SKU')],-1)])]),_:1}),o("div",oo,[l(T,{gutter:10},{default:t(()=>[l(x,{span:8},{default:t(()=>[l(r,{modelValue:q.value,"onUpdate:modelValue":e[44]||(e[44]=a=>q.value=a),placeholder:"规格名称，如：尺寸",maxlength:20,"show-word-limit":""},null,8,["modelValue"])]),_:1}),l(x,{span:12},{default:t(()=>[l(r,{modelValue:Z.value,"onUpdate:modelValue":e[45]||(e[45]=a=>Z.value=a),placeholder:"规格值，如：M",maxlength:200,"show-word-limit":""},null,8,["modelValue"])]),_:1}),l(x,{span:4},{default:t(()=>[l(b,{type:"primary",onClick:_t,disabled:!q.value||!Z.value},{default:t(()=>[l(n,null,{default:t(()=>[l(y(pe))]),_:1}),e[140]||(e[140]=i(" 添加 ",-1))]),_:1},8,["disabled"])]),_:1})]),_:1}),e[141]||(e[141]=o("div",{class:"form-tip",style:{"margin-top":"8px",color:"#909399","font-size":"12px"}}," 提示：每个SKU只能设置一个属性值，如需不同规格请创建多个SKU ",-1))]),B.value.length>0?(u(),m("div",no,[l(wl,{"content-position":"left"},{default:t(()=>[...e[142]||(e[142]=[i("已添加的规格",-1)])]),_:1}),o("div",io,[(u(!0),m(K,null,L(B.value,(a,k)=>(u(),m("div",{key:k,class:"spec-item"},[o("div",uo,[o("span",ro,g(a.name),1),l(h,{type:"primary",size:"small"},{default:t(()=>[i(g(a.value),1)]),_:2},1024)]),o("div",po,[l(b,{size:"small",type:"primary",link:"",onClick:D=>ft(k),icon:"Edit"},{default:t(()=>[...e[143]||(e[143]=[i(" 编辑 ",-1)])]),_:1},8,["onClick"]),l(b,{size:"small",type:"danger",link:"",onClick:D=>mt(k),icon:"Delete"},{default:t(()=>[...e[144]||(e[144]=[i(" 删除 ",-1)])]),_:1},8,["onClick"])])]))),128))])])):A("",!0)])]),_:1}),l(d,{label:"主图设置",prop:"main_image"},{default:t(()=>[o("div",co,[o("div",_o,[l(al,{modelValue:Ue.value,"onUpdate:modelValue":e[46]||(e[46]=a=>Ue.value=a),onChange:ht},{default:t(()=>[l(ke,{value:"url"},{default:t(()=>[l(n,null,{default:t(()=>[l(y(rl))]),_:1}),e[145]||(e[145]=i(" URL输入 ",-1))]),_:1}),l(ke,{value:"upload"},{default:t(()=>[l(n,null,{default:t(()=>[l(y(zl))]),_:1}),e[146]||(e[146]=i(" 文件上传 ",-1))]),_:1})]),_:1},8,["modelValue"])]),Ue.value==="url"?(u(),m("div",mo,[l(r,{modelValue:f.main_image,"onUpdate:modelValue":e[47]||(e[47]=a=>f.main_image=a),placeholder:"请输入图片URL地址",clearable:""},{prepend:t(()=>[l(n,null,{default:t(()=>[l(y(rl))]),_:1})]),_:1},8,["modelValue"]),f.main_image?(u(),m("div",fo,[l(ta,{src:f.main_image,fit:"cover",style:{width:"80px",height:"80px","border-radius":"4px"},"preview-src-list":[f.main_image],"preview-teleported":""},{error:t(()=>[o("div",go,[l(n,null,{default:t(()=>[l(y(ya))]),_:1}),e[147]||(e[147]=o("span",null,"加载失败",-1))])]),_:1},8,["src","preview-src-list"])])):A("",!0)])):A("",!0),Ue.value==="upload"?(u(),m("div",vo,[l(Fl,{"image-url":f.main_image,"onUpdate:imageUrl":e[48]||(e[48]=a=>f.main_image=a),height:"120px",width:"120px","file-size":2,"file-type":["image/jpeg","image/png","image/gif","image/webp"]},{tip:t(()=>[...e[148]||(e[148]=[o("div",{class:"upload-tip"},"支持 JPG、PNG、GIF、WebP 格式，文件大小不超过 2MB",-1)])]),_:1},8,["image-url"])])):A("",!0)])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),l(re,{modelValue:me.value,"onUpdate:modelValue":e[56]||(e[56]=a=>me.value=a),title:"选择关联仿品",width:"1000px","close-on-click-modal":!1,"destroy-on-close":""},{footer:t(()=>[o("div",To,[l(b,{onClick:e[55]||(e[55]=a=>me.value=!1)},{default:t(()=>[...e[156]||(e[156]=[i("取消",-1)])]),_:1}),l(b,{type:"primary",onClick:Ot,disabled:!se.value},{default:t(()=>[...e[157]||(e[157]=[i(" 确定关联 ",-1)])]),_:1},8,["disabled"])])]),default:t(()=>[o("div",ko,[l(ne,{class:"current-product-card",shadow:"never"},{header:t(()=>[...e[151]||(e[151]=[o("span",{style:{"font-weight":"600",color:"#409eff"}},"当前正品商品",-1)])]),default:t(()=>[$.value?(u(),m("div",bo,[$.value.image_urls&&$.value.image_urls[0]?(u(),S(Q,{key:0,size:60},{default:t(()=>[o("img",{src:$.value.image_urls[0],alt:$.value.title,style:{width:"100%",height:"100%","object-fit":"cover"}},null,8,ho)]),_:1})):(u(),S(Q,{key:1,size:60},{default:t(()=>[l(n,null,{default:t(()=>[l(y(Ne))]),_:1})]),_:1})),o("div",wo,[o("div",Vo,g($.value.title),1),o("div",xo,"¥"+g($.value.sell_price),1),l(h,{type:"success",size:"small"},{default:t(()=>[...e[152]||(e[152]=[i("正品",-1)])]),_:1})])])):A("",!0)]),_:1}),l(ne,{class:"fake-selection-card",shadow:"never"},{header:t(()=>[o("div",So,[e[154]||(e[154]=o("span",{style:{"font-weight":"600"}},"选择要关联的仿品",-1)),l(b,{type:"primary",size:"small",onClick:Wt},{default:t(()=>[l(n,null,{default:t(()=>[l(y(pe))]),_:1}),e[153]||(e[153]=i(" 创建新仿品 ",-1))]),_:1})])]),default:t(()=>[o("div",Uo,[l(r,{modelValue:Ee.value,"onUpdate:modelValue":e[51]||(e[51]=a=>Ee.value=a),placeholder:"搜索仿品商品...",clearable:"",onInput:qt,style:{width:"300px"}},{prefix:t(()=>[l(n,null,{default:t(()=>[l(y(il))]),_:1})]),_:1},8,["modelValue"])]),ul((u(),m("div",Co,[(u(!0),m(K,null,L(Be.value,a=>(u(),m("div",{key:a.id,class:Oe(["fake-product-card",{active:se.value===a.id}]),onClick:k=>se.value=a.id},[a.image_urls&&a.image_urls[0]?(u(),S(Q,{key:0,size:28},{default:t(()=>[o("img",{src:a.image_urls[0],alt:a.title,style:{width:"100%",height:"100%","object-fit":"cover"}},null,8,$o)]),_:2},1024)):(u(),S(Q,{key:1,size:28},{default:t(()=>[l(n,null,{default:t(()=>[l(y(Ne))]),_:1})]),_:1})),o("div",Do,[o("div",Po,g(a.title),1),o("div",Mo,"¥"+g(a.sell_price),1),l(h,{type:"warning",size:"small",style:{padding:"1px 4px","font-size":"10px"}},{default:t(()=>[...e[155]||(e[155]=[i("仿品",-1)])]),_:1})]),o("div",Ko,[l(ke,{value:a.id,modelValue:se.value,"onUpdate:modelValue":e[52]||(e[52]=k=>se.value=k)},null,8,["value","modelValue"])])],10,zo))),128)),!je.value&&Be.value.length===0?(u(),m("div",Ao,[l(aa,{description:"暂无可关联的仿品商品"})])):A("",!0)])),[[ol,je.value]]),Be.value.length>0?(u(),m("div",Fo,[l(Re,{"current-page":N.current,"onUpdate:currentPage":e[53]||(e[53]=a=>N.current=a),"page-size":N.size,"onUpdate:pageSize":e[54]||(e[54]=a=>N.size=a),"page-sizes":[12,24,48],total:N.total,layout:"total, sizes, prev, pager, next",onSizeChange:Rt,onCurrentChange:Nt,small:""},null,8,["current-page","page-size","total"])])):A("",!0)]),_:1})])]),_:1},8,["modelValue"]),l(re,{modelValue:ee.value,"onUpdate:modelValue":e[59]||(e[59]=a=>ee.value=a),title:"选择查看域名",width:"500px","close-on-click-modal":!1},{footer:t(()=>[o("div",No,[l(b,{onClick:e[58]||(e[58]=a=>ee.value=!1)},{default:t(()=>[...e[159]||(e[159]=[i("取消",-1)])]),_:1}),l(b,{type:"primary",onClick:Xl,disabled:!E.value},{default:t(()=>[...e[160]||(e[160]=[i(" 确认查看 ",-1)])]),_:1},8,["disabled"])])]),default:t(()=>[j.value?(u(),m("div",Lo,[o("div",Bo,[o("h4",null,g(j.value.title),1),e[158]||(e[158]=o("p",null,"请选择要查看的域名：",-1))]),l(al,{modelValue:E.value,"onUpdate:modelValue":e[57]||(e[57]=a=>E.value=a),class:"domain-options"},{default:t(()=>[(u(!0),m(K,null,L(le.value,a=>(u(),S(ke,{key:a.id,value:a,class:"domain-option"},{default:t(()=>[o("div",jo,[o("div",Eo,[o("span",Io,g(a.name),1),l(h,{type:a.is_active?"success":"info",size:"small"},{default:t(()=>[i(g(a.is_active?"启用":"禁用"),1)]),_:2},1032,["type"])]),o("div",qo,[l(n,null,{default:t(()=>[l(y(rl))]),_:1}),o("span",null,g(a.protocol)+"://"+g(a.domain),1)]),a.description?(u(),m("div",Ro,g(a.description),1)):A("",!0)])]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])])):A("",!0)]),_:1},8,["modelValue"])])}}}),en=Ll(Go,[["__scopeId","data-v-6767a891"]]);export{en as default};
