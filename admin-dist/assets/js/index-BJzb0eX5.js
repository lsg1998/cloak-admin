import{a2 as A,d as Ie,h as c,P as X,s as he,Z as Kt,r as k,Q as Tt,c as m,o as u,b as t,w as l,au as Dt,u as g,x as ze,e as i,E as Te,W as Se,a as o,g as U,av as Ue,t as _,F as J,f as W,ax as De,aB as Lt,aw as Ot,R as Z,aZ as jt,ag as Y,ay as Et,U as Le,a_ as It,n as Oe,a$ as qt,G as Bt,N as p,aA as Ce}from"./index-C86HIY7U.js";import{W as Rt}from"./index--Z9unQkt.js";import{_ as Nt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./upload-zHHVqa-G.js";const je=r=>{const h=new URLSearchParams;r.page&&h.append("page",r.page.toString()),r.size&&h.append("size",r.size.toString()),r.title&&h.append("title",r.title),r.status&&h.append("status",r.status),r.product_type&&h.append("product_type",r.product_type),r.category_id&&h.append("category_id",r.category_id);const q=h.toString(),K=q?`/admin/products?${q}`:"/admin/products";return A.get(K)},Mt=r=>A.post("/admin/products",r),Jt=(r,h)=>A.put(`/admin/products/${r}`,h),Wt=r=>A.delete(`/admin/products/${r}`),Ee=r=>{const h=r?{search:r}:{};return A.get("/admin/products/original/list",{params:h})},Zt=(r,h)=>A.put(`/admin/products/${r}`,{product_type:"fake",b_page_product_id:h}),Ht=r=>A.get(`/admin/products/${r}/skus`),Gt=r=>A.post("/admin/product-skus",r),Qt=(r,h)=>A.put(`/admin/product-skus/${r}`,h),Xt=r=>A.delete(`/admin/product-skus/${r}`),Yt={class:"product-management"},el={class:"table-header"},tl={class:"table-title"},ll={class:"table-actions"},al={class:"product-info"},sl=["src","alt"],ol={class:"product-details"},il={class:"product-title"},nl={class:"product-subtitle"},ul={key:0,style:{"font-weight":"bold",color:"#ef3f52"}},dl={key:1,style:{color:"#999999"}},rl={key:0,style:{color:"#666666","text-decoration":"line-through"}},pl={key:1,style:{color:"#999999"}},cl={key:1,style:{color:"#999999"}},_l={key:0},fl={key:0},ml={key:1,style:{color:"#999999"}},gl={key:1},vl={key:2,style:{color:"#f56c6c"}},yl={class:"count-info"},kl={class:"count-info"},bl={class:"time-info"},Vl={class:"action-buttons"},wl={class:"pagination-wrapper"},hl={style:{display:"flex","align-items":"center","justify-content":"space-between"}},zl={style:{"font-size":"12px",color:"#999999"}},Sl={class:"editor-controls"},Ul={class:"dialog-footer"},Cl={class:"sku-management"},xl={class:"sku-list-section"},$l={class:"section-header"},Fl={class:"sku-attributes"},Pl={class:"price"},Al={class:"sku-specs"},Kl={class:"add-spec-form"},Tl={key:0,class:"specs-list"},Dl={class:"specs-grid"},Ll={class:"spec-content"},Ol={class:"spec-name"},jl={class:"dialog-footer"},El={class:"fake-product-selection"},Il={key:0,class:"product-summary"},ql=["src","alt"],Bl={class:"product-info"},Rl={class:"product-title"},Nl={class:"product-price"},Ml={style:{display:"flex","align-items":"center","justify-content":"space-between"}},Jl={class:"search-section"},Wl={class:"fake-products-grid"},Zl=["onClick"],Hl=["src","alt"],Gl={class:"card-content"},Ql={class:"card-title"},Xl={class:"card-price"},Yl={class:"card-check"},ea={key:0,class:"empty-state"},ta={key:0,class:"fake-pagination"},la={class:"dialog-footer"},aa=Ie({name:"ProductList"}),sa=Ie({...aa,setup(r){const h=c(!1),q=c(!1),K=c(!1),ee=c(""),re=c(),pe=c(!1),B=c(!1),ce=c(""),_e=c(!1),fe=c(!1),me=c(),te=c(null),xe=c([]),j=c(""),E=c(""),I=c([]),F=X({title:"",status:null,product_type:""}),x=X({current:1,size:20,total:0}),H=c([]),d=X({id:null,spu_id:"",title:"",sell_price:0,origin_price:0,discount:0,image_urls:[],rich_text_content:"",specification_list:[],variants:[],status:"active",product_type:"original",b_page_product_id:"",country:"JA"}),le=c([]),ae=c([]),G=c(!1),R=c(!1),b=c(null),se=c([]),oe=c(!1),T=c(""),ie=c(""),$=X({current:1,size:12,total:0}),N=c(!1),qe=[{label:"日本",value:"JA"},{label:"中国",value:"ZH"},{label:"英国",value:"EN"},{label:"斯洛伐克",value:"SK"},{label:"斯洛文尼亚",value:"SI"},{label:"波兰",value:"PL"},{label:"葡萄牙",value:"PT"},{label:"匈牙利",value:"HU"},{label:"意大利",value:"IT"},{label:"西班牙",value:"ES"},{label:"捷克",value:"CZ"}],Be=he(()=>N.value?"calc(100vh - 200px)":"500px"),Re=he(()=>({placeholder:"请输入商品描述内容...",MENU_CONF:{uploadImage:{server:$e.value,fieldName:"file",maxFileSize:2*1024*1024,allowedFileTypes:["image/*"]}}})),$e=he(()=>"https://gammtt.shop/admin/upload/image"),v=X({id:null,product_id:"",sku_code:"",sku_name:"",sell_price:0,origin_price:0,cost_price:0,discount_percent:0,stock_quantity:0,warning_stock:10,main_image:"",status:"active",attributes:[]}),Ne={title:[{required:!0,message:"请输入商品标题",trigger:"blur"},{min:2,max:500,message:"商品标题长度在 2 到 500 个字符",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]},Me={sku_name:[{required:!0,message:"请输入SKU名称",trigger:"blur"}],sell_price:[{required:!0,message:"请输入销售价格",trigger:"blur"}],stock_quantity:[{required:!0,message:"请输入库存数量",trigger:"blur"}]},Je=s=>({active:"success",inactive:"danger",draft:"warning",deleted:"info"})[s]||"info",We=s=>({active:"上架",inactive:"下架",draft:"草稿",deleted:"已删除"})[s]||s,Ze=s=>({active:"success",inactive:"danger",out_of_stock:"warning"})[s]||"info",He=s=>({active:"正常",inactive:"禁用",out_of_stock:"缺货"})[s]||s,ge=()=>{x.current=1,D()},Ge=()=>{Object.assign(F,{title:"",status:null,product_type:""}),ge()},Qe=()=>{ee.value="添加商品",Object.assign(d,{id:null,spu_id:"",title:"",sell_price:0,origin_price:0,discount:0,image_urls:[],rich_text_content:"",specification_list:[],variants:[],status:"active",product_type:"original",b_page_product_id:"",country:"JA"}),le.value=[],ae.value=[],K.value=!0},ve=s=>{const n=`https://gammtt.shop/product/${s.id}`;window.open(n,"_blank"),p.success("正在跳转到商品页面...")},Xe=s=>{ee.value="编辑商品";const e={...s,sell_price:parseFloat(s.sell_price)||0,origin_price:parseFloat(s.origin_price)||0,discount:parseFloat(s.discount)||0,product_type:s.product_type||"original",b_page_product_id:s.b_page_product_id||"",country:s.country||"JA"};Object.assign(d,e),le.value=(s.image_urls||[]).map((n,C)=>({name:`image_${C}.jpg`,url:n,response:{success:!0,data:{url:n,file_name:`image_${C}.jpg`}}})),K.value=!0},Ye=s=>{Ce.confirm(`确定要删除商品 "${s.title}" 吗？删除后无法恢复！`,"删除确认",{confirmButtonText:"确定删除",cancelButtonText:"取消",type:"warning",confirmButtonClass:"el-button--danger"}).then(async()=>{try{await Wt(s.id),p.success("删除成功"),D()}catch{p.error("删除失败")}})},et=async()=>{re.value&&re.value.validate(async s=>{if(s){q.value=!0;try{d.id?(await Jt(d.id,d),p.success("更新成功")):(await Mt(d),p.success("添加成功")),K.value=!1,D()}catch{p.error(d.id?"更新失败":"添加失败")}finally{q.value=!1}}})},tt=s=>{x.size=s,D()},lt=s=>{x.current=s,D()},at=s=>{const e=s.type.startsWith("image/"),n=s.size/1024/1024<2;return e?n?!0:(p.error("图片大小不能超过 2MB!"),!1):(p.error("只能上传图片文件!"),!1)},st=(s,e)=>{s&&s.success&&s.data&&s.data.url?(d.image_urls.push(s.data.url),e.fileName=s.data.file_name,p.success("图片上传成功")):p.error("图片上传失败: "+(s.error||"未知错误"))},ot=s=>{if(s.response&&s.response.url){const e=d.image_urls.indexOf(s.response.url);e>-1&&d.image_urls.splice(e,1)}},it=()=>{p.error("图片上传失败")},nt=()=>{N.value=!N.value},ut=s=>{d.rich_text_content=s},dt=()=>{Ce.confirm("确定要清空商品描述内容吗？","清空确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{d.rich_text_content="",p.success("内容已清空")})},D=async()=>{h.value=!0;try{const s={page:x.current,size:x.size,title:F.title||void 0,status:F.status||void 0,product_type:F.product_type||void 0},{data:e}=await je(s);H.value=e.list,x.total=e.total}catch{p.error("获取商品列表失败")}finally{h.value=!1}},rt=async s=>{te.value=s,pe.value=!0,await ye(s.id)},ye=async s=>{_e.value=!0;try{const{data:e}=await Ht(s);xe.value=e}catch{p.error("获取SKU列表失败")}finally{_e.value=!1}},pt=()=>{if(!j.value.trim()||!E.value.trim()){p.warning("请输入规格名称和值");return}const s={name:j.value.trim(),value:E.value.trim()};I.value.push(s),j.value="",E.value="",p.success("规格添加成功")},ct=s=>{I.value.splice(s,1),p.success("规格删除成功")},_t=()=>{var C;ce.value="添加SKU";const s=Date.now(),e=Math.floor(Math.random()*1e3).toString().padStart(3,"0"),n=`SKU${s}${e}`;Object.assign(v,{id:null,product_id:((C=te.value)==null?void 0:C.id)||"",sku_code:n,sku_name:"",sell_price:0,origin_price:0,cost_price:0,discount_percent:0,stock_quantity:0,warning_stock:10,main_image:"",status:"active",attributes:[]}),I.value=[],j.value="",E.value="",B.value=!0},ft=s=>{ce.value="编辑SKU";const e={...s,sell_price:parseFloat(s.sell_price)||0,origin_price:parseFloat(s.origin_price)||0,cost_price:parseFloat(s.cost_price)||0,discount_percent:parseFloat(s.discount_percent)||0,stock_quantity:parseInt(s.stock_quantity)||0,warning_stock:parseInt(s.warning_stock)||10};Object.assign(v,e),I.value=s.attributes.map(n=>({name:n.attribute_name||"",value:n.value||""})),B.value=!0},mt=s=>{Ce.confirm(`确定要删除SKU "${s.sku_name}" 吗？`,"删除确认",{confirmButtonText:"确定删除",cancelButtonText:"取消",type:"warning"}).then(async()=>{var e;try{await Xt(s.id),p.success("删除成功"),await ye(((e=te.value)==null?void 0:e.id)||"")}catch{p.error("删除失败")}})},gt=()=>I.value.map(s=>({attribute_name:s.name,value:s.value})),vt=async()=>{me.value&&me.value.validate(async s=>{var e;if(s){fe.value=!0;try{const n={...v,attributes:gt()};v.id?(await Qt(v.id,n),p.success("更新成功")):(await Gt(n),p.success("添加成功")),B.value=!1,await ye(((e=te.value)==null?void 0:e.id)||"")}catch{p.error(v.id?"更新失败":"添加失败")}finally{fe.value=!1}}})},yt=s=>{s==="original"?d.b_page_product_id="":s==="fake"&&(d.b_page_product_id||ke())},kt=async s=>{if(!s){await ke();return}G.value=!0;try{const{data:e}=await Ee(s);ae.value=e}catch{p.error("搜索正品商品失败")}finally{G.value=!1}},ke=async()=>{G.value=!0;try{const{data:s}=await Ee();ae.value=s}catch{p.error("加载正品商品列表失败")}finally{G.value=!1}},bt=s=>{const e=H.value.find(n=>n.id===s);return e?e.title:"未知商品"},Fe=s=>H.value.filter(e=>e.product_type==="fake"&&e.b_page_product_id===s),Vt=s=>{const e=H.value.find(n=>n.id===s);e&&ve(e)},wt=s=>{b.value=s,T.value="",ie.value="",$.current=1,R.value=!0,ne()},ne=async()=>{oe.value=!0;try{const s={page:$.current,size:$.size,product_type:"fake",title:ie.value||void 0},{data:e}=await je(s);se.value=e.list.filter(n=>!n.b_page_product_id),$.total=e.total}catch{p.error("加载仿品商品列表失败")}finally{oe.value=!1}},ht=()=>{$.current=1,ne()},zt=s=>{$.size=s,ne()},St=s=>{$.current=s,ne()},Ut=async()=>{if(!(!T.value||!b.value))try{await Zt(T.value,b.value.id),p.success("仿品关联成功"),R.value=!1,D()}catch{p.error("仿品关联失败")}},Ct=()=>{b.value&&(R.value=!1,ee.value="基于正品创建仿品",Object.assign(d,{id:null,spu_id:"",title:`${b.value.title} - 仿品版`,sell_price:Math.round((b.value.sell_price||0)*.6),origin_price:b.value.sell_price||0,discount:40,image_urls:[...b.value.image_urls||[]],rich_text_content:b.value.rich_text_content||"",specification_list:[...b.value.specification_list||[]],variants:[...b.value.variants||[]],status:"draft",product_type:"fake",b_page_product_id:b.value.id,country:b.value.country||"JA"}),le.value=(b.value.image_urls||[]).map((s,e)=>({name:`image_${e}.jpg`,url:s,response:{success:!0,data:{url:s,file_name:`image_${e}.jpg`}}})),ke(),K.value=!0,p.success(`已基于正品"${b.value.title}"创建仿品，请修改相关信息后保存`))};return Kt(()=>{D()}),(s,e)=>{const n=k("el-icon"),C=k("el-input"),f=k("el-form-item"),P=k("el-option"),Q=k("el-select"),w=k("el-tag"),y=k("el-button"),be=k("el-form"),ue=k("el-card"),M=k("el-avatar"),z=k("el-table-column"),Pe=k("el-tooltip"),Ae=k("el-table"),Ke=k("el-pagination"),L=k("el-input-number"),S=k("el-col"),O=k("el-row"),Ve=k("el-radio"),xt=k("el-radio-group"),$t=k("el-upload"),de=k("el-dialog"),Ft=k("el-divider"),Pt=k("el-empty"),we=Tt("loading");return u(),m("div",Yt,[t(ue,{class:"search-card",shadow:"never"},{default:l(()=>[t(be,{model:F,inline:"",class:"search-form"},{default:l(()=>[t(f,{label:"商品标题"},{default:l(()=>[t(C,{modelValue:F.title,"onUpdate:modelValue":e[0]||(e[0]=a=>F.title=a),placeholder:"请输入商品标题",clearable:"",style:{width:"200px"},onKeyup:Dt(ge,["enter"])},{prefix:l(()=>[t(n,null,{default:l(()=>[t(g(ze))]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(f,{label:"状态"},{default:l(()=>[t(Q,{modelValue:F.status,"onUpdate:modelValue":e[1]||(e[1]=a=>F.status=a),placeholder:"请选择状态",clearable:"",style:{width:"120px"}},{default:l(()=>[t(P,{label:"上架",value:"active"}),t(P,{label:"下架",value:"inactive"}),t(P,{label:"草稿",value:"draft"})]),_:1},8,["modelValue"])]),_:1}),t(f,{label:"商品类型"},{default:l(()=>[t(Q,{modelValue:F.product_type,"onUpdate:modelValue":e[2]||(e[2]=a=>F.product_type=a),placeholder:"请选择类型",clearable:"",style:{width:"120px"}},{default:l(()=>[t(P,{label:"全部",value:""},{default:l(()=>[t(w,{type:"info",size:"small"},{default:l(()=>[...e[35]||(e[35]=[i("全部",-1)])]),_:1})]),_:1}),t(P,{label:"正品",value:"original"},{default:l(()=>[t(w,{type:"success",size:"small"},{default:l(()=>[...e[36]||(e[36]=[i("正品",-1)])]),_:1})]),_:1}),t(P,{label:"仿品",value:"fake"},{default:l(()=>[t(w,{type:"warning",size:"small"},{default:l(()=>[...e[37]||(e[37]=[i("仿品",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(f,null,{default:l(()=>[t(y,{type:"primary",onClick:ge},{default:l(()=>[t(n,null,{default:l(()=>[t(g(ze))]),_:1}),e[38]||(e[38]=i(" 搜索 ",-1))]),_:1}),t(y,{onClick:Ge},{default:l(()=>[t(n,null,{default:l(()=>[t(g(Te))]),_:1}),e[39]||(e[39]=i(" 重置 ",-1))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(ue,{class:"table-card",shadow:"never"},{header:l(()=>[o("div",el,[o("div",tl,[t(y,{type:"primary",onClick:Qe},{default:l(()=>[t(n,null,{default:l(()=>[t(g(Y))]),_:1}),e[40]||(e[40]=i(" 添加商品 ",-1))]),_:1}),e[41]||(e[41]=o("span",null,"商品列表",-1)),t(w,{type:"info",size:"small"},{default:l(()=>[i(_(x.total)+" 条记录",1)]),_:1})]),o("div",ll,[t(y,{size:"small",onClick:D},{default:l(()=>[t(n,null,{default:l(()=>[t(g(Te))]),_:1}),e[42]||(e[42]=i(" 刷新 ",-1))]),_:1})])])]),default:l(()=>[Se((u(),U(Ae,{data:H.value,stripe:"",border:"",style:{width:"100%"},"header-cell-style":{background:"#f8f9fa",color:"#606266"}},{default:l(()=>[t(z,{prop:"title",label:"商品标题","min-width":"200","show-overflow-tooltip":""},{default:l(({row:a})=>[o("div",al,[a.image_urls&&a.image_urls[0]?(u(),U(M,{key:0,size:40,class:"product-avatar"},{default:l(()=>[o("img",{src:a.image_urls[0],alt:a.title,style:{width:"100%",height:"100%","object-fit":"cover"}},null,8,sl)]),_:2},1024)):(u(),U(M,{key:1,size:40,class:"product-avatar"},{default:l(()=>[t(n,null,{default:l(()=>[t(g(Ue))]),_:1})]),_:1})),o("div",ol,[o("div",il,_(a.title),1),o("div",nl,_(a.sell_price?"¥"+a.sell_price:"暂未定价"),1)])])]),_:1}),t(z,{prop:"sell_price",label:"销售价",width:"90",align:"center"},{default:l(({row:a})=>[a.sell_price?(u(),m("span",ul," ¥"+_(a.sell_price),1)):(u(),m("span",dl,"--"))]),_:1}),t(z,{prop:"origin_price",label:"原价",width:"90",align:"center"},{default:l(({row:a})=>[a.origin_price&&a.origin_price>0?(u(),m("span",rl," ¥"+_(a.origin_price),1)):(u(),m("span",pl,"--"))]),_:1}),t(z,{prop:"discount",label:"折扣",width:"80",align:"center"},{default:l(({row:a})=>[a.discount&&a.discount>0?(u(),U(w,{key:0,type:"success",size:"small"},{default:l(()=>[i(_(a.discount)+"% OFF ",1)]),_:2},1024)):(u(),m("span",cl,"--"))]),_:1}),t(z,{prop:"product_type",label:"类型",width:"100",align:"center"},{default:l(({row:a})=>[t(w,{type:a.product_type==="original"?"success":"warning",size:"small"},{default:l(()=>[i(_(a.product_type==="original"?"正品":"仿品"),1)]),_:2},1032,["type"])]),_:1}),t(z,{label:"关联关系",width:"150",align:"center"},{default:l(({row:a})=>[a.product_type==="original"?(u(),m("div",_l,[Fe(a.id).length>0?(u(),m("div",fl,[(u(!0),m(J,null,W(Fe(a.id),V=>(u(),U(Pe,{key:V.id,content:`仿品: ${V.title}`,placement:"top"},{default:l(()=>[t(w,{type:"warning",size:"small",style:{margin:"2px",cursor:"pointer"},onClick:At=>ve(V)},{default:l(()=>[...e[43]||(e[43]=[i(" 仿品 ",-1)])]),_:1},8,["onClick"])]),_:2},1032,["content"]))),128))])):(u(),m("span",ml,"-"))])):a.b_page_product_id?(u(),m("div",gl,[t(Pe,{content:`关联正品: ${bt(a.b_page_product_id)}`,placement:"top"},{default:l(()=>[t(w,{type:"info",size:"small",style:{cursor:"pointer"},onClick:V=>Vt(a.b_page_product_id)},{default:l(()=>[...e[44]||(e[44]=[i(" 已关联 ",-1)])]),_:1},8,["onClick"])]),_:2},1032,["content"])])):(u(),m("span",vl,"未关联"))]),_:1}),t(z,{prop:"country",label:"国家",width:"80",align:"center"},{default:l(({row:a})=>[t(w,{type:"primary",size:"small"},{default:l(()=>[i(_(a.country||"JA"),1)]),_:2},1024)]),_:1}),t(z,{prop:"status",label:"状态",width:"100",align:"center"},{default:l(({row:a})=>[t(w,{type:Je(a.status),size:"small",effect:"light"},{default:l(()=>[i(_(We(a.status)),1)]),_:2},1032,["type"])]),_:1}),t(z,{prop:"view_count",label:"浏览量",width:"100",align:"center"},{default:l(({row:a})=>[o("div",yl,[t(n,{class:"count-icon"},{default:l(()=>[t(g(De))]),_:1}),o("span",null,_(a.view_count||0),1)])]),_:1}),t(z,{prop:"sale_count",label:"销量",width:"100",align:"center"},{default:l(({row:a})=>[o("div",kl,[t(n,{class:"count-icon"},{default:l(()=>[t(g(Lt))]),_:1}),o("span",null,_(a.sale_count||0),1)])]),_:1}),t(z,{prop:"created_at",label:"创建时间",width:"180","show-overflow-tooltip":""},{default:l(({row:a})=>[o("div",bl,[t(n,{class:"time-icon"},{default:l(()=>[t(g(Ot))]),_:1}),o("span",null,_(a.created_at),1)])]),_:1}),t(z,{label:"操作",width:"350",fixed:"right",align:"center"},{default:l(({row:a})=>[o("div",Vl,[t(y,{size:"small",type:"primary",link:"",onClick:V=>ve(a)},{default:l(()=>[t(n,null,{default:l(()=>[t(g(De))]),_:1}),e[45]||(e[45]=i(" 查看 ",-1))]),_:1},8,["onClick"]),t(y,{size:"small",type:"success",link:"",onClick:V=>rt(a)},{default:l(()=>[t(n,null,{default:l(()=>[t(g(jt))]),_:1}),e[46]||(e[46]=i(" SKU管理 ",-1))]),_:1},8,["onClick"]),a.product_type==="original"?(u(),U(y,{key:0,size:"small",type:"info",link:"",onClick:V=>wt(a)},{default:l(()=>[t(n,null,{default:l(()=>[t(g(Y))]),_:1}),e[47]||(e[47]=i(" 关联仿品 ",-1))]),_:1},8,["onClick"])):Z("",!0),t(y,{size:"small",type:"warning",link:"",onClick:V=>Xe(a)},{default:l(()=>[t(n,null,{default:l(()=>[t(g(Et))]),_:1}),e[48]||(e[48]=i(" 编辑 ",-1))]),_:1},8,["onClick"]),t(y,{size:"small",type:"danger",link:"",onClick:V=>Ye(a)},{default:l(()=>[t(n,null,{default:l(()=>[t(g(Le))]),_:1}),e[49]||(e[49]=i(" 删除 ",-1))]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["data"])),[[we,h.value]]),o("div",wl,[t(Ke,{"current-page":x.current,"onUpdate:currentPage":e[3]||(e[3]=a=>x.current=a),"page-size":x.size,"onUpdate:pageSize":e[4]||(e[4]=a=>x.size=a),"page-sizes":[10,20,50,100],total:x.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:tt,onCurrentChange:lt},null,8,["current-page","page-size","total"])])]),_:1}),t(de,{modelValue:K.value,"onUpdate:modelValue":e[15]||(e[15]=a=>K.value=a),title:ee.value,fullscreen:!0,"close-on-click-modal":!1,"destroy-on-close":"",class:"product-dialog"},{footer:l(()=>[o("div",Ul,[t(y,{onClick:e[14]||(e[14]=a=>K.value=!1)},{default:l(()=>[...e[66]||(e[66]=[i("取消",-1)])]),_:1}),t(y,{type:"primary",onClick:et,loading:q.value},{default:l(()=>[...e[67]||(e[67]=[i(" 确定 ",-1)])]),_:1},8,["loading"])])]),default:l(()=>[t(be,{model:d,rules:Ne,ref_key:"formRef",ref:re,"label-width":"100px",class:"product-form"},{default:l(()=>[t(f,{label:"SPU ID"},{default:l(()=>[t(C,{modelValue:d.spu_id,"onUpdate:modelValue":e[5]||(e[5]=a=>d.spu_id=a),placeholder:"保存后生成",readonly:""},null,8,["modelValue"]),e[50]||(e[50]=o("div",{class:"form-tip"},"SPU ID由后端自动生成，创建商品后自动显示",-1))]),_:1}),t(f,{label:"商品标题",prop:"title"},{default:l(()=>[t(C,{modelValue:d.title,"onUpdate:modelValue":e[6]||(e[6]=a=>d.title=a),placeholder:"请输入商品标题"},null,8,["modelValue"])]),_:1}),t(O,{gutter:20},{default:l(()=>[t(S,{span:12},{default:l(()=>[t(f,{label:"销售价格",prop:"sell_price"},{default:l(()=>[t(L,{modelValue:d.sell_price,"onUpdate:modelValue":e[7]||(e[7]=a=>d.sell_price=a),precision:2,min:0,placeholder:"请输入销售价格",style:{width:"100%"}},{append:l(()=>[...e[51]||(e[51]=[i("元",-1)])]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(S,{span:12},{default:l(()=>[t(f,{label:"原价",prop:"origin_price"},{default:l(()=>[t(L,{modelValue:d.origin_price,"onUpdate:modelValue":e[8]||(e[8]=a=>d.origin_price=a),precision:2,min:0,placeholder:"请输入原价",style:{width:"100%"}},{append:l(()=>[...e[52]||(e[52]=[i("元",-1)])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(O,{gutter:20},{default:l(()=>[t(S,{span:12},{default:l(()=>[t(f,{label:"折扣(%)",prop:"discount"},{default:l(()=>[t(L,{modelValue:d.discount,"onUpdate:modelValue":e[9]||(e[9]=a=>d.discount=a),precision:0,min:0,max:100,placeholder:"请输入折扣",style:{width:"100%"}},{append:l(()=>[...e[53]||(e[53]=[i("%",-1)])]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(S,{span:12},{default:l(()=>[t(f,{label:"状态",prop:"status"},{default:l(()=>[t(Q,{modelValue:d.status,"onUpdate:modelValue":e[10]||(e[10]=a=>d.status=a),style:{width:"100%"}},{default:l(()=>[t(P,{label:"上架",value:"active"},{default:l(()=>[t(w,{type:"success",size:"small"},{default:l(()=>[...e[54]||(e[54]=[i("上架",-1)])]),_:1})]),_:1}),t(P,{label:"下架",value:"inactive"},{default:l(()=>[t(w,{type:"danger",size:"small"},{default:l(()=>[...e[55]||(e[55]=[i("下架",-1)])]),_:1})]),_:1}),t(P,{label:"草稿",value:"draft"},{default:l(()=>[t(w,{type:"warning",size:"small"},{default:l(()=>[...e[56]||(e[56]=[i("草稿",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(O,{gutter:20},{default:l(()=>[t(S,{span:12},{default:l(()=>[t(f,{label:"商品类型",prop:"product_type"},{default:l(()=>[t(xt,{modelValue:d.product_type,"onUpdate:modelValue":e[11]||(e[11]=a=>d.product_type=a),onChange:yt},{default:l(()=>[t(Ve,{value:"original"},{default:l(()=>[t(w,{type:"success",size:"small"},{default:l(()=>[...e[57]||(e[57]=[i("正品",-1)])]),_:1}),e[58]||(e[58]=i(" 正品商品 ",-1))]),_:1}),t(Ve,{value:"fake"},{default:l(()=>[t(w,{type:"warning",size:"small"},{default:l(()=>[...e[59]||(e[59]=[i("仿品",-1)])]),_:1}),e[60]||(e[60]=i(" 仿品商品 ",-1))]),_:1})]),_:1},8,["modelValue"]),e[61]||(e[61]=o("div",{class:"form-tip"},"正品：用户默认看到的商品；仿品：替代展示的商品",-1))]),_:1})]),_:1}),t(S,{span:12},{default:l(()=>[d.product_type==="fake"?(u(),U(f,{key:0,label:"关联正品",prop:"b_page_product_id"},{default:l(()=>[t(Q,{modelValue:d.b_page_product_id,"onUpdate:modelValue":e[12]||(e[12]=a=>d.b_page_product_id=a),placeholder:"请选择对应的正品商品",filterable:"",remote:"","remote-method":kt,loading:G.value,style:{width:"100%"}},{default:l(()=>[(u(!0),m(J,null,W(ae.value,a=>(u(),U(P,{key:a.id,label:`${a.title} - ¥${a.sell_price}`,value:a.id},{default:l(()=>[o("div",hl,[o("span",null,_(a.title),1),o("span",zl,"¥"+_(a.sell_price),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","loading"]),e[62]||(e[62]=o("div",{class:"form-tip"},"选择这个仿品对应的正品商品",-1))]),_:1})):Z("",!0)]),_:1})]),_:1}),t(O,{gutter:20},{default:l(()=>[t(S,{span:12},{default:l(()=>[t(f,{label:"目标国家",prop:"country"},{default:l(()=>[t(Q,{modelValue:d.country,"onUpdate:modelValue":e[13]||(e[13]=a=>d.country=a),placeholder:"请选择目标国家",style:{width:"100%"}},{default:l(()=>[(u(),m(J,null,W(qe,a=>t(P,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),e[63]||(e[63]=o("div",{class:"form-tip"},"选择商品投放的目标国家/地区",-1))]),_:1})]),_:1})]),_:1}),t(f,{label:"商品图片",prop:"image_urls"},{default:l(()=>[t($t,{class:"upload-demo",drag:"",action:$e.value,multiple:"","file-list":le.value,"before-upload":at,"on-success":st,"on-remove":ot,"on-error":it,"list-type":"picture-card",accept:"image/*"},{default:l(()=>[t(n,{class:"el-icon--upload"},{default:l(()=>[t(g(It))]),_:1}),e[64]||(e[64]=o("div",{class:"el-upload__text"},[i("将图片拖到此处，或"),o("em",null,"点击上传")],-1))]),_:1},8,["action","file-list"])]),_:1}),t(f,{label:"商品描述",prop:"rich_text_content"},{default:l(()=>[o("div",{class:Oe(["wang-editor-wrapper",N.value?"fullscreen":""])},[t(Rt,{value:d.rich_text_content||"",height:Be.value,"editor-config":Re.value,"onUpdate:value":ut},null,8,["value","height","editor-config"]),o("div",Sl,[t(y,{size:"small",onClick:nt,title:"调整编辑器大小"},{default:l(()=>[t(n,null,{default:l(()=>[N.value?(u(),U(g(qt),{key:0})):(u(),U(g(Bt),{key:1}))]),_:1}),i(" "+_(N.value?"恢复":"全屏编辑"),1)]),_:1}),t(y,{size:"small",onClick:dt,title:"清空内容"},{default:l(()=>[t(n,null,{default:l(()=>[t(g(Le))]),_:1}),e[65]||(e[65]=i(" 清空内容 ",-1))]),_:1})])],2)]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),t(de,{modelValue:pe.value,"onUpdate:modelValue":e[16]||(e[16]=a=>pe.value=a),title:"SKU管理",width:"1200px","close-on-click-modal":!1,"destroy-on-close":""},{default:l(()=>[o("div",Cl,[o("div",xl,[o("div",$l,[e[69]||(e[69]=o("h3",null,"SKU列表",-1)),t(y,{type:"primary",onClick:_t},{default:l(()=>[t(n,null,{default:l(()=>[t(g(Y))]),_:1}),e[68]||(e[68]=i(" 添加SKU ",-1))]),_:1})]),Se((u(),U(Ae,{data:xe.value,stripe:"",border:"",style:{width:"100%"}},{default:l(()=>[t(z,{prop:"sku_code",label:"SKU编码",width:"120"}),t(z,{prop:"sku_name",label:"SKU名称",width:"150"}),t(z,{label:"属性组合","min-width":"200"},{default:l(({row:a})=>[o("div",Fl,[(u(!0),m(J,null,W(a.attributes,V=>(u(),U(w,{key:V.attribute_name,size:"small",class:"attr-tag"},{default:l(()=>[i(_(V.display_name)+": "+_(V.display_value),1)]),_:2},1024))),128))])]),_:1}),t(z,{prop:"sell_price",label:"销售价格",width:"100",align:"center"},{default:l(({row:a})=>[o("span",Pl,"¥"+_(a.sell_price),1)]),_:1}),t(z,{prop:"stock_quantity",label:"库存",width:"80",align:"center"}),t(z,{prop:"status",label:"状态",width:"100",align:"center"},{default:l(({row:a})=>[t(w,{type:Ze(a.status),size:"small"},{default:l(()=>[i(_(He(a.status)),1)]),_:2},1032,["type"])]),_:1}),t(z,{label:"操作",width:"150",align:"center"},{default:l(({row:a})=>[t(y,{size:"small",type:"primary",link:"",onClick:V=>ft(a)},{default:l(()=>[...e[70]||(e[70]=[i("编辑",-1)])]),_:1},8,["onClick"]),t(y,{size:"small",type:"danger",link:"",onClick:V=>mt(a)},{default:l(()=>[...e[71]||(e[71]=[i("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[we,_e.value]])])])]),_:1},8,["modelValue"]),t(de,{modelValue:B.value,"onUpdate:modelValue":e[28]||(e[28]=a=>B.value=a),title:ce.value,width:"800px","close-on-click-modal":!1,"destroy-on-close":""},{footer:l(()=>[o("div",jl,[t(y,{onClick:e[27]||(e[27]=a=>B.value=!1)},{default:l(()=>[...e[75]||(e[75]=[i("取消",-1)])]),_:1}),t(y,{type:"primary",onClick:vt,loading:fe.value},{default:l(()=>[...e[76]||(e[76]=[i("确定",-1)])]),_:1},8,["loading"])])]),default:l(()=>[t(be,{model:v,rules:Me,ref_key:"skuFormRef",ref:me,"label-width":"100px"},{default:l(()=>[t(O,{gutter:20},{default:l(()=>[t(S,{span:12},{default:l(()=>[t(f,{label:"SKU编码",prop:"sku_code"},{default:l(()=>[t(C,{modelValue:v.sku_code,"onUpdate:modelValue":e[17]||(e[17]=a=>v.sku_code=a),placeholder:"自动生成"},null,8,["modelValue"])]),_:1})]),_:1}),t(S,{span:12},{default:l(()=>[t(f,{label:"SKU名称",prop:"sku_name"},{default:l(()=>[t(C,{modelValue:v.sku_name,"onUpdate:modelValue":e[18]||(e[18]=a=>v.sku_name=a),placeholder:"请输入SKU名称"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(O,{gutter:20},{default:l(()=>[t(S,{span:8},{default:l(()=>[t(f,{label:"销售价格",prop:"sell_price"},{default:l(()=>[t(L,{modelValue:v.sell_price,"onUpdate:modelValue":e[19]||(e[19]=a=>v.sell_price=a),min:0,precision:2,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),t(S,{span:8},{default:l(()=>[t(f,{label:"原价",prop:"origin_price"},{default:l(()=>[t(L,{modelValue:v.origin_price,"onUpdate:modelValue":e[20]||(e[20]=a=>v.origin_price=a),min:0,precision:2,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),t(S,{span:8},{default:l(()=>[t(f,{label:"成本价",prop:"cost_price"},{default:l(()=>[t(L,{modelValue:v.cost_price,"onUpdate:modelValue":e[21]||(e[21]=a=>v.cost_price=a),min:0,precision:2,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(O,{gutter:20},{default:l(()=>[t(S,{span:12},{default:l(()=>[t(f,{label:"库存数量",prop:"stock_quantity"},{default:l(()=>[t(L,{modelValue:v.stock_quantity,"onUpdate:modelValue":e[22]||(e[22]=a=>v.stock_quantity=a),min:0,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),t(S,{span:12},{default:l(()=>[t(f,{label:"预警库存",prop:"warning_stock"},{default:l(()=>[t(L,{modelValue:v.warning_stock,"onUpdate:modelValue":e[23]||(e[23]=a=>v.warning_stock=a),min:0,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(f,{label:"SKU规格",prop:"attributes"},{default:l(()=>[o("div",Al,[o("div",Kl,[t(O,{gutter:10},{default:l(()=>[t(S,{span:8},{default:l(()=>[t(C,{modelValue:j.value,"onUpdate:modelValue":e[24]||(e[24]=a=>j.value=a),placeholder:"规格名称，如：颜色"},null,8,["modelValue"])]),_:1}),t(S,{span:12},{default:l(()=>[t(C,{modelValue:E.value,"onUpdate:modelValue":e[25]||(e[25]=a=>E.value=a),placeholder:"规格值，如：红色"},null,8,["modelValue"])]),_:1}),t(S,{span:4},{default:l(()=>[t(y,{type:"primary",onClick:pt,disabled:!j.value||!E.value},{default:l(()=>[t(n,null,{default:l(()=>[t(g(Y))]),_:1}),e[72]||(e[72]=i(" 添加 ",-1))]),_:1},8,["disabled"])]),_:1})]),_:1})]),I.value.length>0?(u(),m("div",Tl,[t(Ft,{"content-position":"left"},{default:l(()=>[...e[73]||(e[73]=[i("已添加的规格",-1)])]),_:1}),o("div",Dl,[(u(!0),m(J,null,W(I.value,(a,V)=>(u(),m("div",{key:V,class:"spec-item"},[o("div",Ll,[o("span",Ol,_(a.name),1),t(w,{type:"primary",size:"small"},{default:l(()=>[i(_(a.value),1)]),_:2},1024)]),t(y,{size:"small",type:"danger",link:"",onClick:At=>ct(V),icon:"Delete"},{default:l(()=>[...e[74]||(e[74]=[i(" 删除 ",-1)])]),_:1},8,["onClick"])]))),128))])])):Z("",!0)])]),_:1}),t(f,{label:"主图URL",prop:"main_image"},{default:l(()=>[t(C,{modelValue:v.main_image,"onUpdate:modelValue":e[26]||(e[26]=a=>v.main_image=a),placeholder:"请输入主图URL"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),t(de,{modelValue:R.value,"onUpdate:modelValue":e[34]||(e[34]=a=>R.value=a),title:"选择关联仿品",width:"1000px","close-on-click-modal":!1,"destroy-on-close":""},{footer:l(()=>[o("div",la,[t(y,{onClick:e[33]||(e[33]=a=>R.value=!1)},{default:l(()=>[...e[82]||(e[82]=[i("取消",-1)])]),_:1}),t(y,{type:"primary",onClick:Ut,disabled:!T.value},{default:l(()=>[...e[83]||(e[83]=[i(" 确定关联 ",-1)])]),_:1},8,["disabled"])])]),default:l(()=>[o("div",El,[t(ue,{class:"current-product-card",shadow:"never"},{header:l(()=>[...e[77]||(e[77]=[o("span",{style:{"font-weight":"600",color:"#409eff"}},"当前正品商品",-1)])]),default:l(()=>[b.value?(u(),m("div",Il,[b.value.image_urls&&b.value.image_urls[0]?(u(),U(M,{key:0,size:60},{default:l(()=>[o("img",{src:b.value.image_urls[0],alt:b.value.title,style:{width:"100%",height:"100%","object-fit":"cover"}},null,8,ql)]),_:1})):(u(),U(M,{key:1,size:60},{default:l(()=>[t(n,null,{default:l(()=>[t(g(Ue))]),_:1})]),_:1})),o("div",Bl,[o("div",Rl,_(b.value.title),1),o("div",Nl,"¥"+_(b.value.sell_price),1),t(w,{type:"success",size:"small"},{default:l(()=>[...e[78]||(e[78]=[i("正品",-1)])]),_:1})])])):Z("",!0)]),_:1}),t(ue,{class:"fake-selection-card",shadow:"never"},{header:l(()=>[o("div",Ml,[e[80]||(e[80]=o("span",{style:{"font-weight":"600"}},"选择要关联的仿品",-1)),t(y,{type:"primary",size:"small",onClick:Ct},{default:l(()=>[t(n,null,{default:l(()=>[t(g(Y))]),_:1}),e[79]||(e[79]=i(" 创建新仿品 ",-1))]),_:1})])]),default:l(()=>[o("div",Jl,[t(C,{modelValue:ie.value,"onUpdate:modelValue":e[29]||(e[29]=a=>ie.value=a),placeholder:"搜索仿品商品...",clearable:"",onInput:ht,style:{width:"300px"}},{prefix:l(()=>[t(n,null,{default:l(()=>[t(g(ze))]),_:1})]),_:1},8,["modelValue"])]),Se((u(),m("div",Wl,[(u(!0),m(J,null,W(se.value,a=>(u(),m("div",{key:a.id,class:Oe(["fake-product-card",{active:T.value===a.id}]),onClick:V=>T.value=a.id},[a.image_urls&&a.image_urls[0]?(u(),U(M,{key:0,size:28},{default:l(()=>[o("img",{src:a.image_urls[0],alt:a.title,style:{width:"100%",height:"100%","object-fit":"cover"}},null,8,Hl)]),_:2},1024)):(u(),U(M,{key:1,size:28},{default:l(()=>[t(n,null,{default:l(()=>[t(g(Ue))]),_:1})]),_:1})),o("div",Gl,[o("div",Ql,_(a.title),1),o("div",Xl,"¥"+_(a.sell_price),1),t(w,{type:"warning",size:"small",style:{padding:"1px 4px","font-size":"10px"}},{default:l(()=>[...e[81]||(e[81]=[i("仿品",-1)])]),_:1})]),o("div",Yl,[t(Ve,{value:a.id,modelValue:T.value,"onUpdate:modelValue":e[30]||(e[30]=V=>T.value=V)},null,8,["value","modelValue"])])],10,Zl))),128)),!oe.value&&se.value.length===0?(u(),m("div",ea,[t(Pt,{description:"暂无可关联的仿品商品"})])):Z("",!0)])),[[we,oe.value]]),se.value.length>0?(u(),m("div",ta,[t(Ke,{"current-page":$.current,"onUpdate:currentPage":e[31]||(e[31]=a=>$.current=a),"page-size":$.size,"onUpdate:pageSize":e[32]||(e[32]=a=>$.size=a),"page-sizes":[12,24,48],total:$.total,layout:"total, sizes, prev, pager, next",onSizeChange:zt,onCurrentChange:St,small:""},null,8,["current-page","page-size","total"])])):Z("",!0)]),_:1})])]),_:1},8,["modelValue"])])}}}),da=Nt(sa,[["__scopeId","data-v-d8fad406"]]);export{da as default};
