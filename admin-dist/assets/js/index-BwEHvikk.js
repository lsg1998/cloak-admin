import{d as D,P as U,h as A,Z as W,r as d,Q as j,c as V,o as r,a as s,b as t,w as e,e as g,u as m,x as L,E as Q,ay as T,t as n,aE as Z,aW as G,bo as E,W as H,g as p,N as J}from"./index-Cdv8dLqN.js";import{a as K}from"./statistics-BEf5_W6F.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";const X={class:"conversion-statistics-page"},Y={class:"overview-stats"},$={class:"stat-content"},tt={class:"stat-icon visitors"},et={class:"stat-info"},st={class:"stat-number"},at={class:"stat-content"},lt={class:"stat-icon orders"},ot={class:"stat-info"},nt={class:"stat-number"},dt={class:"stat-sub"},it={class:"stat-content"},ct={class:"stat-icon rate"},rt={class:"stat-info"},_t={class:"stat-number"},ut={class:"stat-content"},vt={class:"stat-icon products"},ft={class:"stat-info"},mt={class:"stat-number"},pt={key:3},ht={class:"product-cell"},gt=["src"],bt={class:"product-info"},yt={class:"product-title"},wt={class:"product-id"},kt={key:1,class:"no-country"},Ct={class:"visitor-count"},zt={class:"order-count"},Vt={class:"rate-cell"},xt={class:"rate-text"},Rt=D({name:"ConversionStatisticsPage"}),St=D({...Rt,setup(At){const _=U({timeRange:"today",timezone:"Asia/Shanghai"}),y=A(!1),u=A(null),w=i=>i?i.toLocaleString():"0",N=i=>i>=10?"#67C23A":i>=5?"#E6A23C":"#F56C6C",b=async()=>{y.value=!0;try{const i=await K({timeRange:_.timeRange,timezone:_.timezone});i.code===200&&(u.value=i.data)}catch(i){console.error("加载转化统计数据失败:",i),J.error("加载转化统计数据失败")}finally{y.value=!1}},B=()=>{_.timeRange="today",_.timezone="Asia/Shanghai",b()};return W(()=>{b()}),(i,l)=>{const c=d("el-option"),x=d("el-select"),z=d("el-form-item"),v=d("el-icon"),R=d("el-button"),P=d("el-form"),h=d("el-card"),k=d("el-col"),M=d("el-row"),C=d("el-tag"),f=d("el-table-column"),S=d("el-avatar"),q=d("el-progress"),F=d("el-table"),I=j("loading");return r(),V("div",X,[l[9]||(l[9]=s("div",{class:"page-header"},[s("h2",null,"转化统计"),s("p",null,"分析各商品的访问量和下单转化情况（已排除重复单和取消单）")],-1)),t(h,{class:"filter-card",shadow:"never"},{default:e(()=>[t(P,{model:_,inline:"",class:"filter-form"},{default:e(()=>[t(z,{label:"时间段"},{default:e(()=>[t(x,{modelValue:_.timeRange,"onUpdate:modelValue":l[0]||(l[0]=o=>_.timeRange=o),placeholder:"请选择时间段",onChange:b,style:{width:"180px"}},{default:e(()=>[t(c,{label:"今天",value:"today"}),t(c,{label:"昨天",value:"yesterday"}),t(c,{label:"最近3天",value:"3d"}),t(c,{label:"最近7天",value:"7d"}),t(c,{label:"最近30天",value:"30d"}),t(c,{label:"最近半年",value:"6m"}),t(c,{label:"最近一年",value:"1y"}),t(c,{label:"全部",value:"all"})]),_:1},8,["modelValue"])]),_:1}),t(z,{label:"时区"},{default:e(()=>[t(x,{modelValue:_.timezone,"onUpdate:modelValue":l[1]||(l[1]=o=>_.timezone=o),onChange:b,style:{width:"140px"}},{default:e(()=>[t(c,{label:"北京时间",value:"Asia/Shanghai"}),t(c,{label:"欧洲时间",value:"Europe/Paris"})]),_:1},8,["modelValue"])]),_:1}),t(z,null,{default:e(()=>[t(R,{type:"primary",onClick:b,loading:y.value},{default:e(()=>[t(v,null,{default:e(()=>[t(m(L))]),_:1}),l[2]||(l[2]=g(" 查询 ",-1))]),_:1},8,["loading"]),t(R,{onClick:B},{default:e(()=>[t(v,null,{default:e(()=>[t(m(Q))]),_:1}),l[3]||(l[3]=g(" 重置 ",-1))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),s("div",Y,[t(M,{gutter:20},{default:e(()=>[t(k,{xs:24,sm:12,md:6},{default:e(()=>[t(h,{class:"stat-card",shadow:"hover"},{default:e(()=>{var o;return[s("div",$,[s("div",tt,[t(v,null,{default:e(()=>[t(m(T))]),_:1})]),s("div",et,[s("div",st,n(w(((o=u.value)==null?void 0:o.total_visitors)||0)),1),l[4]||(l[4]=s("div",{class:"stat-label"},"总访客数",-1))])])]}),_:1})]),_:1}),t(k,{xs:24,sm:12,md:6},{default:e(()=>[t(h,{class:"stat-card",shadow:"hover"},{default:e(()=>{var o,a;return[s("div",at,[s("div",lt,[t(v,null,{default:e(()=>[t(m(Z))]),_:1})]),s("div",ot,[s("div",nt,n(w(((o=u.value)==null?void 0:o.total_order_users)||0)),1),l[5]||(l[5]=s("div",{class:"stat-label"},"下单用户数",-1)),s("div",dt,"总订单: "+n(((a=u.value)==null?void 0:a.total_orders)||0),1)])])]}),_:1})]),_:1}),t(k,{xs:24,sm:12,md:6},{default:e(()=>[t(h,{class:"stat-card",shadow:"hover"},{default:e(()=>{var o;return[s("div",it,[s("div",ct,[t(v,null,{default:e(()=>[t(m(G))]),_:1})]),s("div",rt,[s("div",_t,n(((o=u.value)==null?void 0:o.overall_conversion_rate)||0)+"%",1),l[6]||(l[6]=s("div",{class:"stat-label"},"总体转化率",-1))])])]}),_:1})]),_:1}),t(k,{xs:24,sm:12,md:6},{default:e(()=>[t(h,{class:"stat-card",shadow:"hover"},{default:e(()=>{var o;return[s("div",ut,[s("div",vt,[t(v,null,{default:e(()=>[t(m(E))]),_:1})]),s("div",ft,[s("div",mt,n(((o=u.value)==null?void 0:o.product_count)||0),1),l[7]||(l[7]=s("div",{class:"stat-label"},"在售商品数",-1))])])]}),_:1})]),_:1})]),_:1})]),t(h,{class:"table-card",shadow:"never"},{header:e(()=>[...l[8]||(l[8]=[s("div",{class:"card-header"},[s("span",{class:"card-title"},"商品转化详情")],-1)])]),default:e(()=>{var o;return[H((r(),p(F,{data:((o=u.value)==null?void 0:o.conversion_data)||[],border:""},{default:e(()=>[t(f,{label:"排名",width:"70",align:"center"},{default:e(({$index:a})=>[a===0?(r(),p(C,{key:0,type:"danger",size:"small"},{default:e(()=>[g(n(a+1),1)]),_:2},1024)):a===1?(r(),p(C,{key:1,type:"warning",size:"small"},{default:e(()=>[g(n(a+1),1)]),_:2},1024)):a===2?(r(),p(C,{key:2,type:"success",size:"small"},{default:e(()=>[g(n(a+1),1)]),_:2},1024)):(r(),V("span",pt,n(a+1),1))]),_:1}),t(f,{label:"商品","min-width":"250"},{default:e(({row:a})=>[s("div",ht,[a.product_image?(r(),p(S,{key:0,size:50,shape:"square"},{default:e(()=>[s("img",{src:a.product_image,style:{width:"100%",height:"100%","object-fit":"cover"}},null,8,gt)]),_:2},1024)):(r(),p(S,{key:1,size:50,shape:"square"},{default:e(()=>[t(v,null,{default:e(()=>[t(m(E))]),_:1})]),_:1})),s("div",bt,[s("div",yt,n(a.product_title),1),s("div",wt,"ID: "+n(a.product_id),1)])])]),_:1}),t(f,{label:"国家",width:"100",align:"center"},{default:e(({row:a})=>[a.country?(r(),p(C,{key:0,type:"info",size:"small"},{default:e(()=>[g(n(a.country),1)]),_:2},1024)):(r(),V("span",kt,"-"))]),_:1}),t(f,{label:"访问人数",width:"120",align:"center"},{default:e(({row:a})=>[s("span",Ct,n(w(a.visitor_count)),1)]),_:1}),t(f,{label:"下单人数",width:"120",align:"center"},{default:e(({row:a})=>[s("span",zt,n(w(a.order_count)),1)]),_:1}),t(f,{label:"订单数",width:"100",align:"center"},{default:e(({row:a})=>[s("span",null,n(a.total_orders),1)]),_:1}),t(f,{label:"转化率",width:"180"},{default:e(({row:a})=>[s("div",Vt,[t(q,{percentage:Math.min(a.conversion_rate,100),"stroke-width":12,color:N(a.conversion_rate)},null,8,["percentage","color"]),s("span",xt,n(a.conversion_rate)+"%",1)])]),_:1})]),_:1},8,["data"])),[[I,y.value]])]}),_:1})])}}}),Bt=O(St,[["__scopeId","data-v-1da42d79"]]);export{Bt as default};
