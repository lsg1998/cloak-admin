import{d as $,P as B,h as k,s as L,a8 as ue,Z as re,r as i,Q as ce,c as h,o as n,a as s,b as e,w as t,F as G,f as J,e as c,u as v,x as W,E as _e,V as pe,aE as me,t as d,aF as fe,aR as N,aB as ge,W as O,g as _,a5 as ve,N as X}from"./index-cca_yqSo.js";import{_ as ye}from"./_plugin-vue_export-helper-DlAUqK2U.js";const he={class:"sales-statistics"},be={class:"overview-stats"},we={class:"stat-content"},ke={class:"stat-icon total"},Ve={class:"stat-info"},ze={class:"stat-number"},Ce={class:"stat-sub"},Re={class:"stat-content"},xe={class:"stat-icon revenue"},De={class:"stat-info"},Te={class:"stat-number"},Ee={class:"stat-sub"},Se={class:"stat-content"},qe={class:"stat-icon products"},Pe={class:"stat-info"},Me={class:"stat-number"},Be={class:"stat-sub"},Le={class:"stat-content"},Ne={class:"stat-icon countries"},Oe={class:"stat-info"},Ue={class:"stat-number"},Ye={class:"stat-sub"},Fe={class:"card-header"},Ie={key:3},je={class:"product-cell"},Qe=["src"],Ae={class:"product-info"},He={class:"product-title"},Ke={class:"product-id"},Ze={class:"quantity"},Ge={class:"amount"},Je={class:"card-header"},We={key:3},Xe={class:"quantity"},$e={class:"amount"},et={class:"card-header"},tt={class:"product-cell"},at=["src"],lt={class:"product-info"},st={class:"product-title"},ot={class:"total-quantity"},nt={class:"total-amount"},dt={key:0},it={key:1,style:{color:"#c0c4cc"}},ut={key:0,style:{color:"#909399"}},rt={key:1,style:{color:"#c0c4cc"}},ct=$({name:"SalesStatistics"}),_t=$({...ct,setup(pt){const u=B({dateRange:[],productType:"",country:""}),ee=[{code:"JA",name:"日本"},{code:"JP",name:"日本"},{code:"ZH",name:"中国"},{code:"CN",name:"中国"},{code:"EN",name:"英国"},{code:"SK",name:"斯洛伐克"},{code:"SI",name:"斯洛文尼亚"},{code:"PL",name:"波兰"},{code:"PT",name:"葡萄牙"},{code:"HU",name:"匈牙利"},{code:"ES",name:"西班牙"},{code:"IT",name:"意大利"},{code:"CZ",name:"捷克"},{code:"LT",name:"立陶宛"},{code:"LV",name:"拉脱维亚"},{code:"HR",name:"克罗地亚"},{code:"DE",name:"德国"},{code:"AT",name:"奥地利"},{code:"RO",name:"罗马尼亚"},{code:"FR",name:"法国"},{code:"BE",name:"比利时"},{code:"NL",name:"荷兰"},{code:"GR",name:"希腊"},{code:"BG",name:"保加利亚"},{code:"SE",name:"瑞典"},{code:"FI",name:"芬兰"},{code:"DK",name:"丹麦"},{code:"NO",name:"挪威"},{code:"IE",name:"爱尔兰"},{code:"CH",name:"瑞士"},{code:"EE",name:"爱沙尼亚"},{code:"RS",name:"塞尔维亚"},{code:"BA",name:"波黑"},{code:"ME",name:"黑山"},{code:"MK",name:"北马其顿"},{code:"AL",name:"阿尔巴尼亚"}],z=k(!1),U=k("quantity"),Y=k("quantity"),y=B({totalOrders:0,totalQuantity:0,totalRevenue:0,avgOrderValue:0,totalProducts:0,activeProducts:0,totalCountries:0,topCountry:"-"}),F=k([]),S=k([]),I=k([]),C=k(""),p=B({current:1,size:10,total:0}),te=L(()=>S.value.slice(0,5).map(o=>({code:o.country_code,name:o.country_name}))),j=L(()=>{let o=I.value;if(C.value){const a=C.value.toLowerCase();o=o.filter(m=>m.title.toLowerCase().includes(a))}return o}),ae=L(()=>{const o=j.value,a=(p.current-1)*p.size,m=a+p.size;return o.slice(a,m)});ue(j,o=>{p.total=o.length});const R=o=>o?o.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,","):"0.00",le=()=>{p.current=1},f=async()=>{z.value=!0;try{const o={};u.dateRange&&u.dateRange.length===2&&(o.start_date=u.dateRange[0],o.end_date=u.dateRange[1]),u.productType&&(o.product_type=u.productType),u.country&&(o.country=u.country);const{data:a}=await ve.get("/admin/statistics/sales",o);Object.assign(y,a.overview),F.value=a.product_ranking.map(m=>({...m,percentage:Math.round(m.quantity/a.overview.totalQuantity*100)})),S.value=a.country_ranking.map(m=>({...m,percentage:Math.round(m.quantity/a.overview.totalQuantity*100)})),I.value=a.detail_data,p.current=1}catch(o){console.error("加载销售统计失败:",o),X.error(o.message||"加载销售统计数据失败")}finally{z.value=!1}},se=()=>{u.dateRange=[],u.productType="",u.country="",f()},oe=()=>{X.success("导出功能开发中...")};return re(()=>{f()}),(o,a)=>{const m=i("el-date-picker"),x=i("el-form-item"),D=i("el-option"),Q=i("el-select"),g=i("el-icon"),q=i("el-button"),ne=i("el-form"),b=i("el-card"),V=i("el-col"),A=i("el-row"),T=i("el-radio-button"),H=i("el-radio-group"),w=i("el-tag"),r=i("el-table-column"),E=i("el-avatar"),K=i("el-progress"),P=i("el-table"),de=i("el-input"),ie=i("el-pagination"),M=ce("loading");return n(),h("div",he,[a[28]||(a[28]=s("div",{class:"page-header"},[s("h2",null,"商品销售统计"),s("p",null,"分析商品销量、国家分布、销售趋势等数据")],-1)),e(b,{class:"filter-card",shadow:"never"},{default:t(()=>[e(ne,{model:u,inline:"",class:"filter-form"},{default:t(()=>[e(x,{label:"时间范围"},{default:t(()=>[e(m,{modelValue:u.dateRange,"onUpdate:modelValue":a[0]||(a[0]=l=>u.dateRange=l),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",onChange:f,style:{width:"280px"}},null,8,["modelValue"])]),_:1}),e(x,{label:"商品类型"},{default:t(()=>[e(Q,{modelValue:u.productType,"onUpdate:modelValue":a[1]||(a[1]=l=>u.productType=l),placeholder:"请选择类型",clearable:"",style:{width:"120px"},onChange:f},{default:t(()=>[e(D,{label:"全部",value:""}),e(D,{label:"正品",value:"original"})]),_:1},8,["modelValue"])]),_:1}),e(x,{label:"国家"},{default:t(()=>[e(Q,{modelValue:u.country,"onUpdate:modelValue":a[2]||(a[2]=l=>u.country=l),placeholder:"请选择国家",clearable:"",style:{width:"150px"},onChange:f},{default:t(()=>[e(D,{label:"全部国家",value:""}),(n(),h(G,null,J(ee,l=>e(D,{key:l.code,label:l.name,value:l.code},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),e(x,null,{default:t(()=>[e(q,{type:"primary",onClick:f},{default:t(()=>[e(g,null,{default:t(()=>[e(v(W))]),_:1}),a[8]||(a[8]=c(" 查询 ",-1))]),_:1}),e(q,{onClick:se},{default:t(()=>[e(g,null,{default:t(()=>[e(v(_e))]),_:1}),a[9]||(a[9]=c(" 重置 ",-1))]),_:1}),e(q,{type:"success",onClick:oe},{default:t(()=>[e(g,null,{default:t(()=>[e(v(pe))]),_:1}),a[10]||(a[10]=c(" 导出 ",-1))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),s("div",be,[e(A,{gutter:20},{default:t(()=>[e(V,{span:6},{default:t(()=>[e(b,{class:"stat-card"},{default:t(()=>[s("div",we,[s("div",ke,[e(g,null,{default:t(()=>[e(v(me))]),_:1})]),s("div",Ve,[s("div",ze,d(y.totalOrders),1),a[11]||(a[11]=s("div",{class:"stat-label"},"总订单数",-1)),s("div",Ce,d(y.totalQuantity)+" 件商品",1)])])]),_:1})]),_:1}),e(V,{span:6},{default:t(()=>[e(b,{class:"stat-card"},{default:t(()=>[s("div",Re,[s("div",xe,[e(g,null,{default:t(()=>[e(v(fe))]),_:1})]),s("div",De,[s("div",Te,"¥"+d(R(y.totalRevenue)),1),a[12]||(a[12]=s("div",{class:"stat-label"},"总销售额",-1)),s("div",Ee,"均价: ¥"+d(y.avgOrderValue),1)])])]),_:1})]),_:1}),e(V,{span:6},{default:t(()=>[e(b,{class:"stat-card"},{default:t(()=>[s("div",Se,[s("div",qe,[e(g,null,{default:t(()=>[e(v(N))]),_:1})]),s("div",Pe,[s("div",Me,d(y.totalProducts),1),a[13]||(a[13]=s("div",{class:"stat-label"},"在售商品",-1)),s("div",Be,d(y.activeProducts)+" 个有销量",1)])])]),_:1})]),_:1}),e(V,{span:6},{default:t(()=>[e(b,{class:"stat-card"},{default:t(()=>[s("div",Le,[s("div",Ne,[e(g,null,{default:t(()=>[e(v(ge))]),_:1})]),s("div",Oe,[s("div",Ue,d(y.totalCountries),1),a[14]||(a[14]=s("div",{class:"stat-label"},"覆盖国家",-1)),s("div",Ye,d(y.topCountry)+" 销量最高",1)])])]),_:1})]),_:1})]),_:1})]),e(A,{gutter:20,style:{"margin-top":"20px"}},{default:t(()=>[e(V,{span:12},{default:t(()=>[e(b,{shadow:"never"},{header:t(()=>[s("div",Fe,[a[17]||(a[17]=s("span",{class:"card-title"},"商品销量排行 TOP 10",-1)),e(H,{modelValue:U.value,"onUpdate:modelValue":a[3]||(a[3]=l=>U.value=l),size:"small",onChange:f},{default:t(()=>[e(T,{label:"quantity"},{default:t(()=>[...a[15]||(a[15]=[c("按数量",-1)])]),_:1}),e(T,{label:"amount"},{default:t(()=>[...a[16]||(a[16]=[c("按金额",-1)])]),_:1})]),_:1},8,["modelValue"])])]),default:t(()=>[O((n(),_(P,{data:F.value,"max-height":"500"},{default:t(()=>[e(r,{label:"排名",width:"60",align:"center"},{default:t(({$index:l})=>[l===0?(n(),_(w,{key:0,type:"danger",size:"small"},{default:t(()=>[...a[18]||(a[18]=[c("1",-1)])]),_:1})):l===1?(n(),_(w,{key:1,type:"warning",size:"small"},{default:t(()=>[...a[19]||(a[19]=[c("2",-1)])]),_:1})):l===2?(n(),_(w,{key:2,type:"success",size:"small"},{default:t(()=>[...a[20]||(a[20]=[c("3",-1)])]),_:1})):(n(),h("span",Ie,d(l+1),1))]),_:1}),e(r,{label:"商品","min-width":"200","show-overflow-tooltip":""},{default:t(({row:l})=>[s("div",je,[l.image?(n(),_(E,{key:0,size:40},{default:t(()=>[s("img",{src:l.image,style:{width:"100%",height:"100%","object-fit":"cover"}},null,8,Qe)]),_:2},1024)):(n(),_(E,{key:1,size:40},{default:t(()=>[e(g,null,{default:t(()=>[e(v(N))]),_:1})]),_:1})),s("div",Ae,[s("div",He,d(l.title),1),s("div",Ke,"ID: "+d(l.product_id),1)])])]),_:1}),e(r,{label:"销量",width:"100",align:"right"},{default:t(({row:l})=>[s("span",Ze,d(l.quantity),1)]),_:1}),e(r,{label:"销售额",width:"120",align:"right"},{default:t(({row:l})=>[s("span",Ge,"¥"+d(R(l.amount)),1)]),_:1}),e(r,{label:"占比",width:"100"},{default:t(({row:l})=>[e(K,{percentage:l.percentage,"stroke-width":8},null,8,["percentage"])]),_:1})]),_:1},8,["data"])),[[M,z.value]])]),_:1})]),_:1}),e(V,{span:12},{default:t(()=>[e(b,{shadow:"never"},{header:t(()=>[s("div",Je,[a[23]||(a[23]=s("span",{class:"card-title"},"国家销量分布 TOP 10",-1)),e(H,{modelValue:Y.value,"onUpdate:modelValue":a[4]||(a[4]=l=>Y.value=l),size:"small",onChange:f},{default:t(()=>[e(T,{label:"quantity"},{default:t(()=>[...a[21]||(a[21]=[c("按数量",-1)])]),_:1}),e(T,{label:"amount"},{default:t(()=>[...a[22]||(a[22]=[c("按金额",-1)])]),_:1})]),_:1},8,["modelValue"])])]),default:t(()=>[O((n(),_(P,{data:S.value,"max-height":"500"},{default:t(()=>[e(r,{label:"排名",width:"60",align:"center"},{default:t(({$index:l})=>[l===0?(n(),_(w,{key:0,type:"danger",size:"small"},{default:t(()=>[...a[24]||(a[24]=[c("1",-1)])]),_:1})):l===1?(n(),_(w,{key:1,type:"warning",size:"small"},{default:t(()=>[...a[25]||(a[25]=[c("2",-1)])]),_:1})):l===2?(n(),_(w,{key:2,type:"success",size:"small"},{default:t(()=>[...a[26]||(a[26]=[c("3",-1)])]),_:1})):(n(),h("span",We,d(l+1),1))]),_:1}),e(r,{label:"国家","min-width":"120"},{default:t(({row:l})=>[e(w,{type:"success",size:"small"},{default:t(()=>[c(d(l.country_name),1)]),_:2},1024)]),_:1}),e(r,{label:"订单数",width:"100",align:"right"},{default:t(({row:l})=>[s("span",null,d(l.orders),1)]),_:1}),e(r,{label:"销量",width:"100",align:"right"},{default:t(({row:l})=>[s("span",Xe,d(l.quantity),1)]),_:1}),e(r,{label:"销售额",width:"120",align:"right"},{default:t(({row:l})=>[s("span",$e,"¥"+d(R(l.amount)),1)]),_:1}),e(r,{label:"占比",width:"100"},{default:t(({row:l})=>[e(K,{percentage:l.percentage,"stroke-width":8,color:"#67c23a"},null,8,["percentage"])]),_:1})]),_:1},8,["data"])),[[M,z.value]])]),_:1})]),_:1})]),_:1}),e(b,{shadow:"never",style:{"margin-top":"20px"}},{header:t(()=>[s("div",et,[a[27]||(a[27]=s("span",{class:"card-title"},"商品国家销售明细",-1)),e(de,{modelValue:C.value,"onUpdate:modelValue":a[5]||(a[5]=l=>C.value=l),placeholder:"搜索商品名称",clearable:"",style:{width:"200px"},onInput:le},{prefix:t(()=>[e(g,null,{default:t(()=>[e(v(W))]),_:1})]),_:1},8,["modelValue"])])]),default:t(()=>[O((n(),_(P,{data:ae.value,border:"",style:{width:"100%"}},{default:t(()=>[e(r,{label:"商品","min-width":"250",fixed:"","show-overflow-tooltip":""},{default:t(({row:l})=>[s("div",tt,[l.image?(n(),_(E,{key:0,size:40},{default:t(()=>[s("img",{src:l.image,style:{width:"100%",height:"100%","object-fit":"cover"}},null,8,at)]),_:2},1024)):(n(),_(E,{key:1,size:40},{default:t(()=>[e(g,null,{default:t(()=>[e(v(N))]),_:1})]),_:1})),s("div",lt,[s("div",st,d(l.title),1)])])]),_:1}),e(r,{label:"总销量",width:"100",align:"right"},{default:t(({row:l})=>[s("span",ot,d(l.total_quantity),1)]),_:1}),e(r,{label:"总销售额",width:"120",align:"right"},{default:t(({row:l})=>[s("span",nt,"¥"+d(R(l.total_amount)),1)]),_:1}),(n(!0),h(G,null,J(te.value,l=>(n(),_(r,{key:l.code,label:l.name,width:"100",align:"right"},{default:t(({row:Z})=>[Z.countries[l.code]?(n(),h("span",dt,d(Z.countries[l.code]),1)):(n(),h("span",it,"-"))]),_:2},1032,["label"]))),128)),e(r,{label:"其他国家",width:"100",align:"right"},{default:t(({row:l})=>[l.other_countries>0?(n(),h("span",ut,d(l.other_countries),1)):(n(),h("span",rt,"-"))]),_:1})]),_:1},8,["data"])),[[M,z.value]]),e(ie,{"current-page":p.current,"onUpdate:currentPage":a[6]||(a[6]=l=>p.current=l),"page-size":p.size,"onUpdate:pageSize":a[7]||(a[7]=l=>p.size=l),total:p.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:f,onSizeChange:f,style:{"margin-top":"16px","justify-content":"flex-end"}},null,8,["current-page","page-size","total"])]),_:1})])}}}),gt=ye(_t,[["__scopeId","data-v-a9a73697"]]);export{gt as default};
