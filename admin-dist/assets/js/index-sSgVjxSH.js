import{d as M,h as b,P as Z,Z as de,r as s,Q as re,c as ue,o as j,b as e,w as l,_ as N,u as _,x as P,aq as R,e as i,E as K,W as pe,a as u,g as ce,t as w,ar as _e,as as me,U as fe,$ as ge,N as V,a0 as ve}from"./index-D7bJBabU.js";import{g as be,d as we,u as ye,c as Ve}from"./domainConfig-tJcYH7iY.js";import{_ as he}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Ce={class:"domain-config-management"},ze={class:"card-header"},xe={class:"header-left"},ke={class:"table-actions"},Ue={class:"domain-info"},De={class:"time-info"},Se={class:"action-buttons"},Ae={class:"pagination-wrapper"},Ze={class:"dialog-footer"},Te=M({name:"DomainConfigList"}),$e=M({...Te,setup(qe){const U=b(!1),D=b(!1),y=b(!1),S=b(""),A=b(),m=Z({name:"",domain:"",is_active:null}),T=b([]),O=b([]),d=Z({page:1,size:20,total:0}),o=Z({id:null,name:"",domain:"",protocol:"https",is_active:1,is_wildcard:0,sort_order:0,description:""}),F={name:[{required:!0,message:"请输入域名名称",trigger:"blur"}],domain:[{required:!0,message:"请输入域名地址",trigger:"blur"},{pattern:/^[a-zA-Z0-9][a-zA-Z0-9-]{0,61}[a-zA-Z0-9](\.[a-zA-Z0-9][a-zA-Z0-9-]{0,61}[a-zA-Z0-9])*$/,message:"请输入有效的域名格式",trigger:"blur"}],protocol:[{required:!0,message:"请选择协议",trigger:"change"}],is_active:[{required:!0,message:"请选择状态",trigger:"change"}]},g=async()=>{U.value=!0;try{const n={page:d.page,size:d.size,...m},a=await be(n);T.value=a.data,d.total=a.data.length}catch(n){console.error("加载域名配置失败:",n),V.error("加载域名配置失败")}finally{U.value=!1}},z=()=>{d.page=1,g()},H=()=>{Object.assign(m,{name:"",domain:"",is_active:null}),z()},L=n=>{d.size=n,d.page=1,g()},I=n=>{d.page=n,g()},Q=n=>{O.value=n},W=()=>{S.value="新增域名配置",Y(),y.value=!0},G=n=>{S.value="编辑域名配置",Object.assign(o,{id:n.id,name:n.name,domain:n.domain,protocol:n.protocol,is_active:n.is_active,is_wildcard:n.is_wildcard||0,sort_order:n.sort_order,description:n.description||""}),y.value=!0},J=async n=>{try{await ve.confirm(`确定要删除域名配置"${n.name}"吗？`,"确认删除",{type:"warning"}),await we(n.id),V.success("删除成功"),g()}catch(a){a!=="cancel"&&(console.error("删除域名配置失败:",a),V.error("删除失败"))}},X=async()=>{if(A.value)try{if(await A.value.validate(),D.value=!0,o.id){const n={id:o.id,name:o.name,domain:o.domain,protocol:o.protocol,is_active:o.is_active,is_wildcard:o.is_wildcard,sort_order:o.sort_order,description:o.description};await ye(n),V.success("更新成功")}else{const n={name:o.name,domain:o.domain,protocol:o.protocol,is_active:o.is_active,is_wildcard:o.is_wildcard,sort_order:o.sort_order,description:o.description};await Ve(n),V.success("创建成功")}y.value=!1,g()}catch(n){console.error("提交失败:",n),V.error("操作失败")}finally{D.value=!1}},Y=()=>{Object.assign(o,{id:null,name:"",domain:"",protocol:"https",is_active:1,is_wildcard:0,sort_order:0,description:""})};return de(()=>{g()}),(n,a)=>{const p=s("el-icon"),h=s("el-input"),r=s("el-form-item"),x=s("el-option"),$=s("el-select"),f=s("el-button"),q=s("el-form"),B=s("el-card"),k=s("el-tag"),c=s("el-table-column"),ee=s("el-table"),le=s("el-pagination"),v=s("el-col"),C=s("el-row"),E=s("el-radio"),ae=s("el-radio-group"),te=s("el-input-number"),oe=s("el-checkbox"),ne=s("el-dialog"),se=re("loading");return j(),ue("div",Ce,[e(B,{class:"search-card",shadow:"never"},{default:l(()=>[e(q,{model:m,inline:"",class:"search-form"},{default:l(()=>[e(r,{label:"域名名称"},{default:l(()=>[e(h,{modelValue:m.name,"onUpdate:modelValue":a[0]||(a[0]=t=>m.name=t),placeholder:"请输入域名名称",clearable:"",style:{width:"200px"},onKeyup:N(z,["enter"])},{prefix:l(()=>[e(p,null,{default:l(()=>[e(_(P))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(r,{label:"域名地址"},{default:l(()=>[e(h,{modelValue:m.domain,"onUpdate:modelValue":a[1]||(a[1]=t=>m.domain=t),placeholder:"请输入域名地址",clearable:"",style:{width:"200px"},onKeyup:N(z,["enter"])},{prefix:l(()=>[e(p,null,{default:l(()=>[e(_(R))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(r,{label:"状态"},{default:l(()=>[e($,{modelValue:m.is_active,"onUpdate:modelValue":a[2]||(a[2]=t=>m.is_active=t),placeholder:"请选择状态",clearable:"",style:{width:"120px"}},{default:l(()=>[e(x,{label:"启用",value:1}),e(x,{label:"禁用",value:0})]),_:1},8,["modelValue"])]),_:1}),e(r,null,{default:l(()=>[e(f,{type:"primary",onClick:z},{default:l(()=>[e(p,null,{default:l(()=>[e(_(P))]),_:1}),a[14]||(a[14]=i(" 搜索 ",-1))]),_:1}),e(f,{onClick:H},{default:l(()=>[e(p,null,{default:l(()=>[e(_(K))]),_:1}),a[15]||(a[15]=i(" 重置 ",-1))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(B,{class:"table-card",shadow:"never"},{header:l(()=>[u("div",ze,[u("div",xe,[a[16]||(a[16]=u("span",null,"域名配置列表",-1)),e(k,{type:"info",size:"small"},{default:l(()=>[i(w(d.total)+" 条记录",1)]),_:1})]),u("div",ke,[e(f,{type:"primary",onClick:W},{default:l(()=>[e(p,null,{default:l(()=>[e(_(ge))]),_:1}),a[17]||(a[17]=i(" 新增域名 ",-1))]),_:1}),e(f,{size:"small",onClick:g},{default:l(()=>[e(p,null,{default:l(()=>[e(_(K))]),_:1}),a[18]||(a[18]=i(" 刷新 ",-1))]),_:1})])])]),default:l(()=>[pe((j(),ce(ee,{data:T.value,stripe:"",border:"",style:{width:"100%"},onSelectionChange:Q},{default:l(()=>[e(c,{type:"selection",width:"55",align:"center"}),e(c,{prop:"name",label:"域名名称",width:"150","show-overflow-tooltip":""}),e(c,{prop:"domain",label:"域名地址",width:"200","show-overflow-tooltip":""},{default:l(({row:t})=>[u("div",Ue,[e(p,null,{default:l(()=>[e(_(R))]),_:1}),u("span",null,w(t.protocol)+"://"+w(t.domain),1)])]),_:1}),e(c,{prop:"protocol",label:"协议",width:"80",align:"center"},{default:l(({row:t})=>[e(k,{type:t.protocol==="https"?"success":"warning",size:"small"},{default:l(()=>[i(w(t.protocol.toUpperCase()),1)]),_:2},1032,["type"])]),_:1}),e(c,{prop:"is_active",label:"状态",width:"100",align:"center"},{default:l(({row:t})=>[e(k,{type:t.is_active?"success":"info",size:"small",effect:"light"},{default:l(()=>[i(w(t.is_active?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),e(c,{prop:"is_wildcard",label:"通配符域名",width:"120",align:"center"},{default:l(({row:t})=>[e(k,{type:t.is_wildcard?"warning":"info",size:"small",effect:"light"},{default:l(()=>[i(w(t.is_wildcard?"是":"否"),1)]),_:2},1032,["type"])]),_:1}),e(c,{prop:"sort_order",label:"排序",width:"80",align:"center"}),e(c,{prop:"description",label:"描述","min-width":"200","show-overflow-tooltip":""}),e(c,{prop:"created_at",label:"创建时间",width:"180","show-overflow-tooltip":""},{default:l(({row:t})=>[u("div",De,[e(p,{class:"time-icon"},{default:l(()=>[e(_(_e))]),_:1}),u("span",null,w(t.created_at),1)])]),_:1}),e(c,{label:"操作",width:"200",align:"center",fixed:"right"},{default:l(({row:t})=>[u("div",Se,[e(f,{size:"small",type:"primary",link:"",onClick:ie=>G(t)},{default:l(()=>[e(p,null,{default:l(()=>[e(_(me))]),_:1}),a[19]||(a[19]=i(" 编辑 ",-1))]),_:1},8,["onClick"]),e(f,{size:"small",type:"danger",link:"",onClick:ie=>J(t)},{default:l(()=>[e(p,null,{default:l(()=>[e(_(fe))]),_:1}),a[20]||(a[20]=i(" 删除 ",-1))]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["data"])),[[se,U.value]]),u("div",Ae,[e(le,{"current-page":d.page,"onUpdate:currentPage":a[3]||(a[3]=t=>d.page=t),"page-size":d.size,"onUpdate:pageSize":a[4]||(a[4]=t=>d.size=t),"page-sizes":[10,20,50,100],total:d.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:L,onCurrentChange:I},null,8,["current-page","page-size","total"])])]),_:1}),e(ne,{modelValue:y.value,"onUpdate:modelValue":a[13]||(a[13]=t=>y.value=t),title:S.value,width:"600px","close-on-click-modal":!1,"destroy-on-close":""},{footer:l(()=>[u("div",Ze,[e(f,{onClick:a[12]||(a[12]=t=>y.value=!1)},{default:l(()=>[...a[24]||(a[24]=[i("取消",-1)])]),_:1}),e(f,{type:"primary",onClick:X,loading:D.value},{default:l(()=>[...a[25]||(a[25]=[i(" 确定 ",-1)])]),_:1},8,["loading"])])]),default:l(()=>[e(q,{model:o,rules:F,ref_key:"formRef",ref:A,"label-width":"100px"},{default:l(()=>[e(C,{gutter:20},{default:l(()=>[e(v,{span:12},{default:l(()=>[e(r,{label:"域名名称",prop:"name"},{default:l(()=>[e(h,{modelValue:o.name,"onUpdate:modelValue":a[5]||(a[5]=t=>o.name=t),placeholder:"请输入域名名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(v,{span:12},{default:l(()=>[e(r,{label:"协议",prop:"protocol"},{default:l(()=>[e($,{modelValue:o.protocol,"onUpdate:modelValue":a[6]||(a[6]=t=>o.protocol=t),placeholder:"请选择协议",style:{width:"100%"}},{default:l(()=>[e(x,{label:"HTTPS",value:"https"}),e(x,{label:"HTTP",value:"http"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(C,{gutter:20},{default:l(()=>[e(v,{span:24},{default:l(()=>[e(r,{label:"域名地址",prop:"domain"},{default:l(()=>[e(h,{modelValue:o.domain,"onUpdate:modelValue":a[7]||(a[7]=t=>o.domain=t),placeholder:"请输入域名地址，如：example.com"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(C,{gutter:20},{default:l(()=>[e(v,{span:12},{default:l(()=>[e(r,{label:"状态",prop:"is_active"},{default:l(()=>[e(ae,{modelValue:o.is_active,"onUpdate:modelValue":a[8]||(a[8]=t=>o.is_active=t)},{default:l(()=>[e(E,{value:1},{default:l(()=>[...a[21]||(a[21]=[i("启用",-1)])]),_:1}),e(E,{value:0},{default:l(()=>[...a[22]||(a[22]=[i("禁用",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(v,{span:12},{default:l(()=>[e(r,{label:"排序",prop:"sort_order"},{default:l(()=>[e(te,{modelValue:o.sort_order,"onUpdate:modelValue":a[9]||(a[9]=t=>o.sort_order=t),min:0,max:999,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(C,{gutter:20},{default:l(()=>[e(v,{span:24},{default:l(()=>[e(r,{label:"通配符域名",prop:"is_wildcard"},{default:l(()=>[e(oe,{modelValue:o.is_wildcard,"onUpdate:modelValue":a[10]||(a[10]=t=>o.is_wildcard=t),"true-value":1,"false-value":0},{default:l(()=>[...a[23]||(a[23]=[i(" 是否为通配符域名（查看时根据国家代码自动添加前缀，如：sk.goworldhub.shop） ",-1)])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(C,{gutter:20},{default:l(()=>[e(v,{span:24},{default:l(()=>[e(r,{label:"描述",prop:"description"},{default:l(()=>[e(h,{modelValue:o.description,"onUpdate:modelValue":a[11]||(a[11]=t=>o.description=t),type:"textarea",rows:3,placeholder:"请输入域名描述（可选）"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),Ne=he($e,[["__scopeId","data-v-9634e38d"]]);export{Ne as default};
