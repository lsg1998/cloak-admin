import{a5 as w,d as Qe,h as v,P as oe,Z as We,r as p,Q as qe,c as r,o as i,b as t,w as a,_ as He,g as x,q as ye,u as z,aE as Je,x as ge,e as u,aS as Ze,a as l,t as n,aO as Xe,aI as Ye,bh as et,bi as tt,W as ie,E as be,F as he,f as ke,n as st,R as P,av as at,aG as lt,N as y,a0 as ot}from"./index-Dq1mQvu6.js";import{g as it}from"./product-BDsA6g7Y.js";import{_ as nt}from"./_plugin-vue_export-helper-DlAUqK2U.js";const O={getVisitorIps:g=>w.get("/admin/statistics/visitor-ips",g),getVisitorIp:g=>w.get(`/admin/statistics/visitor-ips/${g}`),getIpStatistics:()=>w.get("/admin/statistics/visitor-ips-stats"),deleteVisitorIp:g=>w.delete(`/admin/statistics/visitor-ips/${g}`),syncBehaviorData:()=>w.post("/admin/statistics/sync-behavior-data")},ze={getSummary:g=>w.get("/admin/user-behavior/summary",g),getTimeline:g=>w.get("/admin/user-behavior/timeline",g),fetchFromRedis:g=>w.get("/admin/user-behavior/fetch-from-redis",{ip:g})},rt={class:"visitor-ip-list"},dt={class:"stat-content"},ct={class:"stat-value"},ut={class:"stat-icon"},pt={class:"stat-content"},_t={class:"stat-value"},ft={class:"stat-icon"},vt={class:"stat-content"},mt={class:"stat-value"},yt={class:"stat-icon"},gt={class:"stat-content"},bt={class:"stat-value"},ht={class:"stat-icon"},kt={class:"table-header"},zt={class:"table-actions"},Ct={class:"ip-list"},xt={class:"ip-header"},It={class:"ip-address"},Vt={class:"ip-actions"},St={class:"ip-content"},wt={class:"ip-section"},Pt={class:"address-info"},Tt={class:"address-line"},Lt={class:"value"},Bt={class:"address-line"},Dt={class:"value"},At={class:"address-line"},Mt=["title"],Rt={class:"address-line"},Ut=["title"],Nt={class:"ip-section"},Ft={class:"organization-info"},$t={class:"org-name"},Et={class:"org-tags"},Ot={class:"ip-section"},Kt={class:"basic-type"},jt={class:"type-line"},Gt={class:"type-line"},Qt={class:"value"},Wt={class:"type-line"},qt={class:"value"},Ht={class:"type-line"},Jt={key:1,class:"value"},Zt={class:"type-line"},Xt={key:1,class:"value"},Yt={class:"ip-section"},es={class:"behavior-info"},ts={class:"behavior-summary"},ss={key:0,class:"duration-text"},as={key:1,class:"no-data-text"},ls={class:"behavior-actions"},os={key:0,class:"ip-section"},is={class:"detailed-type"},ns={class:"type-line"},rs={class:"type-line"},ds={class:"value"},cs={class:"type-line"},us={class:"value"},ps={class:"pagination-wrapper"},_s={class:"product-select-dialog"},fs={key:0,class:"ip-detail"},vs={key:0},ms={key:1,class:"text-gray-400"},ys={key:0},gs={key:1,class:"text-gray-400"},bs={key:0},hs={key:1,class:"text-gray-400"},ks={key:0},zs={key:1,class:"text-gray-400"},Cs={key:0},xs={key:1,class:"text-gray-400"},Is={key:0},Vs={key:1,class:"text-gray-400"},Ss={key:0},ws={key:1,class:"text-gray-400"},Ps={key:0},Ts={key:1,class:"text-gray-400"},Ls={key:0,class:"referer-info"},Bs={key:1,class:"text-gray-400"},Ds={key:0,class:"referer-info"},As={key:1,class:"text-gray-400"},Ms={key:1,class:"text-gray-400"},Rs={key:0,class:"location-info"},Us={class:"timeline-container"},Ns={key:0,class:"timeline-content"},Fs={class:"timeline-header"},$s={class:"timeline-list"},Es={class:"timeline-item-content"},Os={class:"action-description"},Ks={class:"action-text"},js={key:0,class:"action-detail"},Gs=Qe({__name:"index",setup(g){const K=v(!1),j=v(!1),G=v(!1),d=v(null),Q=v(!1),W=v(!1),C=v(null),b=oe({ip:"",timeRange:"",visitorType:"",productId:""}),M=v(!1),q=v(!1),H=v([]),R=v([]),U=v(""),L=v(""),V=oe({page:1,size:20,total:0}),h=oe({page:1,size:20,total:0}),J=v([]),B=v({totalIps:0,todayIps:0,totalCountries:0,totalCities:0,countryStats:[],cityStats:[]}),Z=s=>s?new Date(s).toLocaleString("zh-CN"):"--",Ce=s=>{const e=[];return s.country&&e.push(s.country),s.region&&e.push(s.region),s.city&&e.push(s.city),e.length>0?e.join(" - "):null},N=s=>{const e=["proxy","vpn","tor","anonymizer"],c=(s.organization||"").toLowerCase();return e.some(f=>c.includes(f))},xe=s=>{const e=["amazon","google","microsoft","cloudflare","digitalocean","linode","vultr","aws","gcp","azure"],c=(s.organization||"").toLowerCase();return e.some(f=>c.includes(f))},ne=s=>D(s)?"爬虫":N(s)?"代理":"访客",re=s=>D(s)?"primary":N(s)?"warning":"success",X=s=>{const e=["google","facebook","twitter","linkedin","microsoft","bytedance","tiktok"],c=(s.organization||"").toLowerCase(),f=(s.user_agent||"").trim(),k=e.some(m=>c.includes(m)),F=!f||f.length<20;return k&&F},D=s=>{if(X(s))return!0;const e=["bot","crawler","spider","scraper","crawl","googlebot","bingbot","slurp","duckduckbot","facebook","facebookexternalhit","facebot","twitter","twitterbot","linkedin","linkedinbot","whatsapp","telegrambot","bytedance","bytespider","semrush","ahrefs","mj12bot","petalbot","yandex","baidu"],c=(s.user_agent||"").toLowerCase(),f=(s.organization||"").toLowerCase();return e.some(k=>c.includes(k)||f.includes(k))},Ie=s=>{const e=s.user_agent||"";return e.includes("Mobile")?"Mobile":e.includes("Tablet")?"Tablet":e.includes("Desktop")?"Desktop":null},Ve=s=>{const e=s.user_agent||"";return e.includes("Android")?"Android":e.includes("iOS")||e.includes("iPhone")||e.includes("iPad")?"iOS":e.includes("Windows")?"Windows":e.includes("Mac")?"macOS":e.includes("Linux")?"Linux":null},Se=s=>{const e=(s.user_agent||"").toLowerCase(),c=(s.organization||"").toLowerCase();return X(s)?c.includes("google")?"Google 审核爬虫":c.includes("facebook")?"Facebook 审核爬虫":c.includes("twitter")?"Twitter 审核爬虫":c.includes("linkedin")?"LinkedIn 审核爬虫":c.includes("microsoft")?"Microsoft 审核爬虫":c.includes("bytedance")||c.includes("tiktok")?"TikTok 审核爬虫":"审核爬虫":e.includes("googlebot")||c.includes("google")&&e.includes("bot")?"Googlebot":e.includes("bingbot")||c.includes("microsoft")&&e.includes("bot")?"BingBot":e.includes("facebook")?"Facebook Crawler":e.includes("twitter")?"Twitter Bot":e.includes("ahrefs")||c.includes("ahrefs")?"aHrefs Bot":e.includes("httpx")?"httpx":e.includes("barkrowler")?"Barkrowler":D(s)?"通用爬虫":null},we=s=>{const e=(s.user_agent||"").toLowerCase(),c=(s.organization||"").toLowerCase();return X(s)?"广告/内容合规审核（无UA或异常UA）":e.includes("googlebot")||c.includes("google")&&e.includes("bot")||e.includes("bingbot")||c.includes("microsoft")&&e.includes("bot")?"搜索引擎蜘蛛":e.includes("facebook")||e.includes("twitter")?"社交媒体爬虫":e.includes("ahrefs")||c.includes("ahrefs")?"SEO分析爬虫":D(s)?"通用网络爬虫":null},de=s=>({A:"primary",B:"success",C:"warning",D:"danger",E:"info"})[s]||"info",ce=s=>({A:"A页",B:"B页",C:"C页",D:"D页",E:"E页"})[s]||s,A=async()=>{try{K.value=!0;const s={page:h.page,size:h.size,...b},e=await O.getVisitorIps(s);e.code===200&&(J.value=e.data.list,h.total=e.data.total)}catch(s){console.error("获取访客IP列表失败:",s),y.error("获取访客IP列表失败")}finally{K.value=!1}},Y=async()=>{try{const s=await O.getIpStatistics();s.code===200&&(B.value=s.data)}catch(s){console.error("获取统计数据失败:",s),y.error("获取统计数据失败")}},ee=()=>{h.page=1,A()},Pe=()=>{Object.assign(b,{ip:"",timeRange:"",visitorType:"",productId:""}),L.value="",ee()},te=async()=>{try{q.value=!0;const{data:s}=await it({page:V.page,size:V.size});H.value=s.list||[],R.value=s.list||[],V.total=s.total||0}catch{y.error("加载商品列表失败")}finally{q.value=!1}},Te=()=>{if(!U.value){R.value=H.value;return}const s=U.value.toLowerCase();R.value=H.value.filter(e=>{var c,f;return((c=e.title)==null?void 0:c.toLowerCase().includes(s))||((f=e.spu_id)==null?void 0:f.toLowerCase().includes(s))})},ue=s=>{b.productId=s.spu_id,L.value=s.title,M.value=!1,y.success(`已选择商品: ${s.title}`)},Le=()=>{b.productId="",L.value=""},Be=async()=>{try{await ot.confirm("确定要同步Redis中的用户行为数据到MySQL吗？","同步确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),j.value=!0;const{data:s}=await O.syncBehaviorData();s.successCount>0?(y.success(`同步完成！成功: ${s.successCount} 条，失败: ${s.failCount} 条`),await Promise.all([A(),Y()])):y.info("没有数据需要同步")}catch(s){s!=="cancel"&&y.error(s.message||"同步失败")}finally{j.value=!1}},De=s=>{h.size=s,h.page=1,A()},Ae=s=>{h.page=s,A()},Me=async s=>{try{const e=await O.getVisitorIp(s.ip_address);e.code===200&&(d.value=e.data,G.value=!0)}catch(e){console.error("获取IP详情失败:",e),y.error("获取IP详情失败")}},Re=async s=>{try{const e=await ze.fetchFromRedis(s.ip_address);e.code===200&&(e.data?(s.behaviorSummary=e.data,y.success("获取成功（来自Redis）")):y.info("Redis中暂无该IP的轨迹数据"))}catch(e){console.error("从Redis获取数据失败:",e),y.error("获取失败")}},Ue=async s=>{try{if(!s.behaviorSummary){y.warning("该IP暂无行为轨迹数据");return}W.value=!0,Q.value=!0,C.value=null;const e={sessionId:s.behaviorSummary.sessionId,ip:s.ip_address,productId:s.behaviorSummary.productId,date:s.behaviorSummary.visitDate.replace(/-/g,"")},c=await ze.getTimeline(e);c.code===200&&(C.value=c.data)}catch(e){console.error("获取用户行为轨迹失败:",e),y.error("获取用户行为轨迹失败")}finally{W.value=!1}},Ne=s=>({enter:"success",leave:"info",scroll:"primary",click_sku:"warning",select_province:"warning",select_city:"warning",fill_name:"warning",fill_phone:"warning",submit_order:"danger",order_success:"success",order_fail:"danger"})[s]||"info",Fe=s=>({enter:"success",leave:"info",scroll:"",click_sku:"warning",select_province:"primary",select_city:"primary",fill_name:"warning",fill_phone:"warning",submit_order:"danger",order_success:"success",order_fail:"danger"})[s]||"info";return We(()=>{A(),Y(),te()}),(s,e)=>{const c=p("el-input"),f=p("el-form-item"),k=p("el-option"),F=p("el-select"),m=p("el-icon"),S=p("el-button"),$e=p("el-form"),T=p("el-card"),$=p("el-col"),Ee=p("el-row"),I=p("el-tag"),pe=p("el-pagination"),se=p("el-table-column"),Oe=p("el-table"),ae=p("el-dialog"),_=p("el-descriptions-item"),_e=p("el-link"),fe=p("el-descriptions"),E=p("el-text"),Ke=p("el-timeline-item"),je=p("el-timeline"),Ge=p("el-empty"),le=qe("loading");return i(),r("div",rt,[t(T,{class:"search-card",shadow:"never"},{default:a(()=>[t($e,{model:b,inline:!0,class:"search-form"},{default:a(()=>[t(f,{label:"IP地址"},{default:a(()=>[t(c,{modelValue:b.ip,"onUpdate:modelValue":e[0]||(e[0]=o=>b.ip=o),placeholder:"请输入IP地址",clearable:"",style:{width:"200px"},onKeyup:He(ee,["enter"])},null,8,["modelValue"])]),_:1}),t(f,{label:"时间筛选"},{default:a(()=>[t(F,{modelValue:b.timeRange,"onUpdate:modelValue":e[1]||(e[1]=o=>b.timeRange=o),placeholder:"请选择时间范围",clearable:"",style:{width:"150px"}},{default:a(()=>[t(k,{label:"当天",value:"today"}),t(k,{label:"昨天",value:"yesterday"}),t(k,{label:"本周",value:"week"}),t(k,{label:"本月",value:"month"})]),_:1},8,["modelValue"])]),_:1}),t(f,{label:"访客类型"},{default:a(()=>[t(F,{modelValue:b.visitorType,"onUpdate:modelValue":e[2]||(e[2]=o=>b.visitorType=o),placeholder:"请选择类型",clearable:"",style:{width:"150px"}},{default:a(()=>[t(k,{label:"访客",value:"visitor"}),t(k,{label:"爬虫",value:"bot"}),t(k,{label:"代理",value:"proxy"})]),_:1},8,["modelValue"])]),_:1}),t(f,{label:"商品筛选"},{default:a(()=>[t(c,{modelValue:L.value,"onUpdate:modelValue":e[3]||(e[3]=o=>L.value=o),placeholder:"点击选择商品",readonly:"",style:{width:"200px"},onClick:e[4]||(e[4]=o=>M.value=!0)},{suffix:a(()=>[b.productId?(i(),x(m,{key:0,onClick:ye(Le,["stop"]),style:{cursor:"pointer"}},{default:a(()=>[t(z(Je))]),_:1})):(i(),x(m,{key:1},{default:a(()=>[t(z(ge))]),_:1}))]),_:1},8,["modelValue"])]),_:1}),t(f,null,{default:a(()=>[t(S,{type:"primary",onClick:ee},{default:a(()=>[...e[13]||(e[13]=[u("搜索",-1)])]),_:1}),t(S,{onClick:Pe},{default:a(()=>[...e[14]||(e[14]=[u("重置",-1)])]),_:1}),t(S,{type:"success",onClick:Be,loading:j.value},{default:a(()=>[t(m,null,{default:a(()=>[t(z(Ze))]),_:1}),e[15]||(e[15]=u(" 一键同步轨迹 ",-1))]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1}),t(Ee,{gutter:20,class:"statistics-cards"},{default:a(()=>[t($,{span:6},{default:a(()=>[t(T,{class:"stat-card"},{default:a(()=>[l("div",dt,[l("div",ct,n(B.value.totalIps),1),e[16]||(e[16]=l("div",{class:"stat-label"},"总IP数",-1))]),l("div",ut,[t(m,null,{default:a(()=>[t(z(Xe))]),_:1})])]),_:1})]),_:1}),t($,{span:6},{default:a(()=>[t(T,{class:"stat-card"},{default:a(()=>[l("div",pt,[l("div",_t,n(B.value.todayIps),1),e[17]||(e[17]=l("div",{class:"stat-label"},"今日新增",-1))]),l("div",ft,[t(m,null,{default:a(()=>[t(z(Ye))]),_:1})])]),_:1})]),_:1}),t($,{span:6},{default:a(()=>[t(T,{class:"stat-card"},{default:a(()=>[l("div",vt,[l("div",mt,n(B.value.totalCountries),1),e[18]||(e[18]=l("div",{class:"stat-label"},"涉及国家",-1))]),l("div",yt,[t(m,null,{default:a(()=>[t(z(et))]),_:1})])]),_:1})]),_:1}),t($,{span:6},{default:a(()=>[t(T,{class:"stat-card"},{default:a(()=>[l("div",gt,[l("div",bt,n(B.value.totalCities),1),e[19]||(e[19]=l("div",{class:"stat-label"},"涉及城市",-1))]),l("div",ht,[t(m,null,{default:a(()=>[t(z(tt))]),_:1})])]),_:1})]),_:1})]),_:1}),t(T,{class:"table-card",shadow:"never"},{default:a(()=>[l("div",kt,[e[21]||(e[21]=l("div",{class:"table-title"},"访客IP列表",-1)),l("div",zt,[t(S,{onClick:Y},{default:a(()=>[t(m,null,{default:a(()=>[t(z(be))]),_:1}),e[20]||(e[20]=u(" 刷新统计 ",-1))]),_:1})])]),ie((i(),r("div",Ct,[(i(!0),r(he,null,ke(J.value,(o,ve)=>(i(),r("div",{key:o.id,class:st(["ip-item",{"last-item":ve===J.value.length-1}])},[l("div",xt,[l("div",It,n(o.ip_address),1),l("div",Vt,[t(S,{type:"primary",size:"small",onClick:me=>Me(o)},{default:a(()=>[...e[22]||(e[22]=[u("查看",-1)])]),_:1},8,["onClick"])])]),l("div",St,[l("div",wt,[e[27]||(e[27]=l("div",{class:"section-title"},"地址信息",-1)),l("div",Pt,[l("div",Tt,[e[23]||(e[23]=l("span",{class:"label"},"地址:",-1)),l("span",Lt,n(Ce(o)||"-"),1)]),l("div",Bt,[e[24]||(e[24]=l("span",{class:"label"},"时间:",-1)),l("span",Dt,n(Z(o.last_visit)),1)]),l("div",At,[e[25]||(e[25]=l("span",{class:"label"},"访问页面:",-1)),l("span",{class:"value referer",title:o.access_address||"-"},n(o.access_address||"-"),9,Mt)]),l("div",Rt,[e[26]||(e[26]=l("span",{class:"label"},"来源:",-1)),l("span",{class:"value referer",title:o.referer||"-"},n(o.referer||"-"),9,Ut)])])]),l("div",Nt,[e[30]||(e[30]=l("div",{class:"section-title"},"组织信息",-1)),l("div",Ft,[l("div",$t,n(o.organization||"-"),1),l("div",Et,[N(o)?(i(),x(I,{key:0,size:"small",type:"info"},{default:a(()=>[...e[28]||(e[28]=[u("代理",-1)])]),_:1})):P("",!0),xe(o)?(i(),x(I,{key:1,size:"small",type:"warning"},{default:a(()=>[...e[29]||(e[29]=[u("机房",-1)])]),_:1})):P("",!0)])])]),l("div",Ot,[e[36]||(e[36]=l("div",{class:"section-title"},"基础类型",-1)),l("div",Kt,[l("div",jt,[e[31]||(e[31]=l("span",{class:"label"},"类型:",-1)),t(I,{type:re(o),size:"small"},{default:a(()=>[u(n(ne(o)),1)]),_:2},1032,["type"])]),l("div",Gt,[e[32]||(e[32]=l("span",{class:"label"},"设备:",-1)),l("span",Qt,n(Ie(o)||"-"),1)]),l("div",Wt,[e[33]||(e[33]=l("span",{class:"label"},"系统:",-1)),l("span",qt,n(Ve(o)||"-"),1)]),l("div",Ht,[e[34]||(e[34]=l("span",{class:"label"},"商品:",-1)),o.product_id?(i(),x(I,{key:0,size:"small",type:"success"},{default:a(()=>[u(n(o.product_id),1)]),_:2},1024)):(i(),r("span",Jt,"-"))]),l("div",Zt,[e[35]||(e[35]=l("span",{class:"label"},"产品类型:",-1)),o.product_type?(i(),x(I,{key:0,size:"small",type:de(o.product_type)},{default:a(()=>[u(n(ce(o.product_type)),1)]),_:2},1032,["type"])):(i(),r("span",Xt,"-"))])])]),l("div",Yt,[e[39]||(e[39]=l("div",{class:"section-title"},"用户轨迹",-1)),l("div",es,[l("div",ts,[t(m,null,{default:a(()=>[t(z(at))]),_:1}),o.behaviorSummary?(i(),r("span",ss," 停留 "+n(o.behaviorSummary.durationText||"0秒"),1)):(i(),r("span",as,"暂无轨迹数据"))]),l("div",ls,[o.behaviorSummary?P("",!0):(i(),x(S,{key:0,type:"warning",size:"small",onClick:me=>Re(o)},{default:a(()=>[t(m,null,{default:a(()=>[t(z(be))]),_:1}),e[37]||(e[37]=u(" 获取 ",-1))]),_:1},8,["onClick"])),t(S,{type:"primary",size:"small",disabled:!o.behaviorSummary,onClick:me=>Ue(o)},{default:a(()=>[t(m,null,{default:a(()=>[t(z(lt))]),_:1}),e[38]||(e[38]=u(" 查看详情 ",-1))]),_:1},8,["disabled","onClick"])])])]),D(o)||N(o)?(i(),r("div",os,[e[43]||(e[43]=l("div",{class:"section-title"},"详细类型",-1)),l("div",is,[l("div",ns,[e[40]||(e[40]=l("span",{class:"label"},"类型:",-1)),t(I,{type:re(o),size:"small"},{default:a(()=>[u(n(ne(o)),1)]),_:2},1032,["type"])]),l("div",rs,[e[41]||(e[41]=l("span",{class:"label"},"名称:",-1)),l("span",ds,n(Se(o)||"-"),1)]),l("div",cs,[e[42]||(e[42]=l("span",{class:"label"},"说明:",-1)),l("span",us,n(we(o)||"-"),1)])])])):P("",!0)])],2))),128))])),[[le,K.value]]),l("div",ps,[t(pe,{"current-page":h.page,"onUpdate:currentPage":e[5]||(e[5]=o=>h.page=o),"page-size":h.size,"onUpdate:pageSize":e[6]||(e[6]=o=>h.size=o),total:h.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:De,onCurrentChange:Ae},null,8,["current-page","page-size","total"])])]),_:1}),t(ae,{modelValue:M.value,"onUpdate:modelValue":e[10]||(e[10]=o=>M.value=o),title:"选择商品",width:"800px","close-on-click-modal":!1},{default:a(()=>[l("div",_s,[t(c,{modelValue:U.value,"onUpdate:modelValue":e[7]||(e[7]=o=>U.value=o),placeholder:"搜索商品标题或ID",clearable:"",style:{"margin-bottom":"20px"},onInput:Te},{prefix:a(()=>[t(m,null,{default:a(()=>[t(z(ge))]),_:1})]),_:1},8,["modelValue"]),ie((i(),x(Oe,{data:R.value,height:"400","highlight-current-row":"",onRowClick:ue},{default:a(()=>[t(se,{prop:"spu_id",label:"商品ID",width:"180"}),t(se,{prop:"title",label:"商品标题","show-overflow-tooltip":""}),t(se,{label:"操作",width:"100",align:"center"},{default:a(o=>[t(S,{type:"primary",size:"small",onClick:ye(ve=>ue(o.row),["stop"])},{default:a(()=>[...e[44]||(e[44]=[u("选择",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[le,q.value]]),t(pe,{"current-page":V.page,"onUpdate:currentPage":e[8]||(e[8]=o=>V.page=o),"page-size":V.size,"onUpdate:pageSize":e[9]||(e[9]=o=>V.size=o),total:V.total,"page-sizes":[10,20,50],layout:"total, sizes, prev, pager, next",style:{"margin-top":"20px"},onSizeChange:te,onCurrentChange:te},null,8,["current-page","page-size","total"])])]),_:1},8,["modelValue"]),t(ae,{modelValue:G.value,"onUpdate:modelValue":e[11]||(e[11]=o=>G.value=o),title:"IP详情",width:"600px","close-on-click-modal":!1},{default:a(()=>[d.value?(i(),r("div",fs,[t(fe,{column:2,border:""},{default:a(()=>[t(_,{label:"IP地址"},{default:a(()=>[u(n(d.value.ip_address),1)]),_:1}),t(_,{label:"国家"},{default:a(()=>[d.value.country?(i(),r("span",vs,n(d.value.country),1)):(i(),r("span",ms,"--"))]),_:1}),t(_,{label:"国家代码"},{default:a(()=>[d.value.country?(i(),r("span",ys,n(d.value.country),1)):(i(),r("span",gs,"--"))]),_:1}),t(_,{label:"地区"},{default:a(()=>[d.value.region?(i(),r("span",bs,n(d.value.region),1)):(i(),r("span",hs,"--"))]),_:1}),t(_,{label:"城市"},{default:a(()=>[d.value.city?(i(),r("span",ks,n(d.value.city),1)):(i(),r("span",zs,"--"))]),_:1}),t(_,{label:"时区"},{default:a(()=>[d.value.timezone?(i(),r("span",Cs,n(d.value.timezone),1)):(i(),r("span",xs,"--"))]),_:1}),t(_,{label:"ISP"},{default:a(()=>[d.value.organization?(i(),r("span",Is,n(d.value.organization),1)):(i(),r("span",Vs,"--"))]),_:1}),t(_,{label:"主机名"},{default:a(()=>[d.value.hostname?(i(),r("span",Ss,n(d.value.hostname),1)):(i(),r("span",ws,"--"))]),_:1}),t(_,{label:"邮编"},{default:a(()=>[d.value.postal_code?(i(),r("span",Ps,n(d.value.postal_code),1)):(i(),r("span",Ts,"--"))]),_:1}),t(_,{label:"访问页面",span:2},{default:a(()=>[d.value.access_address?(i(),r("div",Ls,[t(_e,{href:d.value.access_address,target:"_blank",type:"primary",size:"small"},{default:a(()=>[u(n(d.value.access_address),1)]),_:1},8,["href"])])):(i(),r("span",Bs,"--"))]),_:1}),t(_,{label:"来源页面",span:2},{default:a(()=>[d.value.referer?(i(),r("div",Ds,[t(_e,{href:d.value.referer,target:"_blank",type:"primary",size:"small"},{default:a(()=>[u(n(d.value.referer),1)]),_:1},8,["href"])])):(i(),r("span",As,"--"))]),_:1}),t(_,{label:"产品类型"},{default:a(()=>[d.value.product_type?(i(),x(I,{key:0,type:de(d.value.product_type),size:"small"},{default:a(()=>[u(n(ce(d.value.product_type)),1)]),_:1},8,["type"])):(i(),r("span",Ms,"--"))]),_:1}),t(_,{label:"访问次数"},{default:a(()=>[t(I,{type:"info"},{default:a(()=>[u(n(d.value.visit_count),1)]),_:1})]),_:1}),t(_,{label:"首次访问"},{default:a(()=>[u(n(Z(d.value.first_visit)),1)]),_:1}),t(_,{label:"最后访问"},{default:a(()=>[u(n(Z(d.value.last_visit)),1)]),_:1})]),_:1}),d.value.location?(i(),r("div",Rs,[e[45]||(e[45]=l("h4",null,"地理位置",-1)),l("p",null,"坐标: "+n(d.value.location),1)])):P("",!0)])):P("",!0)]),_:1},8,["modelValue"]),t(ae,{modelValue:Q.value,"onUpdate:modelValue":e[12]||(e[12]=o=>Q.value=o),title:"用户行为轨迹",width:"800px","close-on-click-modal":!1},{default:a(()=>[ie((i(),r("div",Us,[C.value?(i(),r("div",Ns,[l("div",Fs,[t(fe,{column:2,size:"small",border:""},{default:a(()=>[t(_,{label:"Session ID"},{default:a(()=>[t(E,{size:"small",type:"info"},{default:a(()=>[u(n(C.value.sessionId),1)]),_:1})]),_:1}),t(_,{label:"数据来源"},{default:a(()=>[t(I,{type:C.value.source==="redis"?"success":"info",size:"small"},{default:a(()=>[u(n(C.value.source==="redis"?"Redis (实时)":"MySQL (历史)"),1)]),_:1},8,["type"])]),_:1}),t(_,{label:"进入时间"},{default:a(()=>[u(n(C.value.enterTime),1)]),_:1}),t(_,{label:"离开时间"},{default:a(()=>[u(n(C.value.exitTime||"未离开"),1)]),_:1}),t(_,{label:"停留时长"},{default:a(()=>[t(E,{type:"primary"},{default:a(()=>[u(n(C.value.durationText),1)]),_:1})]),_:1}),t(_,{label:"操作次数"},{default:a(()=>[t(E,{type:"warning"},{default:a(()=>[u(n(C.value.actions.length)+" 次",1)]),_:1})]),_:1})]),_:1})]),l("div",$s,[t(je,null,{default:a(()=>[(i(!0),r(he,null,ke(C.value.actions,o=>(i(),x(Ke,{key:o.sequence,timestamp:o.time,type:Ne(o.type),placement:"top"},{default:a(()=>[l("div",Es,[l("div",Os,[t(I,{type:Fe(o.type),size:"small"},{default:a(()=>[u(n(o.typeName),1)]),_:2},1032,["type"]),l("span",Ks,n(o.description),1)]),o.detail?(i(),r("div",js,[t(E,{size:"small",type:"info"},{default:a(()=>[u(" 详情: "+n(JSON.stringify(o.detail)),1)]),_:2},1024)])):P("",!0)])]),_:2},1032,["timestamp","type"]))),128))]),_:1})])])):(i(),x(Ge,{key:1,description:"暂无轨迹数据"}))])),[[le,W.value]])]),_:1},8,["modelValue"])])}}}),Hs=nt(Gs,[["__scopeId","data-v-2b3c3d79"]]);export{Hs as default};
