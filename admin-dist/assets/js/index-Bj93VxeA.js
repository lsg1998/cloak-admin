import{a5 as D,d as $e,h,P as le,Z as Ee,r as f,Q as Fe,c as r,o as i,b as l,a as t,w as s,_ as Ke,g as c,q as fe,u as C,aK as je,x as me,e as u,U as Ge,t as o,aU as We,aO as qe,bn as Qe,aN as He,bo as Je,bp as Xe,F as ae,f as ie,W as ne,E as Ye,n as Ze,bm as we,R as v,N as I}from"./index-Bvkp0_e8.js";import{g as es}from"./product-CyZQKtFG.js";import{_ as ss}from"./_plugin-vue_export-helper-DlAUqK2U.js";const U={getVisitorIps:x=>D.get("/admin/statistics/visitor-ips",x),getVisitorIp:x=>D.get("/admin/statistics/visitor-ips/detail",{ip:x}),getIpStatistics:x=>D.get("/admin/statistics/visitor-ips-stats",x),deleteVisitorIp:x=>D.delete("/admin/statistics/visitor-ips/delete",{ip:x}),syncBehaviorData:()=>D.post("/admin/statistics/sync-behavior-data"),clearAllIpCache:()=>D.post("/admin/statistics/visitor-ips/clear-cache"),refreshIpInfo:x=>D.post("/admin/statistics/visitor-ips/refresh",{ip:x})},ts={class:"visitor-ip-list"},ls={class:"statistics-title"},as={class:"stat-content"},is={class:"stat-value"},ns={class:"stat-icon"},os={class:"stat-content"},ds={class:"stat-value"},us={class:"stat-icon"},rs={class:"stat-content"},cs={class:"stat-value"},ps={class:"stat-icon"},_s={class:"stat-content"},ys={class:"stat-value"},vs={class:"stat-icon"},fs={class:"stat-content"},ms={class:"stat-value"},gs={class:"stat-icon"},bs={class:"stat-content"},ks={class:"stat-value"},zs={class:"stat-icon"},hs={class:"source-stats-list"},Cs={class:"source-name"},Is={class:"source-count"},xs={class:"count-value"},Ps={class:"table-header"},Vs={class:"table-actions"},Ts={class:"ip-list"},Ss={class:"ip-header"},As={class:"ip-address"},Ls={class:"ip-actions"},Ds={class:"ip-content"},Bs={class:"ip-section"},Ms={class:"address-info"},Ns={class:"address-line"},Us={class:"value"},Rs={class:"address-line"},Os={class:"value"},$s={class:"address-line"},Es={class:"value"},Fs={key:0,class:"address-line"},Ks={class:"value"},js={key:1,class:"address-line"},Gs={class:"value"},Ws={key:2,class:"address-line"},qs={class:"value"},Qs={key:3,class:"address-line"},Hs={class:"value"},Js={key:4,class:"address-line"},Xs={class:"value"},Ys={class:"address-line"},Zs={class:"value"},ws={class:"address-line"},et={class:"value"},st={class:"address-line"},tt={class:"ip-section"},lt={class:"organization-info"},at={class:"org-line"},it=["title"],nt={class:"org-line"},ot={class:"value"},dt={class:"org-line"},ut=["title"],rt={class:"org-line"},ct={class:"value"},pt={class:"org-line"},_t={class:"value"},yt={key:1},vt={key:0,class:"org-line"},ft=["title"],mt={class:"org-tags"},gt={class:"ip-section"},bt={class:"basic-type"},kt={class:"type-line"},zt={class:"type-line"},ht={class:"value"},Ct={class:"type-line"},It={class:"value"},xt={class:"type-line"},Pt={key:1,class:"value"},Vt={class:"type-line"},Tt={key:1,class:"value"},St={class:"type-line"},At=["title"],Lt={class:"type-line"},Dt=["title"],Bt={class:"type-line"},Mt=["title"],Nt={class:"ip-section"},Ut={class:"privacy-tags"},Rt={class:"privacy-item"},Ot={class:"privacy-item"},$t={class:"privacy-item"},Et={class:"privacy-item"},Ft={class:"privacy-item"},Kt={key:0,class:"ip-section"},jt={class:"detailed-type"},Gt={class:"type-line"},Wt={class:"type-line"},qt={class:"value"},Qt={class:"type-line"},Ht={class:"value"},Jt={class:"pagination-wrapper"},Xt={class:"product-select-dialog"},Yt={key:0,class:"ip-detail"},Zt={class:"detail-section"},wt={key:0},el={key:1,class:"text-gray-400"},sl={key:1,class:"text-gray-400"},tl={class:"detail-section"},ll={key:0},al={key:1,class:"text-gray-400"},il={key:0},nl={key:1,class:"text-gray-400"},ol={key:0},dl={key:1},ul={key:2,class:"text-gray-400"},rl={key:0},cl={key:1,class:"text-gray-400"},pl={key:0},_l={key:1,class:"text-gray-400"},yl={key:0},vl={key:1,class:"text-gray-400"},fl={key:0},ml={key:1},gl={key:2,class:"text-gray-400"},bl={class:"detail-section"},kl={key:0},zl={key:1,class:"text-gray-400"},hl={key:1,class:"text-gray-400"},Cl={key:0},Il={key:1},xl={key:2,class:"text-gray-400"},Pl={key:0},Vl={key:1,class:"text-gray-400"},Tl={key:0},Sl={key:1,class:"text-gray-400"},Al={key:0,class:"detail-section"},Ll={key:0},Dl={key:1,class:"text-gray-400"},Bl={key:1,class:"detail-section"},Ml={key:2,class:"detail-section"},Nl=["href"],Ul={key:3,class:"detail-section"},Rl={class:"detail-section"},Ol={class:"detail-section"},$l={key:0,class:"referer-info"},El={key:1,class:"text-gray-400"},Fl={key:0,class:"referer-info"},Kl={key:1,class:"text-gray-400"},jl={class:"timeline-container"},Gl={key:0,class:"timeline-content"},Wl={class:"timeline-header"},ql={class:"timeline-list"},Ql={class:"timeline-item-content"},Hl={class:"action-description"},Jl={class:"action-text"},Xl={key:0,class:"action-detail"},Yl=$e({__name:"index",setup(x){const G=h(!1),W=h(!1),q=h(!1),n=h(null),g=le({ip:"",timeRange:"today",visitorType:"",productId:""}),R=h(!1),Q=h(!1),H=h([]),O=h([]),$=h(""),B=h(""),T=le({page:1,size:20,total:0}),z=le({page:1,size:20,total:0}),J=h([]),S=h({totalIps:0,todayIps:0,totalCountries:0,totalCities:0,genuineCount:0,fakeCount:0,countryStats:[],cityStats:[],productTypeStats:[],sourceStats:[]}),E=d=>d?new Date(d).toLocaleString("zh-CN"):"--",F=d=>{const e=["proxy","vpn","tor","anonymizer"],y=(d.organization||"").toLowerCase();return e.some(m=>y.includes(m))},ge=d=>{const e=["amazon","google","microsoft","cloudflare","digitalocean","linode","vultr","aws","gcp","azure"],y=(d.organization||"").toLowerCase();return e.some(m=>y.includes(m))},oe=d=>M(d)?"爬虫":F(d)?"代理":"访客",de=d=>M(d)?"primary":F(d)?"warning":"success",X=d=>{const e=["google","facebook","twitter","linkedin","microsoft","bytedance","tiktok"],y=(d.organization||"").toLowerCase(),m=(d.user_agent||"").trim(),k=e.some(b=>y.includes(b)),K=!m||m.length<20;return k&&K},M=d=>{if(X(d))return!0;const e=["bot","crawler","spider","scraper","crawl","googlebot","bingbot","slurp","duckduckbot","facebook","facebookexternalhit","facebot","twitter","twitterbot","linkedin","linkedinbot","whatsapp","telegrambot","bytedance","bytespider","semrush","ahrefs","mj12bot","petalbot","yandex","baidu"],y=(d.user_agent||"").toLowerCase(),m=(d.organization||"").toLowerCase();return e.some(k=>y.includes(k)||m.includes(k))},be=d=>{const e=d.user_agent||"";return e.includes("Mobile")?"Mobile":e.includes("Tablet")?"Tablet":e.includes("Desktop")?"Desktop":null},ke=d=>{const e=d.user_agent||"";return e.includes("Android")?"Android":e.includes("iOS")||e.includes("iPhone")||e.includes("iPad")?"iOS":e.includes("Windows")?"Windows":e.includes("Mac")?"macOS":e.includes("Linux")?"Linux":null},ze=d=>{const e=(d.user_agent||"").toLowerCase(),y=(d.organization||"").toLowerCase();return X(d)?y.includes("google")?"Google 审核爬虫":y.includes("facebook")?"Facebook 审核爬虫":y.includes("twitter")?"Twitter 审核爬虫":y.includes("linkedin")?"LinkedIn 审核爬虫":y.includes("microsoft")?"Microsoft 审核爬虫":y.includes("bytedance")||y.includes("tiktok")?"TikTok 审核爬虫":"审核爬虫":e.includes("googlebot")||y.includes("google")&&e.includes("bot")?"Googlebot":e.includes("bingbot")||y.includes("microsoft")&&e.includes("bot")?"BingBot":e.includes("facebook")?"Facebook Crawler":e.includes("twitter")?"Twitter Bot":e.includes("ahrefs")||y.includes("ahrefs")?"aHrefs Bot":e.includes("httpx")?"httpx":e.includes("barkrowler")?"Barkrowler":M(d)?"通用爬虫":null},he=d=>{const e=(d.user_agent||"").toLowerCase(),y=(d.organization||"").toLowerCase();return X(d)?"广告/内容合规审核（无UA或异常UA）":e.includes("googlebot")||y.includes("google")&&e.includes("bot")||e.includes("bingbot")||y.includes("microsoft")&&e.includes("bot")?"搜索引擎蜘蛛":e.includes("facebook")||e.includes("twitter")?"社交媒体爬虫":e.includes("ahrefs")||y.includes("ahrefs")?"SEO分析爬虫":M(d)?"通用网络爬虫":null},ue=d=>({A:"primary",B:"success",C:"warning",D:"danger",E:"info"})[d]||"info",re=d=>({A:"A页",B:"B页",C:"C页",D:"D页",E:"E页"})[d]||d,Ce=d=>({YouTube:"danger","Android App":"success",Google:"primary",Facebook:"primary",Instagram:"warning",TikTok:"danger","Twitter/X":"info",直接访问:"info",其他:""})[d]||"info",Ie=()=>({today:"今天",yesterday:"昨天",week:"本周",month:"本月",all:"全部时间"})[g.timeRange]||"今天",N=async()=>{try{G.value=!0;const d={page:z.page,size:z.size,...g},e=await U.getVisitorIps(d);e.code===200&&(J.value=e.data.list,z.total=e.data.total)}catch(d){console.error("获取访客IP列表失败:",d),I.error("获取访客IP列表失败")}finally{G.value=!1}},Y=async()=>{try{const d=await U.getIpStatistics({timeRange:g.timeRange||"today"});d.code===200&&(S.value=d.data)}catch(d){console.error("获取统计数据失败:",d),I.error("获取统计数据失败")}},Z=()=>{z.page=1,N(),Y()},xe=()=>{Object.assign(g,{ip:"",timeRange:"today",visitorType:"",productId:""}),B.value="",Z()},w=async()=>{try{Q.value=!0;const{data:d}=await es({page:T.page,size:T.size});H.value=d.list||[],O.value=d.list||[],T.total=d.total||0}catch{I.error("加载商品列表失败")}finally{Q.value=!1}},Pe=()=>{if(!$.value){O.value=H.value;return}const d=$.value.toLowerCase();O.value=H.value.filter(e=>{var y,m;return((y=e.title)==null?void 0:y.toLowerCase().includes(d))||((m=e.spu_id)==null?void 0:m.toLowerCase().includes(d))})},ce=d=>{g.productId=d.spu_id,B.value=d.title,R.value=!1,I.success(`已选择商品: ${d.title}`)},Ve=()=>{g.productId="",B.value=""},Te=d=>{z.size=d,z.page=1,N()},Se=d=>{z.page=d,N()},Ae=async d=>{try{const e=await U.getVisitorIp(d.ip_address);e.code===200&&(n.value=e.data,q.value=!0)}catch(e){console.error("获取IP详情失败:",e),I.error("获取IP详情失败")}},Le=async()=>{var d;try{W.value=!0;const e=await U.clearAllIpCache();e.code===200?I.success(e.message||`成功清理 ${((d=e.data)==null?void 0:d.count)||0} 个IP缓存`):I.error(e.message||"清空缓存失败")}catch(e){console.error("清空IP缓存失败:",e),I.error("清空缓存失败")}finally{W.value=!1}},De=async d=>{try{I.info(`正在重新识别 IP: ${d.ip_address}...`);const e=await U.refreshIpInfo(d.ip_address);e.code===200?(I.success("IP信息已重新识别并更新"),await N()):I.error(e.message||"重新识别失败")}catch(e){console.error("重新识别IP失败:",e),I.error("重新识别IP失败")}};return Ee(()=>{N(),Y(),w()}),(d,e)=>{const y=f("el-input"),m=f("el-form-item"),k=f("el-option"),K=f("el-select"),b=f("el-icon"),A=f("el-button"),Be=f("el-form"),V=f("el-card"),L=f("el-col"),pe=f("el-row"),_=f("el-tag"),_e=f("el-pagination"),ee=f("el-table-column"),Me=f("el-table"),se=f("el-dialog"),p=f("el-descriptions-item"),P=f("el-descriptions"),ye=f("el-link"),j=f("el-text"),Ne=f("el-timeline-item"),Ue=f("el-timeline"),Re=f("el-empty"),te=Fe("loading");return i(),r("div",ts,[l(V,{class:"search-card",shadow:"never"},{default:s(()=>[l(Be,{model:g,inline:!0,class:"search-form"},{default:s(()=>[l(m,{label:"IP地址"},{default:s(()=>[l(y,{modelValue:g.ip,"onUpdate:modelValue":e[0]||(e[0]=a=>g.ip=a),placeholder:"请输入IP地址",clearable:"",style:{width:"200px"},onKeyup:Ke(Z,["enter"])},null,8,["modelValue"])]),_:1}),l(m,{label:"时间筛选"},{default:s(()=>[l(K,{modelValue:g.timeRange,"onUpdate:modelValue":e[1]||(e[1]=a=>g.timeRange=a),placeholder:"请选择时间范围",style:{width:"150px"}},{default:s(()=>[l(k,{label:"当天",value:"today"}),l(k,{label:"昨天",value:"yesterday"}),l(k,{label:"本周",value:"week"}),l(k,{label:"本月",value:"month"}),l(k,{label:"全部",value:"all"})]),_:1},8,["modelValue"])]),_:1}),l(m,{label:"访客类型"},{default:s(()=>[l(K,{modelValue:g.visitorType,"onUpdate:modelValue":e[2]||(e[2]=a=>g.visitorType=a),placeholder:"请选择类型",clearable:"",style:{width:"150px"}},{default:s(()=>[l(k,{label:"访客",value:"visitor"}),l(k,{label:"爬虫",value:"bot"}),l(k,{label:"代理",value:"proxy"})]),_:1},8,["modelValue"])]),_:1}),l(m,{label:"商品筛选"},{default:s(()=>[l(y,{modelValue:B.value,"onUpdate:modelValue":e[3]||(e[3]=a=>B.value=a),placeholder:"点击选择商品",readonly:"",style:{width:"200px"},onClick:e[4]||(e[4]=a=>R.value=!0)},{suffix:s(()=>[g.productId?(i(),c(b,{key:0,onClick:fe(Ve,["stop"]),style:{cursor:"pointer"}},{default:s(()=>[l(C(je))]),_:1})):(i(),c(b,{key:1},{default:s(()=>[l(C(me))]),_:1}))]),_:1},8,["modelValue"])]),_:1}),l(m,null,{default:s(()=>[l(A,{type:"primary",onClick:Z},{default:s(()=>[...e[13]||(e[13]=[u("搜索",-1)])]),_:1}),l(A,{onClick:xe},{default:s(()=>[...e[14]||(e[14]=[u("重置",-1)])]),_:1}),l(A,{type:"warning",onClick:Le,loading:W.value},{default:s(()=>[l(b,null,{default:s(()=>[l(C(Ge))]),_:1}),e[15]||(e[15]=u(" 一键清空缓存 ",-1))]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1}),t("div",ls,[t("h3",null,"统计数据（"+o(Ie())+"）",1)]),l(pe,{gutter:20,class:"statistics-cards"},{default:s(()=>[l(L,{span:4},{default:s(()=>[l(V,{class:"stat-card"},{default:s(()=>[t("div",as,[t("div",is,o(S.value.totalIps),1),e[16]||(e[16]=t("div",{class:"stat-label"},"总IP数",-1))]),t("div",ns,[l(b,null,{default:s(()=>[l(C(We))]),_:1})])]),_:1})]),_:1}),l(L,{span:4},{default:s(()=>[l(V,{class:"stat-card"},{default:s(()=>[t("div",os,[t("div",ds,o(S.value.todayIps),1),e[17]||(e[17]=t("div",{class:"stat-label"},"今日新增",-1))]),t("div",us,[l(b,null,{default:s(()=>[l(C(qe))]),_:1})])]),_:1})]),_:1}),l(L,{span:4},{default:s(()=>[l(V,{class:"stat-card genuine"},{default:s(()=>[t("div",rs,[t("div",cs,o(S.value.genuineCount),1),e[18]||(e[18]=t("div",{class:"stat-label"},"访问正品",-1))]),t("div",ps,[l(b,null,{default:s(()=>[l(C(Qe))]),_:1})])]),_:1})]),_:1}),l(L,{span:4},{default:s(()=>[l(V,{class:"stat-card fake"},{default:s(()=>[t("div",_s,[t("div",ys,o(S.value.fakeCount),1),e[19]||(e[19]=t("div",{class:"stat-label"},"访问仿品",-1))]),t("div",vs,[l(b,null,{default:s(()=>[l(C(He))]),_:1})])]),_:1})]),_:1}),l(L,{span:4},{default:s(()=>[l(V,{class:"stat-card"},{default:s(()=>[t("div",fs,[t("div",ms,o(S.value.totalCountries),1),e[20]||(e[20]=t("div",{class:"stat-label"},"涉及国家",-1))]),t("div",gs,[l(b,null,{default:s(()=>[l(C(Je))]),_:1})])]),_:1})]),_:1}),l(L,{span:4},{default:s(()=>[l(V,{class:"stat-card"},{default:s(()=>[t("div",bs,[t("div",ks,o(S.value.totalCities),1),e[21]||(e[21]=t("div",{class:"stat-label"},"涉及城市",-1))]),t("div",zs,[l(b,null,{default:s(()=>[l(C(Xe))]),_:1})])]),_:1})]),_:1})]),_:1}),l(pe,{gutter:20,class:"statistics-cards",style:{"margin-top":"20px"}},{default:s(()=>[l(L,{span:24},{default:s(()=>[l(V,{class:"source-stats-card"},{default:s(()=>[e[23]||(e[23]=t("div",{class:"card-header"},[t("h3",null,"访问来源统计")],-1)),t("div",hs,[(i(!0),r(ae,null,ie(S.value.sourceStats,a=>(i(),r("div",{key:a.source,class:"source-item"},[t("div",Cs,[l(_,{type:Ce(a.source),size:"default"},{default:s(()=>[u(o(a.source),1)]),_:2},1032,["type"])]),t("div",Is,[t("span",xs,o(a.count),1),e[22]||(e[22]=t("span",{class:"count-label"},"次",-1))])]))),128))])]),_:1})]),_:1})]),_:1}),l(V,{class:"table-card",shadow:"never"},{default:s(()=>[t("div",Ps,[e[25]||(e[25]=t("div",{class:"table-title"},"访客IP列表",-1)),t("div",Vs,[l(A,{onClick:Y},{default:s(()=>[l(b,null,{default:s(()=>[l(C(Ye))]),_:1}),e[24]||(e[24]=u(" 刷新统计 ",-1))]),_:1})])]),ne((i(),r("div",Ts,[(i(!0),r(ae,null,ie(J.value,(a,ve)=>(i(),r("div",{key:a.id,class:Ze(["ip-item",{"last-item":ve===J.value.length-1}])},[t("div",Ss,[t("div",As,o(a.ip_address),1),t("div",Ls,[l(A,{type:"success",size:"small",onClick:Oe=>De(a)},{default:s(()=>[l(b,null,{default:s(()=>[l(C(we))]),_:1}),e[26]||(e[26]=u(" 重新识别 ",-1))]),_:1},8,["onClick"]),l(A,{type:"primary",size:"small",onClick:Oe=>Ae(a)},{default:s(()=>[...e[27]||(e[27]=[u("查看",-1)])]),_:1},8,["onClick"])])]),t("div",Ds,[t("div",Bs,[e[39]||(e[39]=t("div",{class:"section-title"},"地理位置",-1)),t("div",Ms,[t("div",Ns,[e[28]||(e[28]=t("span",{class:"label"},"城市:",-1)),t("span",Us,o(a.city||"-"),1)]),t("div",Rs,[e[29]||(e[29]=t("span",{class:"label"},"地区:",-1)),t("span",Os,[u(o(a.region||"-")+" ",1),a.region_code?(i(),c(_,{key:0,size:"small",type:"info",style:{"margin-left":"4px"}},{default:s(()=>[u(o(a.region_code),1)]),_:2},1024)):v("",!0)])]),t("div",$s,[e[30]||(e[30]=t("span",{class:"label"},"国家:",-1)),t("span",Es,[u(o(a.country_name||a.country||"-")+" ",1),a.country_code||a.country?(i(),c(_,{key:0,size:"small",type:"info",style:{"margin-left":"4px"}},{default:s(()=>[u(o(a.country_code||a.country),1)]),_:2},1024)):v("",!0)])]),a.continent?(i(),r("div",Fs,[e[31]||(e[31]=t("span",{class:"label"},"大洲:",-1)),t("span",Ks,[u(o(a.continent)+" ",1),a.continent_code?(i(),c(_,{key:0,size:"small",type:"info",style:{"margin-left":"4px"}},{default:s(()=>[u(o(a.continent_code),1)]),_:2},1024)):v("",!0)])])):v("",!0),a.postal_code?(i(),r("div",js,[e[32]||(e[32]=t("span",{class:"label"},"邮编:",-1)),t("span",Gs,o(a.postal_code),1)])):v("",!0),a.timezone?(i(),r("div",Ws,[e[33]||(e[33]=t("span",{class:"label"},"时区:",-1)),t("span",qs,o(a.timezone),1)])):v("",!0),a.latitude&&a.longitude?(i(),r("div",Qs,[e[34]||(e[34]=t("span",{class:"label"},"坐标:",-1)),t("span",Hs,o(a.latitude)+", "+o(a.longitude),1)])):a.location?(i(),r("div",Js,[e[35]||(e[35]=t("span",{class:"label"},"坐标:",-1)),t("span",Xs,o(a.location),1)])):v("",!0),t("div",Ys,[e[36]||(e[36]=t("span",{class:"label"},"首次访问:",-1)),t("span",Zs,o(E(a.first_visit)),1)]),t("div",ws,[e[37]||(e[37]=t("span",{class:"label"},"最后访问:",-1)),t("span",et,o(E(a.last_visit)),1)]),t("div",st,[e[38]||(e[38]=t("span",{class:"label"},"访问次数:",-1)),l(_,{type:"info",size:"small"},{default:s(()=>[u(o(a.visit_count),1)]),_:2},1024)])])]),t("div",tt,[e[48]||(e[48]=t("div",{class:"section-title"},"网络与组织",-1)),t("div",lt,[t("div",at,[e[40]||(e[40]=t("span",{class:"label"},"主机名:",-1)),t("span",{class:"value",title:a.hostname||"-"},o(a.hostname||"-"),9,it)]),t("div",nt,[e[41]||(e[41]=t("span",{class:"label"},"ASN号码:",-1)),t("span",ot,o(a.asn||"-"),1)]),t("div",dt,[e[42]||(e[42]=t("span",{class:"label"},"AS组织名称:",-1)),t("span",{class:"value",title:a.as_name||"-"},o(a.as_name||"-"),9,ut)]),t("div",rt,[e[43]||(e[43]=t("span",{class:"label"},"AS域名:",-1)),t("span",ct,o(a.as_domain||"-"),1)]),t("div",pt,[e[44]||(e[44]=t("span",{class:"label"},"AS类型:",-1)),t("span",_t,[a.as_type?(i(),c(_,{key:0,size:"small",type:"primary"},{default:s(()=>[u(o(a.as_type),1)]),_:2},1024)):(i(),r("span",yt,"-"))])]),a.organization&&a.organization!==a.asn+" "+a.as_name?(i(),r("div",vt,[e[45]||(e[45]=t("span",{class:"label"},"组织信息:",-1)),t("span",{class:"value",title:a.organization},o(a.organization),9,ft)])):v("",!0),t("div",mt,[F(a)?(i(),c(_,{key:0,size:"small",type:"info"},{default:s(()=>[...e[46]||(e[46]=[u("代理",-1)])]),_:1})):v("",!0),ge(a)?(i(),c(_,{key:1,size:"small",type:"warning"},{default:s(()=>[...e[47]||(e[47]=[u("机房",-1)])]),_:1})):v("",!0)])])]),t("div",gt,[e[57]||(e[57]=t("div",{class:"section-title"},"访问信息",-1)),t("div",bt,[t("div",kt,[e[49]||(e[49]=t("span",{class:"label"},"访问类型:",-1)),l(_,{type:de(a),size:"small"},{default:s(()=>[u(o(oe(a)),1)]),_:2},1032,["type"])]),t("div",zt,[e[50]||(e[50]=t("span",{class:"label"},"设备:",-1)),t("span",ht,o(be(a)||"-"),1)]),t("div",Ct,[e[51]||(e[51]=t("span",{class:"label"},"系统:",-1)),t("span",It,o(ke(a)||"-"),1)]),t("div",xt,[e[52]||(e[52]=t("span",{class:"label"},"商品ID:",-1)),a.product_id?(i(),c(_,{key:0,size:"small",type:"success"},{default:s(()=>[u(o(a.product_id),1)]),_:2},1024)):(i(),r("span",Pt,"-"))]),t("div",Vt,[e[53]||(e[53]=t("span",{class:"label"},"产品类型:",-1)),a.product_type?(i(),c(_,{key:0,size:"small",type:ue(a.product_type)},{default:s(()=>[u(o(re(a.product_type)),1)]),_:2},1032,["type"])):(i(),r("span",Tt,"-"))]),t("div",St,[e[54]||(e[54]=t("span",{class:"label"},"访问页面:",-1)),t("span",{class:"value referer",title:a.access_address||"-"},o(a.access_address||"-"),9,At)]),t("div",Lt,[e[55]||(e[55]=t("span",{class:"label"},"来源页面:",-1)),t("span",{class:"value referer",title:a.referer||"-"},o(a.referer||"-"),9,Dt)]),t("div",Bt,[e[56]||(e[56]=t("span",{class:"label"},"User-Agent:",-1)),t("span",{class:"value referer",title:a.user_agent||"-"},o(a.user_agent||"-"),9,Mt)])])]),t("div",Nt,[e[73]||(e[73]=t("div",{class:"section-title"},"Privacy 隐私检测",-1)),t("div",Ut,[t("span",Rt,[e[60]||(e[60]=t("span",{class:"privacy-label"},"VPN:",-1)),a.privacy_vpn||a.is_anonymous?(i(),c(_,{key:0,type:"danger",size:"small"},{default:s(()=>[...e[58]||(e[58]=[u("是",-1)])]),_:1})):(i(),c(_,{key:1,type:"success",size:"small"},{default:s(()=>[...e[59]||(e[59]=[u("否",-1)])]),_:1}))]),t("span",Ot,[e[63]||(e[63]=t("span",{class:"privacy-label"},"Proxy:",-1)),a.privacy_proxy?(i(),c(_,{key:0,type:"danger",size:"small"},{default:s(()=>[...e[61]||(e[61]=[u("是",-1)])]),_:1})):(i(),c(_,{key:1,type:"success",size:"small"},{default:s(()=>[...e[62]||(e[62]=[u("否",-1)])]),_:1}))]),t("span",$t,[e[66]||(e[66]=t("span",{class:"privacy-label"},"Tor:",-1)),a.privacy_tor?(i(),c(_,{key:0,type:"danger",size:"small"},{default:s(()=>[...e[64]||(e[64]=[u("是",-1)])]),_:1})):(i(),c(_,{key:1,type:"success",size:"small"},{default:s(()=>[...e[65]||(e[65]=[u("否",-1)])]),_:1}))]),t("span",Et,[e[69]||(e[69]=t("span",{class:"privacy-label"},"托管:",-1)),a.privacy_hosting||a.is_hosting?(i(),c(_,{key:0,type:"warning",size:"small"},{default:s(()=>[...e[67]||(e[67]=[u("是",-1)])]),_:1})):(i(),c(_,{key:1,type:"success",size:"small"},{default:s(()=>[...e[68]||(e[68]=[u("否",-1)])]),_:1}))]),t("span",Ft,[e[72]||(e[72]=t("span",{class:"privacy-label"},"移动:",-1)),a.is_mobile||a.carrier_name?(i(),c(_,{key:0,type:"primary",size:"small"},{default:s(()=>[...e[70]||(e[70]=[u("是",-1)])]),_:1})):(i(),c(_,{key:1,type:"info",size:"small"},{default:s(()=>[...e[71]||(e[71]=[u("否",-1)])]),_:1}))])])]),M(a)||F(a)?(i(),r("div",Kt,[e[77]||(e[77]=t("div",{class:"section-title"},"详细类型",-1)),t("div",jt,[t("div",Gt,[e[74]||(e[74]=t("span",{class:"label"},"类型:",-1)),l(_,{type:de(a),size:"small"},{default:s(()=>[u(o(oe(a)),1)]),_:2},1032,["type"])]),t("div",Wt,[e[75]||(e[75]=t("span",{class:"label"},"名称:",-1)),t("span",qt,o(ze(a)||"-"),1)]),t("div",Qt,[e[76]||(e[76]=t("span",{class:"label"},"说明:",-1)),t("span",Ht,o(he(a)||"-"),1)])])])):v("",!0)])],2))),128))])),[[te,G.value]]),t("div",Jt,[l(_e,{"current-page":z.page,"onUpdate:currentPage":e[5]||(e[5]=a=>z.page=a),"page-size":z.size,"onUpdate:pageSize":e[6]||(e[6]=a=>z.size=a),total:z.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:Te,onCurrentChange:Se},null,8,["current-page","page-size","total"])])]),_:1}),l(se,{modelValue:R.value,"onUpdate:modelValue":e[10]||(e[10]=a=>R.value=a),title:"选择商品",width:"800px","close-on-click-modal":!1},{default:s(()=>[t("div",Xt,[l(y,{modelValue:$.value,"onUpdate:modelValue":e[7]||(e[7]=a=>$.value=a),placeholder:"搜索商品标题或ID",clearable:"",style:{"margin-bottom":"20px"},onInput:Pe},{prefix:s(()=>[l(b,null,{default:s(()=>[l(C(me))]),_:1})]),_:1},8,["modelValue"]),ne((i(),c(Me,{data:O.value,height:"400","highlight-current-row":"",onRowClick:ce},{default:s(()=>[l(ee,{prop:"spu_id",label:"商品ID",width:"180"}),l(ee,{prop:"title",label:"商品标题","show-overflow-tooltip":""}),l(ee,{label:"操作",width:"100",align:"center"},{default:s(a=>[l(A,{type:"primary",size:"small",onClick:fe(ve=>ce(a.row),["stop"])},{default:s(()=>[...e[78]||(e[78]=[u("选择",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[te,Q.value]]),l(_e,{"current-page":T.page,"onUpdate:currentPage":e[8]||(e[8]=a=>T.page=a),"page-size":T.size,"onUpdate:pageSize":e[9]||(e[9]=a=>T.size=a),total:T.total,"page-sizes":[10,20,50],layout:"total, sizes, prev, pager, next",style:{"margin-top":"20px"},onSizeChange:w,onCurrentChange:w},null,8,["current-page","page-size","total"])])]),_:1},8,["modelValue"]),l(se,{modelValue:q.value,"onUpdate:modelValue":e[11]||(e[11]=a=>q.value=a),title:"IP详情",width:"800px","close-on-click-modal":!1},{default:s(()=>[n.value?(i(),r("div",Yt,[t("div",Zt,[e[79]||(e[79]=t("h4",{class:"section-title"},"基础信息",-1)),l(P,{column:2,border:"",size:"default"},{default:s(()=>[l(p,{label:"IP地址"},{default:s(()=>[u(o(n.value.ip_address),1)]),_:1}),l(p,{label:"主机名"},{default:s(()=>[n.value.hostname?(i(),r("span",wt,o(n.value.hostname),1)):(i(),r("span",el,"--"))]),_:1}),l(p,{label:"访问次数"},{default:s(()=>[l(_,{type:"info"},{default:s(()=>[u(o(n.value.visit_count),1)]),_:1})]),_:1}),l(p,{label:"产品类型"},{default:s(()=>[n.value.product_type?(i(),c(_,{key:0,type:ue(n.value.product_type),size:"small"},{default:s(()=>[u(o(re(n.value.product_type)),1)]),_:1},8,["type"])):(i(),r("span",sl,"--"))]),_:1}),l(p,{label:"首次访问"},{default:s(()=>[u(o(E(n.value.first_visit)),1)]),_:1}),l(p,{label:"最后访问"},{default:s(()=>[u(o(E(n.value.last_visit)),1)]),_:1})]),_:1})]),t("div",tl,[e[80]||(e[80]=t("h4",{class:"section-title"},"地理位置信息",-1)),l(P,{column:2,border:"",size:"default"},{default:s(()=>[l(p,{label:"城市"},{default:s(()=>[n.value.city?(i(),r("span",ll,o(n.value.city),1)):(i(),r("span",al,"--"))]),_:1}),l(p,{label:"地区"},{default:s(()=>[n.value.region?(i(),r("span",il,o(n.value.region),1)):(i(),r("span",nl,"--"))]),_:1}),l(p,{label:"国家代码"},{default:s(()=>[n.value.country_code?(i(),r("span",ol,o(n.value.country_code),1)):n.value.country?(i(),r("span",dl,o(n.value.country),1)):(i(),r("span",ul,"--"))]),_:1}),l(p,{label:"大洲"},{default:s(()=>[n.value.continent?(i(),r("span",rl,o(n.value.continent)+" ("+o(n.value.continent_code)+") ",1)):(i(),r("span",cl,"--"))]),_:1}),l(p,{label:"邮编"},{default:s(()=>[n.value.postal_code?(i(),r("span",pl,o(n.value.postal_code),1)):(i(),r("span",_l,"--"))]),_:1}),l(p,{label:"时区"},{default:s(()=>[n.value.timezone?(i(),r("span",yl,o(n.value.timezone),1)):(i(),r("span",vl,"--"))]),_:1}),l(p,{label:"经纬度",span:2},{default:s(()=>[n.value.latitude&&n.value.longitude?(i(),r("span",fl,o(n.value.latitude)+", "+o(n.value.longitude),1)):n.value.location?(i(),r("span",ml,o(n.value.location),1)):(i(),r("span",gl,"--"))]),_:1})]),_:1})]),t("div",bl,[e[81]||(e[81]=t("h4",{class:"section-title"},"AS (自治系统) 信息",-1)),l(P,{column:2,border:"",size:"default"},{default:s(()=>[l(p,{label:"ASN"},{default:s(()=>[n.value.asn?(i(),r("span",kl,o(n.value.asn),1)):(i(),r("span",zl,"--"))]),_:1}),l(p,{label:"AS 类型"},{default:s(()=>[n.value.as_type?(i(),c(_,{key:0,size:"small"},{default:s(()=>[u(o(n.value.as_type),1)]),_:1})):(i(),r("span",hl,"--"))]),_:1}),l(p,{label:"AS 组织名称",span:2},{default:s(()=>[n.value.as_name?(i(),r("span",Cl,o(n.value.as_name),1)):n.value.organization?(i(),r("span",Il,o(n.value.organization),1)):(i(),r("span",xl,"--"))]),_:1}),l(p,{label:"AS 域名",span:2},{default:s(()=>[n.value.as_domain?(i(),r("span",Pl,o(n.value.as_domain),1)):(i(),r("span",Vl,"--"))]),_:1}),l(p,{label:"AS 路由",span:2},{default:s(()=>[n.value.asn_route?(i(),r("span",Tl,o(n.value.asn_route),1)):(i(),r("span",Sl,"--"))]),_:1})]),_:1})]),n.value.privacy_vpn!==void 0||n.value.privacy_proxy!==void 0?(i(),r("div",Al,[e[92]||(e[92]=t("h4",{class:"section-title"},"隐私检测详情 (Premium)",-1)),l(P,{column:3,border:"",size:"default"},{default:s(()=>[l(p,{label:"VPN"},{default:s(()=>[n.value.privacy_vpn?(i(),c(_,{key:0,type:"danger",size:"small"},{default:s(()=>[...e[82]||(e[82]=[u("是",-1)])]),_:1})):(i(),c(_,{key:1,type:"success",size:"small"},{default:s(()=>[...e[83]||(e[83]=[u("否",-1)])]),_:1}))]),_:1}),l(p,{label:"代理"},{default:s(()=>[n.value.privacy_proxy?(i(),c(_,{key:0,type:"danger",size:"small"},{default:s(()=>[...e[84]||(e[84]=[u("是",-1)])]),_:1})):(i(),c(_,{key:1,type:"success",size:"small"},{default:s(()=>[...e[85]||(e[85]=[u("否",-1)])]),_:1}))]),_:1}),l(p,{label:"Tor"},{default:s(()=>[n.value.privacy_tor?(i(),c(_,{key:0,type:"danger",size:"small"},{default:s(()=>[...e[86]||(e[86]=[u("是",-1)])]),_:1})):(i(),c(_,{key:1,type:"success",size:"small"},{default:s(()=>[...e[87]||(e[87]=[u("否",-1)])]),_:1}))]),_:1}),l(p,{label:"中继"},{default:s(()=>[n.value.privacy_relay?(i(),c(_,{key:0,type:"warning",size:"small"},{default:s(()=>[...e[88]||(e[88]=[u("是",-1)])]),_:1})):(i(),c(_,{key:1,type:"success",size:"small"},{default:s(()=>[...e[89]||(e[89]=[u("否",-1)])]),_:1}))]),_:1}),l(p,{label:"托管服务"},{default:s(()=>[n.value.privacy_hosting?(i(),c(_,{key:0,type:"warning",size:"small"},{default:s(()=>[...e[90]||(e[90]=[u("是",-1)])]),_:1})):(i(),c(_,{key:1,type:"success",size:"small"},{default:s(()=>[...e[91]||(e[91]=[u("否",-1)])]),_:1}))]),_:1}),l(p,{label:"服务类型"},{default:s(()=>[n.value.privacy_service?(i(),r("span",Ll,o(n.value.privacy_service),1)):(i(),r("span",Dl,"--"))]),_:1})]),_:1})])):v("",!0),n.value.company_name||n.value.carrier_name?(i(),r("div",Bl,[e[93]||(e[93]=t("h4",{class:"section-title"},"公司/运营商信息",-1)),l(P,{column:2,border:"",size:"default"},{default:s(()=>[n.value.company_name?(i(),c(p,{key:0,label:"公司名称"},{default:s(()=>[u(o(n.value.company_name),1)]),_:1})):v("",!0),n.value.company_domain?(i(),c(p,{key:1,label:"公司域名"},{default:s(()=>[u(o(n.value.company_domain),1)]),_:1})):v("",!0),n.value.company_type?(i(),c(p,{key:2,label:"公司类型"},{default:s(()=>[l(_,{size:"small"},{default:s(()=>[u(o(n.value.company_type),1)]),_:1})]),_:1})):v("",!0),n.value.carrier_name?(i(),c(p,{key:3,label:"运营商"},{default:s(()=>[u(o(n.value.carrier_name),1)]),_:1})):v("",!0),n.value.carrier_mcc?(i(),c(p,{key:4,label:"MCC"},{default:s(()=>[u(o(n.value.carrier_mcc),1)]),_:1})):v("",!0),n.value.carrier_mnc?(i(),c(p,{key:5,label:"MNC"},{default:s(()=>[u(o(n.value.carrier_mnc),1)]),_:1})):v("",!0)]),_:1})])):v("",!0),n.value.abuse_email?(i(),r("div",Ml,[e[94]||(e[94]=t("h4",{class:"section-title"},"滥用举报联系信息",-1)),l(P,{column:2,border:"",size:"default"},{default:s(()=>[n.value.abuse_name?(i(),c(p,{key:0,label:"联系人"},{default:s(()=>[u(o(n.value.abuse_name),1)]),_:1})):v("",!0),n.value.abuse_email?(i(),c(p,{key:1,label:"邮箱"},{default:s(()=>[t("a",{href:`mailto:${n.value.abuse_email}`},o(n.value.abuse_email),9,Nl)]),_:1})):v("",!0),n.value.abuse_phone?(i(),c(p,{key:2,label:"电话"},{default:s(()=>[u(o(n.value.abuse_phone),1)]),_:1})):v("",!0),n.value.abuse_country?(i(),c(p,{key:3,label:"国家"},{default:s(()=>[u(o(n.value.abuse_country),1)]),_:1})):v("",!0),n.value.abuse_address?(i(),c(p,{key:4,label:"地址",span:2},{default:s(()=>[u(o(n.value.abuse_address),1)]),_:1})):v("",!0),n.value.abuse_network?(i(),c(p,{key:5,label:"网络范围",span:2},{default:s(()=>[u(o(n.value.abuse_network),1)]),_:1})):v("",!0)]),_:1})])):v("",!0),n.value.domains_total?(i(),r("div",Ul,[e[95]||(e[95]=t("h4",{class:"section-title"},"其他信息",-1)),l(P,{column:2,border:"",size:"default"},{default:s(()=>[l(p,{label:"关联域名总数"},{default:s(()=>[u(o(n.value.domains_total),1)]),_:1})]),_:1})])):v("",!0),t("div",Rl,[e[106]||(e[106]=t("h4",{class:"section-title"},"IP 特征标识",-1)),l(P,{column:3,border:"",size:"default"},{default:s(()=>[l(p,{label:"匿名 IP"},{default:s(()=>[n.value.is_anonymous?(i(),c(_,{key:0,type:"danger",size:"small"},{default:s(()=>[...e[96]||(e[96]=[u("是 (VPN/Proxy)",-1)])]),_:1})):(i(),c(_,{key:1,type:"success",size:"small"},{default:s(()=>[...e[97]||(e[97]=[u("否",-1)])]),_:1}))]),_:1}),l(p,{label:"托管 IP"},{default:s(()=>[n.value.is_hosting?(i(),c(_,{key:0,type:"warning",size:"small"},{default:s(()=>[...e[98]||(e[98]=[u("是 (数据中心)",-1)])]),_:1})):(i(),c(_,{key:1,type:"success",size:"small"},{default:s(()=>[...e[99]||(e[99]=[u("否",-1)])]),_:1}))]),_:1}),l(p,{label:"移动网络"},{default:s(()=>[n.value.is_mobile?(i(),c(_,{key:0,type:"primary",size:"small"},{default:s(()=>[...e[100]||(e[100]=[u("是",-1)])]),_:1})):(i(),c(_,{key:1,type:"info",size:"small"},{default:s(()=>[...e[101]||(e[101]=[u("否",-1)])]),_:1}))]),_:1}),l(p,{label:"任播 IP"},{default:s(()=>[n.value.is_anycast?(i(),c(_,{key:0,type:"info",size:"small"},{default:s(()=>[...e[102]||(e[102]=[u("是",-1)])]),_:1})):(i(),c(_,{key:1,type:"info",size:"small"},{default:s(()=>[...e[103]||(e[103]=[u("否",-1)])]),_:1}))]),_:1}),l(p,{label:"卫星网络"},{default:s(()=>[n.value.is_satellite?(i(),c(_,{key:0,type:"info",size:"small"},{default:s(()=>[...e[104]||(e[104]=[u("是",-1)])]),_:1})):(i(),c(_,{key:1,type:"info",size:"small"},{default:s(()=>[...e[105]||(e[105]=[u("否",-1)])]),_:1}))]),_:1})]),_:1})]),t("div",Ol,[e[107]||(e[107]=t("h4",{class:"section-title"},"访问信息",-1)),l(P,{column:1,border:"",size:"default"},{default:s(()=>[l(p,{label:"访问页面"},{default:s(()=>[n.value.access_address?(i(),r("div",$l,[l(ye,{href:n.value.access_address,target:"_blank",type:"primary",size:"small"},{default:s(()=>[u(o(n.value.access_address),1)]),_:1},8,["href"])])):(i(),r("span",El,"--"))]),_:1}),l(p,{label:"来源页面"},{default:s(()=>[n.value.referer?(i(),r("div",Fl,[l(ye,{href:n.value.referer,target:"_blank",type:"primary",size:"small"},{default:s(()=>[u(o(n.value.referer),1)]),_:1},8,["href"])])):(i(),r("span",Kl,"--"))]),_:1})]),_:1})])])):v("",!0)]),_:1},8,["modelValue"]),l(se,{modelValue:d.timelineDialogVisible,"onUpdate:modelValue":e[12]||(e[12]=a=>d.timelineDialogVisible=a),title:"用户行为轨迹",width:"800px","close-on-click-modal":!1},{default:s(()=>[ne((i(),r("div",jl,[d.currentTimeline?(i(),r("div",Gl,[t("div",Wl,[l(P,{column:2,size:"small",border:""},{default:s(()=>[l(p,{label:"Session ID"},{default:s(()=>[l(j,{size:"small",type:"info"},{default:s(()=>[u(o(d.currentTimeline.sessionId),1)]),_:1})]),_:1}),l(p,{label:"数据来源"},{default:s(()=>[l(_,{type:d.currentTimeline.source==="redis"?"success":"info",size:"small"},{default:s(()=>[u(o(d.currentTimeline.source==="redis"?"Redis (实时)":"MySQL (历史)"),1)]),_:1},8,["type"])]),_:1}),l(p,{label:"进入时间"},{default:s(()=>[u(o(d.currentTimeline.enterTime),1)]),_:1}),l(p,{label:"离开时间"},{default:s(()=>[u(o(d.currentTimeline.exitTime||"未离开"),1)]),_:1}),l(p,{label:"停留时长"},{default:s(()=>[l(j,{type:"primary"},{default:s(()=>[u(o(d.currentTimeline.durationText),1)]),_:1})]),_:1}),l(p,{label:"操作次数"},{default:s(()=>[l(j,{type:"warning"},{default:s(()=>[u(o(d.currentTimeline.actions.length)+" 次",1)]),_:1})]),_:1})]),_:1})]),t("div",ql,[l(Ue,null,{default:s(()=>[(i(!0),r(ae,null,ie(d.currentTimeline.actions,a=>(i(),c(Ne,{key:a.sequence,timestamp:a.time,type:d.getActionType(a.type),placement:"top"},{default:s(()=>[t("div",Ql,[t("div",Hl,[l(_,{type:d.getActionTagType(a.type),size:"small"},{default:s(()=>[u(o(a.typeName),1)]),_:2},1032,["type"]),t("span",Jl,o(a.description),1)]),a.detail?(i(),r("div",Xl,[l(j,{size:"small",type:"info"},{default:s(()=>[u(" 详情: "+o(JSON.stringify(a.detail)),1)]),_:2},1024)])):v("",!0)])]),_:2},1032,["timestamp","type"]))),128))]),_:1})])])):(i(),c(Re,{key:1,description:"暂无轨迹数据"}))])),[[te,d.timelineLoading]])]),_:1},8,["modelValue"])])}}}),sa=ss(Yl,[["__scopeId","data-v-c64c7b39"]]);export{sa as default};
