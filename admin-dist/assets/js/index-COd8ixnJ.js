import{d as L,h as V,P as $,Z as it,r as d,Q as dt,c as x,o as r,a as s,b as t,w as l,u as n,aM as ut,t as m,at as P,aK as ct,aL as _t,_ as rt,x as K,e as g,E as q,W as pt,aP as F,g as T,aN as ft,aQ as U,aC as gt,aD as mt,aR as vt,N as D,a0 as bt}from"./index-Bj6ddc6A.js";import{g as kt}from"./product-CUsRE0If.js";import{_ as xt}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ht={class:"pixel-management"},yt={class:"stats-cards"},Ct={class:"stat-content"},wt={class:"stat-icon google"},zt={class:"stat-info"},Vt={class:"stat-number"},Pt={class:"stat-content"},Tt={class:"stat-icon enabled"},Dt={class:"stat-info"},St={class:"stat-number"},At={class:"stat-content"},Bt={class:"stat-icon google"},$t={class:"stat-info"},Ft={class:"stat-number"},Ut={class:"stat-content"},Gt={class:"stat-icon facebook"},It={class:"stat-info"},Mt={class:"stat-number"},Nt={class:"table-header"},Et={class:"table-title"},Kt={class:"table-actions"},qt={class:"product-info"},Lt={class:"product-details"},Qt={class:"product-title"},Rt={class:"product-id"},jt={key:0,class:"pixel-status"},Wt={key:1,class:"pixel-status"},Zt={key:0,class:"pixel-status"},Ht={key:1,class:"pixel-status"},Jt={key:0,class:"pixel-status"},Ot={key:1,class:"pixel-status"},Xt={key:1,style:{color:"#999999"}},Yt={class:"time-info"},te={class:"action-buttons"},ee={class:"pagination-wrapper"},le={class:"pixel-config-content"},se={class:"config-actions"},ae=L({name:"PixelManagement"}),oe=L({...ae,setup(ne){const S=V(!1),A=V(!1),C=V(null),v=$({totalProducts:0,enabledProducts:0,googleAdsCount:0,facebookCount:0}),p=$({title:"",pixelStatus:"",platform:""}),u=$({current:1,size:20,total:0}),G=V([]),I=()=>{u.current=1,h()},Q=()=>{p.title="",p.pixelStatus="",p.platform="",u.current=1,h()},R=i=>{u.size=i,u.current=1,h()},j=i=>{u.current=i,h()},W=i=>{C.value=i,A.value=!0},Z=i=>{D.info(`查看商品 ${i.title} 的像素配置详情`)},H=i=>{bt.confirm(`确定要测试商品 "${i.title}" 的像素配置吗？`,"测试确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{D.success("像素测试已启动，请查看控制台输出")})},J=()=>{D.info("批量配置功能开发中...")},O=()=>{C.value&&window.open(`/product/list?pixelConfig=${C.value.id}`,"_blank")},h=async()=>{S.value=!0;try{const i={page:u.current,size:u.size,title:p.title||void 0,status:void 0,product_type:void 0},{data:e}=await kt(i);G.value=e.list,u.total=e.total,X(e.list)}catch{D.error("获取数据失败")}finally{S.value=!1}},X=i=>{v.totalProducts=i.length,v.enabledProducts=i.filter(e=>e.pixel_enabled).length,v.googleAdsCount=i.filter(e=>{var o,_;return(_=(o=e.pixel_config)==null?void 0:o.google_ads)==null?void 0:_.enabled}).length,v.facebookCount=i.filter(e=>{var o,_;return(_=(o=e.pixel_config)==null?void 0:o.facebook)==null?void 0:_.enabled}).length};return it(()=>{h()}),(i,e)=>{var E;const o=d("el-icon"),_=d("el-card"),w=d("el-col"),Y=d("el-row"),tt=d("el-input"),z=d("el-form-item"),y=d("el-option"),M=d("el-select"),b=d("el-button"),et=d("el-form"),B=d("el-tag"),N=d("el-avatar"),k=d("el-table-column"),lt=d("el-table"),st=d("el-pagination"),at=d("el-alert"),ot=d("el-dialog"),nt=dt("loading");return r(),x("div",ht,[e[26]||(e[26]=s("div",{class:"page-header"},[s("h2",null,"像素配置管理"),s("p",null,"管理所有商品的像素跟踪配置，支持Google Ads、Facebook、TikTok等平台")],-1)),s("div",yt,[t(Y,{gutter:20},{default:l(()=>[t(w,{span:6},{default:l(()=>[t(_,{class:"stat-card"},{default:l(()=>[s("div",Ct,[s("div",wt,[t(o,null,{default:l(()=>[t(n(ut))]),_:1})]),s("div",zt,[s("div",Vt,m(v.totalProducts),1),e[6]||(e[6]=s("div",{class:"stat-label"},"总商品数",-1))])])]),_:1})]),_:1}),t(w,{span:6},{default:l(()=>[t(_,{class:"stat-card"},{default:l(()=>[s("div",Pt,[s("div",Tt,[t(o,null,{default:l(()=>[t(n(P))]),_:1})]),s("div",Dt,[s("div",St,m(v.enabledProducts),1),e[7]||(e[7]=s("div",{class:"stat-label"},"已启用像素",-1))])])]),_:1})]),_:1}),t(w,{span:6},{default:l(()=>[t(_,{class:"stat-card"},{default:l(()=>[s("div",At,[s("div",Bt,[t(o,null,{default:l(()=>[t(n(ct))]),_:1})]),s("div",$t,[s("div",Ft,m(v.googleAdsCount),1),e[8]||(e[8]=s("div",{class:"stat-label"},"Google Ads",-1))])])]),_:1})]),_:1}),t(w,{span:6},{default:l(()=>[t(_,{class:"stat-card"},{default:l(()=>[s("div",Ut,[s("div",Gt,[t(o,null,{default:l(()=>[t(n(_t))]),_:1})]),s("div",It,[s("div",Mt,m(v.facebookCount),1),e[9]||(e[9]=s("div",{class:"stat-label"},"Facebook",-1))])])]),_:1})]),_:1})]),_:1})]),t(_,{class:"search-card",shadow:"never"},{default:l(()=>[t(et,{model:p,inline:"",class:"search-form"},{default:l(()=>[t(z,{label:"商品标题"},{default:l(()=>[t(tt,{modelValue:p.title,"onUpdate:modelValue":e[0]||(e[0]=a=>p.title=a),placeholder:"请输入商品标题",clearable:"",style:{width:"200px"},onKeyup:rt(I,["enter"])},{prefix:l(()=>[t(o,null,{default:l(()=>[t(n(K))]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(z,{label:"像素状态"},{default:l(()=>[t(M,{modelValue:p.pixelStatus,"onUpdate:modelValue":e[1]||(e[1]=a=>p.pixelStatus=a),placeholder:"请选择状态",clearable:"",style:{width:"120px"}},{default:l(()=>[t(y,{label:"已启用",value:"enabled"}),t(y,{label:"未启用",value:"disabled"})]),_:1},8,["modelValue"])]),_:1}),t(z,{label:"平台类型"},{default:l(()=>[t(M,{modelValue:p.platform,"onUpdate:modelValue":e[2]||(e[2]=a=>p.platform=a),placeholder:"请选择平台",clearable:"",style:{width:"120px"}},{default:l(()=>[t(y,{label:"Google Ads",value:"google_ads"}),t(y,{label:"Facebook",value:"facebook"}),t(y,{label:"TikTok",value:"tiktok"})]),_:1},8,["modelValue"])]),_:1}),t(z,null,{default:l(()=>[t(b,{type:"primary",onClick:I},{default:l(()=>[t(o,null,{default:l(()=>[t(n(K))]),_:1}),e[10]||(e[10]=g(" 搜索 ",-1))]),_:1}),t(b,{onClick:Q},{default:l(()=>[t(o,null,{default:l(()=>[t(n(q))]),_:1}),e[11]||(e[11]=g(" 重置 ",-1))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(_,{class:"table-card",shadow:"never"},{default:l(()=>[s("div",Nt,[s("div",Et,[e[12]||(e[12]=s("span",null,"像素配置列表",-1)),t(B,{type:"info",size:"small"},{default:l(()=>[g(m(u.total)+" 条记录",1)]),_:1})]),s("div",Kt,[t(b,{type:"primary",onClick:J},{default:l(()=>[t(o,null,{default:l(()=>[t(n(F))]),_:1}),e[13]||(e[13]=g(" 批量配置 ",-1))]),_:1}),t(b,{size:"small",onClick:h},{default:l(()=>[t(o,null,{default:l(()=>[t(n(q))]),_:1}),e[14]||(e[14]=g(" 刷新 ",-1))]),_:1})])]),pt((r(),T(lt,{data:G.value,stripe:"",border:"",style:{width:"100%"},"header-cell-style":{background:"#f8f9fa",color:"#606266"}},{default:l(()=>[t(k,{prop:"title",label:"商品标题","min-width":"200","show-overflow-tooltip":""},{default:l(({row:a})=>[s("div",qt,[a.image_urls&&a.image_urls[0]?(r(),T(N,{key:0,size:40,src:a.image_urls[0],shape:"square"},null,8,["src"])):(r(),T(N,{key:1,size:40,shape:"square"},{default:l(()=>[t(o,null,{default:l(()=>[t(n(ft))]),_:1})]),_:1})),s("div",Lt,[s("div",Qt,m(a.title),1),s("div",Rt,"ID: "+m(a.id),1)])])]),_:1}),t(k,{label:"像素状态",width:"100",align:"center"},{default:l(({row:a})=>[t(B,{type:a.pixel_enabled?"success":"info",size:"small"},{default:l(()=>[g(m(a.pixel_enabled?"已启用":"未启用"),1)]),_:2},1032,["type"])]),_:1}),t(k,{label:"Google Ads",width:"120",align:"center"},{default:l(({row:a})=>{var c,f;return[(f=(c=a.pixel_config)==null?void 0:c.google_ads)!=null&&f.enabled?(r(),x("div",jt,[t(o,{class:"status-icon success"},{default:l(()=>[t(n(P))]),_:1}),e[15]||(e[15]=s("span",{class:"status-text"},"已配置",-1))])):(r(),x("div",Wt,[t(o,{class:"status-icon disabled"},{default:l(()=>[t(n(U))]),_:1}),e[16]||(e[16]=s("span",{class:"status-text"},"未配置",-1))]))]}),_:1}),t(k,{label:"Facebook",width:"120",align:"center"},{default:l(({row:a})=>{var c,f;return[(f=(c=a.pixel_config)==null?void 0:c.facebook)!=null&&f.enabled?(r(),x("div",Zt,[t(o,{class:"status-icon success"},{default:l(()=>[t(n(P))]),_:1}),e[17]||(e[17]=s("span",{class:"status-text"},"已配置",-1))])):(r(),x("div",Ht,[t(o,{class:"status-icon disabled"},{default:l(()=>[t(n(U))]),_:1}),e[18]||(e[18]=s("span",{class:"status-text"},"未配置",-1))]))]}),_:1}),t(k,{label:"TikTok",width:"120",align:"center"},{default:l(({row:a})=>{var c,f;return[(f=(c=a.pixel_config)==null?void 0:c.tiktok)!=null&&f.enabled?(r(),x("div",Jt,[t(o,{class:"status-icon success"},{default:l(()=>[t(n(P))]),_:1}),e[19]||(e[19]=s("span",{class:"status-text"},"已配置",-1))])):(r(),x("div",Ot,[t(o,{class:"status-icon disabled"},{default:l(()=>[t(n(U))]),_:1}),e[20]||(e[20]=s("span",{class:"status-text"},"未配置",-1))]))]}),_:1}),t(k,{label:"自定义像素",width:"120",align:"center"},{default:l(({row:a})=>{var c,f;return[(f=(c=a.pixel_config)==null?void 0:c.custom)!=null&&f.length?(r(),T(B,{key:0,type:"warning",size:"small"},{default:l(()=>[g(m(a.pixel_config.custom.length)+" 个 ",1)]),_:2},1024)):(r(),x("span",Xt,"--"))]}),_:1}),t(k,{prop:"updated_at",label:"更新时间",width:"180","show-overflow-tooltip":""},{default:l(({row:a})=>[s("div",Yt,[t(o,{class:"time-icon"},{default:l(()=>[t(n(gt))]),_:1}),s("span",null,m(a.updated_at),1)])]),_:1}),t(k,{label:"操作",width:"200",fixed:"right",align:"center"},{default:l(({row:a})=>[s("div",te,[t(b,{size:"small",type:"primary",link:"",onClick:c=>W(a)},{default:l(()=>[t(o,null,{default:l(()=>[t(n(F))]),_:1}),e[21]||(e[21]=g(" 配置 ",-1))]),_:1},8,["onClick"]),t(b,{size:"small",type:"success",link:"",onClick:c=>Z(a)},{default:l(()=>[t(o,null,{default:l(()=>[t(n(mt))]),_:1}),e[22]||(e[22]=g(" 查看 ",-1))]),_:1},8,["onClick"]),t(b,{size:"small",type:"warning",link:"",onClick:c=>H(a)},{default:l(()=>[t(o,null,{default:l(()=>[t(n(vt))]),_:1}),e[23]||(e[23]=g(" 测试 ",-1))]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["data"])),[[nt,S.value]]),s("div",ee,[t(st,{"current-page":u.current,"onUpdate:currentPage":e[3]||(e[3]=a=>u.current=a),"page-size":u.size,"onUpdate:pageSize":e[4]||(e[4]=a=>u.size=a),"page-sizes":[10,20,50,100],total:u.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:R,onCurrentChange:j},null,8,["current-page","page-size","total"])])]),_:1}),t(ot,{modelValue:A.value,"onUpdate:modelValue":e[5]||(e[5]=a=>A.value=a),title:`像素配置 - ${(E=C.value)==null?void 0:E.title}`,width:"800px","close-on-click-modal":!1},{default:l(()=>[s("div",le,[t(at,{title:"像素配置说明",type:"info",closable:!1,"show-icon":""},{default:l(()=>[...e[24]||(e[24]=[s("p",null,"• Google Ads: 需要转化ID和转化标签",-1),s("p",null,"• Facebook: 需要像素ID",-1),s("p",null,"• TikTok: 需要像素ID",-1),s("p",null,"• 自定义: 可以添加任意像素代码",-1)])]),_:1}),s("div",se,[t(b,{type:"primary",onClick:O},{default:l(()=>[t(o,null,{default:l(()=>[t(n(F))]),_:1}),e[25]||(e[25]=g(" 打开详细配置 ",-1))]),_:1})])])]),_:1},8,["modelValue","title"])])}}}),ce=xt(oe,[["__scopeId","data-v-09592fc3"]]);export{ce as default};
