import{d as D,h as c,P as U,aE as W,aF as G,aG as H,aH as P,Z as Q,r,Q as R,c as w,o as p,b as t,w as a,F as Z,f as j,g as h,a as l,z as q,y as J,t as m,W as K,e as x,u as X,aI as ee,M as te,N as k}from"./index-DZg0S-xf.js";import"./index-BpCvQqaw.js";import{O as ae,a as oe,g as se}from"./order-ChwwM8mz.js";import{T as le}from"./index-DdAlMDxh.js";import{aU as z}from"./installCanvasRenderer-Bf4uGEF_.js";import{_ as re}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./statistics-DOFhbmJf.js";const ne={class:"order-statistics"},ie={class:"stat-content"},ce={class:"stat-info"},de={class:"stat-value"},ue={class:"stat-label"},_e={class:"chart-header"},pe={class:"table-header"},me={class:"amount"},fe=D({name:"OrderStatistics"}),ve=D({...fe,setup(ge){const v=c(!1),f=c([new Date(Date.now()-30*24*60*60*1e3).toISOString().slice(0,10),new Date().toISOString().slice(0,10)]),y=c(),b=c(),O=c(null),d=U([{key:"total",label:"总订单数",value:"0",icon:W,color:"#409EFF"},{key:"amount",label:"总销售额",value:"€0",icon:G,color:"#67C23A"},{key:"pending",label:"待处理",value:"0",icon:H,color:"#E6A23C"},{key:"completed",label:"已完成",value:"0",icon:P,color:"#67C23A"}]),S=c([]),A=e=>ae[e]||"info",F=e=>oe[e]||e,E=e=>{d[0].value=e.total_orders.toLocaleString(),d[1].value=`€${e.total_amount.toLocaleString()}`,d[2].value=e.pending_orders.toLocaleString(),d[3].value=e.completed_orders.toLocaleString()},L=e=>{const o=z(y.value),i={title:{text:"订单趋势",left:"center",textStyle:{fontSize:14,color:"#666"}},tooltip:{trigger:"axis"},legend:{data:["订单数量","销售额"],bottom:0},xAxis:{type:"category",data:e.trend_data.dates},yAxis:[{type:"value",name:"订单数",position:"left"},{type:"value",name:"销售额",position:"right"}],series:[{name:"订单数量",type:"line",data:e.trend_data.order_counts,smooth:!0,itemStyle:{color:"#409EFF"}},{name:"销售额",type:"bar",yAxisIndex:1,data:e.trend_data.amounts,itemStyle:{color:"#67C23A"}}]};o.setOption(i),window.addEventListener("resize",()=>{o.resize()})},T=e=>{const o=z(b.value),i={title:{text:"订单状态分布",left:"center",textStyle:{fontSize:14,color:"#666"}},tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},legend:{orient:"vertical",left:"left"},series:[{name:"订单状态",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"18",fontWeight:"bold"}},labelLine:{show:!1},data:e.status_distribution.map(n=>({value:n.value,name:n.name,itemStyle:{color:Y(n.status)}}))}]};o.setOption(i),window.addEventListener("resize",()=>{o.resize()})},Y=e=>({pending:"#E6A23C",confirmed:"#409EFF",processing:"#909399",shipped:"#67C23A",delivered:"#67C23A",cancelled:"#F56C6C",refunded:"#F56C6C"})[e]||"#909399",M=e=>{e&&C()},C=async()=>{v.value=!0;try{const{data:e}=await se({start_date:f.value[0],end_date:f.value[1],limit:10});O.value=e,S.value=e.recent_orders,E(e),await te(),L(e),T(e),k.success("统计数据加载成功")}catch(e){console.error("加载统计数据失败:",e),k.error("加载统计数据失败")}finally{v.value=!1}};return Q(async()=>{await C()}),(e,o)=>{const i=r("el-icon"),n=r("el-card"),u=r("el-col"),g=r("el-row"),V=r("el-date-picker"),I=r("el-button"),_=r("el-table-column"),B=r("el-tag"),N=r("el-table"),$=R("loading");return p(),w("div",ne,[t(g,{gutter:20,class:"stats-cards"},{default:a(()=>[(p(!0),w(Z,null,j(d,s=>(p(),h(u,{xs:24,sm:12,md:6,key:s.key},{default:a(()=>[t(n,{class:"stat-card",shadow:"hover"},{default:a(()=>[l("div",ie,[l("div",{class:"stat-icon",style:q({backgroundColor:s.color})},[t(i,{size:24},{default:a(()=>[(p(),h(J(s.icon)))]),_:2},1024)],4),l("div",ce,[l("div",de,m(s.value),1),l("div",ue,m(s.label),1)])])]),_:2},1024)]),_:2},1024))),128))]),_:1}),t(g,{gutter:20,class:"charts-section"},{default:a(()=>[t(u,{xs:24,lg:12},{default:a(()=>[t(n,{class:"chart-card",shadow:"never"},{header:a(()=>[l("div",_e,[o[2]||(o[2]=l("span",null,"订单趋势",-1)),t(V,{modelValue:f.value,"onUpdate:modelValue":o[0]||(o[0]=s=>f.value=s),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",onChange:M,size:"small"},null,8,["modelValue"])])]),default:a(()=>[l("div",{ref_key:"orderTrendChart",ref:y,class:"chart-container"},null,512)]),_:1})]),_:1}),t(u,{xs:24,lg:12},{default:a(()=>[t(n,{class:"chart-card",shadow:"never"},{header:a(()=>[...o[3]||(o[3]=[l("span",null,"订单状态分布",-1)])]),default:a(()=>[l("div",{ref_key:"orderStatusChart",ref:b,class:"chart-container"},null,512)]),_:1})]),_:1})]),_:1}),t(g,{gutter:20,class:"bottom-section"},{default:a(()=>[t(u,{xs:24,lg:12},{default:a(()=>[t(n,{class:"table-card",shadow:"never"},{header:a(()=>[l("div",pe,[o[5]||(o[5]=l("span",null,"最近订单",-1)),t(I,{type:"primary",size:"small",onClick:o[1]||(o[1]=s=>e.$router.push("/order/list"))},{default:a(()=>[o[4]||(o[4]=x(" 查看全部 ",-1)),t(i,{class:"el-icon--right"},{default:a(()=>[t(X(ee))]),_:1})]),_:1})])]),default:a(()=>[K((p(),h(N,{data:S.value,stripe:""},{default:a(()=>[t(_,{prop:"order_number",label:"订单号",width:"180"}),t(_,{prop:"customer_name",label:"客户",width:"120"}),t(_,{prop:"total_amount",label:"金额",width:"100",align:"center"},{default:a(({row:s})=>[l("span",me,m(s.total_amount)+" "+m(s.currency),1)]),_:1}),t(_,{prop:"status",label:"状态",width:"100",align:"center"},{default:a(({row:s})=>[t(B,{type:A(s.status),size:"small"},{default:a(()=>[x(m(F(s.status)),1)]),_:2},1032,["type"])]),_:1}),t(_,{prop:"created_at",label:"下单时间","show-overflow-tooltip":""})]),_:1},8,["data"])),[[$,v.value]])]),_:1})]),_:1}),t(u,{xs:24,lg:12},{default:a(()=>[t(le)]),_:1})]),_:1})])}}}),ke=re(ve,[["__scopeId","data-v-0900d934"]]);export{ke as default};
