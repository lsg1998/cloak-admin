import{a5 as Q,d as pe,h as c,P as fe,Z as ve,r as u,Q as ge,c as _,o as i,a as n,b as e,w as a,t as d,_ as he,u as h,x as G,e as m,E as ye,W as R,g as w,R as H,n as be,at as J,au as we,J as ke,F as De,f as Ve,av as ze,N as T}from"./index-CsAqytoE.js";import{_ as Ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";const xe=(k={})=>{const S=Object.fromEntries(Object.entries(k).filter(([,y])=>y!=null&&y!==""));return Q.get("/admin/em-track/list",S)},Z=k=>Q.get("/admin/em-track/orders",k),Ee={class:"em-track-management"},Se={class:"summary-cards"},Le={class:"summary-item"},Pe={class:"summary-value"},Ue={class:"summary-item"},Ie={class:"summary-value"},Me={class:"summary-item"},Fe={class:"summary-value"},Ne={class:"summary-item"},Re={class:"summary-value"},Te={class:"summary-item"},Be={class:"summary-value"},Oe={class:"summary-item"},Ye={class:"summary-value"},Ke={class:"em-param-cell"},$e={key:0,class:"account-name"},je={class:"count-badge visitor"},Ae={key:0,class:"count-badge order"},Ge={key:1,class:"count-badge zero"},He={key:0,class:"countries-cell"},Je={key:1,class:"no-data"},Ze={key:0,class:"time-text"},Qe={key:1,class:"no-data"},We={class:"pagination-wrapper"},qe={class:"dialog-table-wrapper"},Xe={class:"dialog-table-wrapper"},et=pe({__name:"index",setup(k){const S=[{text:"ä»Šå¤©",value:()=>{const l=new Date;return[l,l]}},{text:"æ˜¨å¤©",value:()=>{const l=new Date;return l.setDate(l.getDate()-1),[l,l]}},{text:"æœ€è¿‘3å¤©",value:()=>{const l=new Date,t=new Date;return t.setDate(t.getDate()-2),[t,l]}},{text:"æœ€è¿‘7å¤©",value:()=>{const l=new Date,t=new Date;return t.setDate(t.getDate()-6),[t,l]}},{text:"æœ¬æœˆ",value:()=>{const l=new Date;return[new Date(l.getFullYear(),l.getMonth(),1),l]}}],y=c(!1),B=c([]),O=c(0),f=c({total_em_params:0,em_with_orders:0,em_without_orders:0,total_orders:0,total_visitors:0,order_rate:0}),p=new Date().toISOString().slice(0,10),L=c([p,p]),o=fe({start_date:p,end_date:p,em_param:"",has_order:"",page:1,size:50}),P=c(!1),U=c(!1),D=c(""),Y=c([]),I=c(!1),M=c(!1),K=c([]),W=l=>{l&&l.length===2?(o.start_date=l[0],o.end_date=l[1]):(o.start_date=p,o.end_date=p),o.page=1,z()},V=()=>{o.page=1,z()},q=()=>{L.value=[p,p],o.start_date=p,o.end_date=p,o.em_param="",o.has_order="",o.page=1,o.size=50,z()},X=()=>{},z=async()=>{y.value=!0;try{const l=await xe(o);l.data&&(B.value=l.data.list||[],O.value=l.data.total||0,f.value=l.data.summary||f.value)}catch(l){T.error(l.message||"è·å–æ•°æ®å¤±è´¥")}finally{y.value=!1}},ee=async l=>{D.value=l.em_param,P.value=!0,U.value=!0;try{const t=await Z({em_param:l.em_param,start_date:o.start_date,end_date:o.end_date});t.data&&(Y.value=t.data.orders||[])}catch{T.error("è·å–è®¢å•è¯¦æƒ…å¤±è´¥")}finally{U.value=!1}},te=async l=>{D.value=l.em_param,I.value=!0,M.value=!0;try{const t=await Z({em_param:l.em_param,start_date:o.start_date,end_date:o.end_date});t.data&&(K.value=t.data.visitors||[])}catch{T.error("è·å–è®¿å®¢åˆ—è¡¨å¤±è´¥")}finally{M.value=!1}},ae=({row:l})=>l.has_order?"row-has-order":"row-no-order",se={pending:"å¾…ç¡®è®¤",confirmed:"å·²ç¡®è®¤",processing:"å¤„ç†ä¸­",shipped:"å·²å‘è´§",delivered:"å·²é€è¾¾",cancelled:"å·²å–æ¶ˆ",refunded:"å·²é€€æ¬¾",deleted:"å·²åˆ é™¤",duplicate:"å·²é‡å¤"},le={pending:"warning",confirmed:"primary",processing:"info",shipped:"success",delivered:"success",cancelled:"danger",refunded:"danger",deleted:"info",duplicate:"warning"},oe=l=>se[l]||l,re=l=>le[l]||"info",ne={JP:"ğŸ‡¯ğŸ‡µ",HU:"ğŸ‡­ğŸ‡º",SK:"ğŸ‡¸ğŸ‡°",CZ:"ğŸ‡¨ğŸ‡¿",AT:"ğŸ‡¦ğŸ‡¹",PL:"ğŸ‡µğŸ‡±",ES:"ğŸ‡ªğŸ‡¸",IT:"ğŸ‡®ğŸ‡¹",PT:"ğŸ‡µğŸ‡¹",DE:"ğŸ‡©ğŸ‡ª",FR:"ğŸ‡«ğŸ‡·",HR:"ğŸ‡­ğŸ‡·",SI:"ğŸ‡¸ğŸ‡®",LT:"ğŸ‡±ğŸ‡¹",LV:"ğŸ‡±ğŸ‡»",US:"ğŸ‡ºğŸ‡¸",GB:"ğŸ‡¬ğŸ‡§",CN:"ğŸ‡¨ğŸ‡³",RO:"ğŸ‡·ğŸ‡´",BG:"ğŸ‡§ğŸ‡¬",GR:"ğŸ‡¬ğŸ‡·",NL:"ğŸ‡³ğŸ‡±",BE:"ğŸ‡§ğŸ‡ª",SE:"ğŸ‡¸ğŸ‡ª",DK:"ğŸ‡©ğŸ‡°",FI:"ğŸ‡«ğŸ‡®",IE:"ğŸ‡®ğŸ‡ª",EE:"ğŸ‡ªğŸ‡ª"},$=l=>l&&ne[l.toUpperCase()]||"ğŸŒ";return ve(()=>{z()}),(l,t)=>{const v=u("el-card"),de=u("el-date-picker"),C=u("el-form-item"),g=u("el-icon"),ie=u("el-input"),j=u("el-option"),ue=u("el-select"),x=u("el-button"),ce=u("el-form"),r=u("el-table-column"),b=u("el-tag"),F=u("el-table"),me=u("el-pagination"),A=u("el-dialog"),N=ge("loading");return i(),_("div",Ee,[n("div",Se,[e(v,{class:"summary-card",shadow:"hover"},{default:a(()=>[n("div",Le,[n("div",Pe,d(f.value.total_em_params),1),t[7]||(t[7]=n("div",{class:"summary-label"},"EMè´¦å·æ€»æ•°",-1))])]),_:1}),e(v,{class:"summary-card success",shadow:"hover"},{default:a(()=>[n("div",Ue,[n("div",Ie,d(f.value.em_with_orders),1),t[8]||(t[8]=n("div",{class:"summary-label"},"æœ‰è®¢å•",-1))])]),_:1}),e(v,{class:"summary-card danger",shadow:"hover"},{default:a(()=>[n("div",Me,[n("div",Fe,d(f.value.em_without_orders),1),t[9]||(t[9]=n("div",{class:"summary-label"},"æ— è®¢å•",-1))])]),_:1}),e(v,{class:"summary-card primary",shadow:"hover"},{default:a(()=>[n("div",Ne,[n("div",Re,d(f.value.total_orders),1),t[10]||(t[10]=n("div",{class:"summary-label"},"æ€»è®¢å•æ•°",-1))])]),_:1}),e(v,{class:"summary-card info",shadow:"hover"},{default:a(()=>[n("div",Te,[n("div",Be,d(f.value.total_visitors),1),t[11]||(t[11]=n("div",{class:"summary-label"},"æ€»è®¿å®¢æ•°",-1))])]),_:1}),e(v,{class:"summary-card warning",shadow:"hover"},{default:a(()=>[n("div",Oe,[n("div",Ye,d(f.value.order_rate)+"%",1),t[12]||(t[12]=n("div",{class:"summary-label"},"å‡ºå•ç‡",-1))])]),_:1})]),e(v,{class:"search-card",shadow:"never"},{default:a(()=>[e(ce,{model:o,inline:"",class:"search-form"},{default:a(()=>[e(C,{label:"æ—¥æœŸèŒƒå›´"},{default:a(()=>[e(de,{modelValue:L.value,"onUpdate:modelValue":t[0]||(t[0]=s=>L.value=s),type:"daterange","range-separator":"è‡³","start-placeholder":"å¼€å§‹æ—¥æœŸ","end-placeholder":"ç»“æŸæ—¥æœŸ","value-format":"YYYY-MM-DD",shortcuts:S,style:{width:"280px"},onChange:W},null,8,["modelValue"])]),_:1}),e(C,{label:"EMå‚æ•°"},{default:a(()=>[e(ie,{modelValue:o.em_param,"onUpdate:modelValue":t[1]||(t[1]=s=>o.em_param=s),placeholder:"æœç´¢EMå‚æ•°",clearable:"",style:{width:"200px"},onKeyup:he(V,["enter"])},{prefix:a(()=>[e(g,null,{default:a(()=>[e(h(G))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(C,{label:"å‡ºå•çŠ¶æ€"},{default:a(()=>[e(ue,{modelValue:o.has_order,"onUpdate:modelValue":t[2]||(t[2]=s=>o.has_order=s),placeholder:"å…¨éƒ¨",clearable:"",style:{width:"130px"}},{default:a(()=>[e(j,{label:"æœ‰è®¢å•",value:"yes"}),e(j,{label:"æ— è®¢å•",value:"no"})]),_:1},8,["modelValue"])]),_:1}),e(C,null,{default:a(()=>[e(x,{type:"primary",onClick:V},{default:a(()=>[e(g,null,{default:a(()=>[e(h(G))]),_:1}),t[13]||(t[13]=m(" æŸ¥è¯¢ ",-1))]),_:1}),e(x,{onClick:q},{default:a(()=>[e(g,null,{default:a(()=>[e(h(ye))]),_:1}),t[14]||(t[14]=m(" é‡ç½® ",-1))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(v,{shadow:"never",class:"table-card"},{default:a(()=>[R((i(),w(F,{data:B.value,border:"",stripe:"",style:{width:"100%"},"row-class-name":ae,onSortChange:X},{default:a(()=>[e(r,{type:"index",label:"#",width:"50",align:"center"}),e(r,{label:"EMå‚æ•°(è´¦å·)","min-width":"220",align:"center"},{default:a(({row:s})=>[n("div",Ke,[e(b,{class:be(s.has_order?"em-tag-success":"em-tag-danger"),effect:s.has_order?"dark":"light",size:"default"},{default:a(()=>[e(g,null,{default:a(()=>[e(h(J))]),_:1}),m(" "+d(s.em_param),1)]),_:2},1032,["class","effect"]),s.account_name?(i(),_("div",$e,[e(b,{size:"small",type:"warning",effect:"plain"},{default:a(()=>[m(d(s.account_name),1)]),_:2},1024)])):H("",!0)])]),_:1}),e(r,{label:"å‡ºå•çŠ¶æ€",width:"110",align:"center",sortable:"custom",prop:"has_order"},{default:a(({row:s})=>[s.has_order?(i(),w(b,{key:0,type:"success",effect:"dark",size:"default"},{default:a(()=>[e(g,null,{default:a(()=>[e(h(we))]),_:1}),t[15]||(t[15]=m(" æœ‰è®¢å• ",-1))]),_:1})):(i(),w(b,{key:1,type:"danger",effect:"plain",size:"default"},{default:a(()=>[e(g,null,{default:a(()=>[e(h(ke))]),_:1}),t[16]||(t[16]=m(" æ— è®¢å• ",-1))]),_:1}))]),_:1}),e(r,{label:"è®¿å®¢æ•°",width:"100",align:"center",sortable:"custom",prop:"visitor_count"},{default:a(({row:s})=>[n("span",je,d(s.visitor_count),1)]),_:1}),e(r,{label:"è®¢å•æ•°",width:"100",align:"center",sortable:"custom",prop:"order_count"},{default:a(({row:s})=>[s.order_count>0?(i(),_("span",Ae,d(s.order_count),1)):(i(),_("span",Ge,"0"))]),_:1}),e(r,{label:"è®¿å®¢å›½å®¶",width:"140",align:"center"},{default:a(({row:s})=>[s.countries&&s.countries.length>0?(i(),_("div",He,[(i(!0),_(De,null,Ve(s.countries.slice(0,5),(E,_e)=>(i(),w(b,{key:_e,size:"small",type:"success",effect:"plain",style:{margin:"1px"}},{default:a(()=>[m(d($(E))+" "+d(E),1)]),_:2},1024))),128))])):(i(),_("span",Je,"--"))]),_:1}),e(r,{label:"æœ€æ–°è®¿é—®",width:"170",align:"center",sortable:"custom",prop:"latest_visit"},{default:a(({row:s})=>[s.latest_visit?(i(),_("span",Ze,d(s.latest_visit),1)):(i(),_("span",Qe,"--"))]),_:1}),e(r,{label:"æ“ä½œ",width:"120",fixed:"right",align:"center"},{default:a(({row:s})=>[s.has_order?(i(),w(x,{key:0,type:"primary",size:"small",link:"",onClick:E=>ee(s)},{default:a(()=>[e(g,null,{default:a(()=>[e(h(ze))]),_:1}),t[17]||(t[17]=m(" æŸ¥çœ‹è®¢å• ",-1))]),_:1},8,["onClick"])):H("",!0),e(x,{type:"info",size:"small",link:"",onClick:E=>te(s)},{default:a(()=>[e(g,null,{default:a(()=>[e(h(J))]),_:1}),t[18]||(t[18]=m(" è®¿å®¢ ",-1))]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[N,y.value]]),n("div",We,[e(me,{"current-page":o.page,"onUpdate:currentPage":t[3]||(t[3]=s=>o.page=s),"page-size":o.size,"onUpdate:pageSize":t[4]||(t[4]=s=>o.size=s),"page-sizes":[20,50,100,200],total:O.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:V,onCurrentChange:V},null,8,["current-page","page-size","total"])])]),_:1}),e(A,{modelValue:P.value,"onUpdate:modelValue":t[5]||(t[5]=s=>P.value=s),title:`${D.value} - è®¢å•è¯¦æƒ…`,width:"90%",top:"5vh"},{default:a(()=>[R((i(),_("div",qe,[e(F,{data:Y.value,border:"",stripe:"",size:"small",style:{width:"100%"}},{default:a(()=>[e(r,{prop:"order_number",label:"è®¢å•å·","min-width":"150"}),e(r,{prop:"customer_name",label:"å®¢æˆ·å§“å","min-width":"100"}),e(r,{prop:"phone",label:"ç”µè¯","min-width":"130"}),e(r,{label:"é‡‘é¢","min-width":"110",align:"center"},{default:a(({row:s})=>[m(d(s.total_amount)+" "+d(s.currency),1)]),_:1}),e(r,{label:"çŠ¶æ€","min-width":"90",align:"center"},{default:a(({row:s})=>[e(b,{type:re(s.status),size:"small"},{default:a(()=>[m(d(oe(s.status)),1)]),_:2},1032,["type"])]),_:1}),e(r,{prop:"product_title",label:"å•†å“","min-width":"160","show-overflow-tooltip":""}),e(r,{prop:"ip_address",label:"IP","min-width":"130"}),e(r,{prop:"created_at",label:"ä¸‹å•æ—¶é—´","min-width":"160"})]),_:1},8,["data"])])),[[N,U.value]])]),_:1},8,["modelValue","title"]),e(A,{modelValue:I.value,"onUpdate:modelValue":t[6]||(t[6]=s=>I.value=s),title:`${D.value} - è®¿å®¢åˆ—è¡¨`,width:"90%",top:"5vh"},{default:a(()=>[R((i(),_("div",Xe,[e(F,{data:K.value,border:"",stripe:"",size:"small",style:{width:"100%"}},{default:a(()=>[e(r,{prop:"ip_address",label:"IPåœ°å€","min-width":"130"}),e(r,{label:"å›½å®¶/åœ°åŒº","min-width":"100"},{default:a(({row:s})=>[m(d($(s.country))+" "+d(s.country),1)]),_:1}),e(r,{prop:"region",label:"åœ°åŒº","min-width":"110"}),e(r,{prop:"city",label:"åŸå¸‚","min-width":"110"}),e(r,{prop:"organization",label:"ISP","min-width":"180","show-overflow-tooltip":""}),e(r,{prop:"visit_count",label:"è®¿é—®æ¬¡æ•°","min-width":"80",align:"center"}),e(r,{prop:"first_visit",label:"é¦–æ¬¡è®¿é—®","min-width":"160"}),e(r,{prop:"last_visit",label:"æœ€åè®¿é—®","min-width":"160"})]),_:1},8,["data"])])),[[N,M.value]])]),_:1},8,["modelValue","title"])])}}}),st=Ce(et,[["__scopeId","data-v-fe0723e7"]]);export{st as default};
