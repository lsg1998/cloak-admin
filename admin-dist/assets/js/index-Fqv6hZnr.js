import{d as A,h as m,ad as E,a8 as y,r,c as V,o as C,R as F,a as N,b as o,t as T,w as s,e as b,z as O,u as P,ae as I,a7 as K,M as U}from"./index-7hDRB9w9.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";const G={class:"card filter"},H={key:0,class:"title sle"},J={class:"search"},L={class:"el-tree-node__label"},Q=A({name:"TreeFilter"}),W=A({...Q,props:{requestApi:{},data:{},title:{},id:{default:"id"},label:{default:"label"},multiple:{type:Boolean,default:!1},defaultValue:{}},emits:["change"],setup(a,{expose:B,emit:M}){const t=a,S={children:"children",label:t.label},i=m(),p=m([]),h=m([]),k=m(),g=()=>{t.multiple?k.value=Array.isArray(t.defaultValue)?t.defaultValue:[t.defaultValue]:k.value=typeof t.defaultValue=="string"?t.defaultValue:""};E(async()=>{if(g(),t.requestApi){const{data:e}=await t.requestApi();p.value=e,h.value=[{id:"",[t.label]:"全部"},...e]}}),y(()=>t.defaultValue,()=>U(()=>g()),{deep:!0,immediate:!0}),y(()=>t.data,()=>{var e;(e=t.data)!=null&&e.length&&(p.value=t.data,h.value=[{id:"",[t.label]:"全部"},...t.data])},{deep:!0,immediate:!0});const v=m("");y(v,e=>{i.value.filter(e)});const q=(e,l,n)=>{if(!e)return!0;let d=n.parent,u=[n.label],f=1;for(;f<n.level;)u=[...u,d.label],d=d.parent,f++;return u.some(_=>_.indexOf(e)!==-1)},w=e=>{var n;let l=(n=i.value)==null?void 0:n.store.nodesMap;if(l)for(const d in l)l.hasOwnProperty(d)&&(l[d].expanded=e)},x=M,z=e=>{t.multiple||x("change",e[t.id])},D=()=>{var e;x("change",(e=i.value)==null?void 0:e.getCheckedKeys())};return B({treeData:p,treeAllData:h,treeRef:i}),(e,l)=>{const n=r("el-input"),d=r("More"),u=r("el-icon"),f=r("el-dropdown-item"),_=r("el-dropdown-menu"),R=r("el-dropdown"),$=r("el-scrollbar");return C(),V("div",G,[a.title?(C(),V("h4",H,T(a.title),1)):F("",!0),N("div",J,[o(n,{modelValue:v.value,"onUpdate:modelValue":l[0]||(l[0]=c=>v.value=c),placeholder:"输入关键字进行过滤",clearable:""},null,8,["modelValue"]),o(R,{trigger:"click"},{dropdown:s(()=>[o(_,null,{default:s(()=>[o(f,{onClick:l[1]||(l[1]=c=>w(!0))},{default:s(()=>[...l[3]||(l[3]=[b("展开全部",-1)])]),_:1}),o(f,{onClick:l[2]||(l[2]=c=>w(!1))},{default:s(()=>[...l[4]||(l[4]=[b("折叠全部",-1)])]),_:1})]),_:1})]),default:s(()=>[o(u,{size:"20"},{default:s(()=>[o(d)]),_:1})]),_:1})]),o($,{style:O({height:a.title?"calc(100% - 95px)":"calc(100% - 56px)"})},{default:s(()=>[o(P(I),{ref_key:"treeRef",ref:i,"default-expand-all":"","node-key":a.id,data:a.multiple?p.value:h.value,"show-checkbox":a.multiple,"check-strictly":!1,"current-node-key":a.multiple?"":k.value,"highlight-current":!a.multiple,"expand-on-click-node":!1,"check-on-click-node":a.multiple,props:S,"filter-node-method":q,"default-checked-keys":a.multiple?k.value:[],onNodeClick:z,onCheck:D},{default:s(c=>[N("span",L,[K(e.$slots,"default",{row:c},()=>[b(T(c.node.label),1)],!0)])]),_:3},8,["node-key","data","show-checkbox","current-node-key","highlight-current","check-on-click-node","default-checked-keys"])]),_:3},8,["style"])])}}}),Z=j(W,[["__scopeId","data-v-c47061e2"]]);export{Z as T};
