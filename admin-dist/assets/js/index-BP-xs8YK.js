import{d as E,P as I,h as S,Z as U,r as d,Q as L,c as A,o as _,a as s,b as t,w as e,e as b,u as m,x as Q,E as T,ay as W,t as n,az as Z,aR as G,bj as D,W as H,g as h,N as J}from"./index-Dfv0S-Oo.js";import{a as K}from"./statistics-Dpt_Utp-.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";const X={class:"conversion-statistics-page"},Y={class:"overview-stats"},$={class:"stat-content"},tt={class:"stat-icon visitors"},et={class:"stat-info"},st={class:"stat-number"},at={class:"stat-content"},lt={class:"stat-icon orders"},ot={class:"stat-info"},nt={class:"stat-number"},dt={class:"stat-sub"},it={class:"stat-content"},ct={class:"stat-icon rate"},rt={class:"stat-info"},_t={class:"stat-number"},ut={class:"stat-content"},vt={class:"stat-icon products"},mt={class:"stat-info"},ft={class:"stat-number"},pt={key:3},ht={class:"product-cell"},gt=["src"],bt={class:"product-info"},yt={class:"product-title"},wt={class:"product-id"},Ct={class:"visitor-count"},kt={class:"order-count"},zt={class:"rate-cell"},Vt={class:"rate-text"},xt=E({name:"ConversionStatisticsPage"}),Rt=E({...xt,setup(St){const r=I({timeRange:"today",timezone:"Asia/Shanghai"}),y=S(!1),u=S(null),w=i=>i?i.toLocaleString():"0",N=i=>i>=10?"#67C23A":i>=5?"#E6A23C":"#F56C6C",g=async()=>{y.value=!0;try{const i=await K({timeRange:r.timeRange,timezone:r.timezone});i.code===200&&(u.value=i.data)}catch(i){console.error("加载转化统计数据失败:",i),J.error("加载转化统计数据失败")}finally{y.value=!1}},B=()=>{r.timeRange="today",r.timezone="Asia/Shanghai",g()};return U(()=>{g()}),(i,l)=>{const c=d("el-option"),V=d("el-select"),k=d("el-form-item"),v=d("el-icon"),x=d("el-button"),P=d("el-form"),f=d("el-card"),C=d("el-col"),M=d("el-row"),z=d("el-tag"),p=d("el-table-column"),R=d("el-avatar"),j=d("el-progress"),q=d("el-table"),F=L("loading");return _(),A("div",X,[l[9]||(l[9]=s("div",{class:"page-header"},[s("h2",null,"转化统计"),s("p",null,"分析各商品的访问量和下单转化情况（已排除重复单和取消单）")],-1)),t(f,{class:"filter-card",shadow:"never"},{default:e(()=>[t(P,{model:r,inline:"",class:"filter-form"},{default:e(()=>[t(k,{label:"时间段"},{default:e(()=>[t(V,{modelValue:r.timeRange,"onUpdate:modelValue":l[0]||(l[0]=o=>r.timeRange=o),placeholder:"请选择时间段",onChange:g,style:{width:"180px"}},{default:e(()=>[t(c,{label:"今天",value:"today"}),t(c,{label:"昨天",value:"yesterday"}),t(c,{label:"最近3天",value:"3d"}),t(c,{label:"最近7天",value:"7d"}),t(c,{label:"最近30天",value:"30d"}),t(c,{label:"最近半年",value:"6m"}),t(c,{label:"最近一年",value:"1y"}),t(c,{label:"全部",value:"all"})]),_:1},8,["modelValue"])]),_:1}),t(k,{label:"时区"},{default:e(()=>[t(V,{modelValue:r.timezone,"onUpdate:modelValue":l[1]||(l[1]=o=>r.timezone=o),onChange:g,style:{width:"140px"}},{default:e(()=>[t(c,{label:"北京时间",value:"Asia/Shanghai"}),t(c,{label:"欧洲时间",value:"Europe/Paris"})]),_:1},8,["modelValue"])]),_:1}),t(k,null,{default:e(()=>[t(x,{type:"primary",onClick:g,loading:y.value},{default:e(()=>[t(v,null,{default:e(()=>[t(m(Q))]),_:1}),l[2]||(l[2]=b(" 查询 ",-1))]),_:1},8,["loading"]),t(x,{onClick:B},{default:e(()=>[t(v,null,{default:e(()=>[t(m(T))]),_:1}),l[3]||(l[3]=b(" 重置 ",-1))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),s("div",Y,[t(M,{gutter:20},{default:e(()=>[t(C,{xs:24,sm:12,md:6},{default:e(()=>[t(f,{class:"stat-card",shadow:"hover"},{default:e(()=>{var o;return[s("div",$,[s("div",tt,[t(v,null,{default:e(()=>[t(m(W))]),_:1})]),s("div",et,[s("div",st,n(w(((o=u.value)==null?void 0:o.total_visitors)||0)),1),l[4]||(l[4]=s("div",{class:"stat-label"},"总访客数",-1))])])]}),_:1})]),_:1}),t(C,{xs:24,sm:12,md:6},{default:e(()=>[t(f,{class:"stat-card",shadow:"hover"},{default:e(()=>{var o,a;return[s("div",at,[s("div",lt,[t(v,null,{default:e(()=>[t(m(Z))]),_:1})]),s("div",ot,[s("div",nt,n(w(((o=u.value)==null?void 0:o.total_order_users)||0)),1),l[5]||(l[5]=s("div",{class:"stat-label"},"下单用户数",-1)),s("div",dt,"总订单: "+n(((a=u.value)==null?void 0:a.total_orders)||0),1)])])]}),_:1})]),_:1}),t(C,{xs:24,sm:12,md:6},{default:e(()=>[t(f,{class:"stat-card",shadow:"hover"},{default:e(()=>{var o;return[s("div",it,[s("div",ct,[t(v,null,{default:e(()=>[t(m(G))]),_:1})]),s("div",rt,[s("div",_t,n(((o=u.value)==null?void 0:o.overall_conversion_rate)||0)+"%",1),l[6]||(l[6]=s("div",{class:"stat-label"},"总体转化率",-1))])])]}),_:1})]),_:1}),t(C,{xs:24,sm:12,md:6},{default:e(()=>[t(f,{class:"stat-card",shadow:"hover"},{default:e(()=>{var o;return[s("div",ut,[s("div",vt,[t(v,null,{default:e(()=>[t(m(D))]),_:1})]),s("div",mt,[s("div",ft,n(((o=u.value)==null?void 0:o.product_count)||0),1),l[7]||(l[7]=s("div",{class:"stat-label"},"在售商品数",-1))])])]}),_:1})]),_:1})]),_:1})]),t(f,{class:"table-card",shadow:"never"},{header:e(()=>[...l[8]||(l[8]=[s("div",{class:"card-header"},[s("span",{class:"card-title"},"商品转化详情")],-1)])]),default:e(()=>{var o;return[H((_(),h(q,{data:((o=u.value)==null?void 0:o.conversion_data)||[],border:""},{default:e(()=>[t(p,{label:"排名",width:"70",align:"center"},{default:e(({$index:a})=>[a===0?(_(),h(z,{key:0,type:"danger",size:"small"},{default:e(()=>[b(n(a+1),1)]),_:2},1024)):a===1?(_(),h(z,{key:1,type:"warning",size:"small"},{default:e(()=>[b(n(a+1),1)]),_:2},1024)):a===2?(_(),h(z,{key:2,type:"success",size:"small"},{default:e(()=>[b(n(a+1),1)]),_:2},1024)):(_(),A("span",pt,n(a+1),1))]),_:1}),t(p,{label:"商品","min-width":"250"},{default:e(({row:a})=>[s("div",ht,[a.product_image?(_(),h(R,{key:0,size:50,shape:"square"},{default:e(()=>[s("img",{src:a.product_image,style:{width:"100%",height:"100%","object-fit":"cover"}},null,8,gt)]),_:2},1024)):(_(),h(R,{key:1,size:50,shape:"square"},{default:e(()=>[t(v,null,{default:e(()=>[t(m(D))]),_:1})]),_:1})),s("div",bt,[s("div",yt,n(a.product_title),1),s("div",wt,"ID: "+n(a.product_id),1)])])]),_:1}),t(p,{label:"访问人数",width:"120",align:"center"},{default:e(({row:a})=>[s("span",Ct,n(w(a.visitor_count)),1)]),_:1}),t(p,{label:"下单人数",width:"120",align:"center"},{default:e(({row:a})=>[s("span",kt,n(w(a.order_count)),1)]),_:1}),t(p,{label:"订单数",width:"100",align:"center"},{default:e(({row:a})=>[s("span",null,n(a.total_orders),1)]),_:1}),t(p,{label:"转化率",width:"180"},{default:e(({row:a})=>[s("div",zt,[t(j,{percentage:Math.min(a.conversion_rate,100),"stroke-width":12,color:N(a.conversion_rate)},null,8,["percentage","color"]),s("span",Vt,n(a.conversion_rate)+"%",1)])]),_:1})]),_:1},8,["data"])),[[F,y.value]])]}),_:1})])}}}),Nt=O(Rt,[["__scopeId","data-v-7cb735c8"]]);export{Nt as default};
