import{a5 as B,d as Ne,h as C,P as te,Z as Re,r as y,Q as Oe,c as r,o as i,b as l,a as t,w as s,_ as Ee,g as p,q as ve,u as h,aK as Fe,x as me,e as d,t as o,aU as Ke,aO as $e,bn as je,aN as se,bo as Ge,bp as We,F as le,f as ae,W as ie,E as qe,n as Qe,R as k,N as U}from"./index-D2NYu8kz.js";import{g as He}from"./product-z3uSuQwn.js";import{_ as Je}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ne={getVisitorIps:x=>B.get("/admin/statistics/visitor-ips",x),getVisitorIp:x=>B.get(`/admin/statistics/visitor-ips/${x}`),getIpStatistics:x=>B.get("/admin/statistics/visitor-ips-stats",x),deleteVisitorIp:x=>B.delete(`/admin/statistics/visitor-ips/${x}`),syncBehaviorData:()=>B.post("/admin/statistics/sync-behavior-data")},Xe={class:"visitor-ip-list"},Ye={class:"statistics-title"},Ze={class:"stat-content"},we={class:"stat-value"},et={class:"stat-icon"},tt={class:"stat-content"},st={class:"stat-value"},lt={class:"stat-icon"},at={class:"stat-content"},it={class:"stat-value"},nt={class:"stat-icon"},ot={class:"stat-content"},dt={class:"stat-value"},ut={class:"stat-icon"},rt={class:"stat-content"},ct={class:"stat-value"},pt={class:"stat-icon"},_t={class:"stat-content"},ft={class:"stat-value"},yt={class:"stat-icon"},vt={class:"source-stats-list"},mt={class:"source-name"},gt={class:"source-count"},bt={class:"count-value"},kt={class:"table-header"},zt={class:"table-actions"},ht={class:"ip-list"},Ct={class:"ip-header"},It={class:"ip-address"},xt={class:"ip-actions"},Vt={class:"ip-content"},Tt={class:"ip-section"},Pt={class:"address-info"},St={class:"address-line"},At={class:"value"},Lt={class:"address-line"},Dt={class:"value"},Bt={class:"address-line"},Ut={class:"value"},Mt={key:0,class:"address-line"},Nt={class:"value"},Rt={key:1,class:"address-line"},Ot={class:"value"},Et={key:2,class:"address-line"},Ft={class:"value"},Kt={key:3,class:"address-line"},$t={class:"value"},jt={key:4,class:"address-line"},Gt={class:"value"},Wt={class:"address-line"},qt={class:"value"},Qt={class:"address-line"},Ht={class:"value"},Jt={class:"address-line"},Xt={class:"ip-section"},Yt={class:"organization-info"},Zt={class:"org-line"},wt=["title"],es={class:"org-line"},ts={class:"value"},ss={class:"org-line"},ls=["title"],as={class:"org-line"},is={class:"value"},ns={class:"org-line"},os={class:"value"},ds={key:1},us={key:0,class:"org-line"},rs=["title"],cs={class:"org-tags"},ps={class:"ip-section"},_s={class:"basic-type"},fs={class:"type-line"},ys={class:"type-line"},vs={class:"value"},ms={class:"type-line"},gs={class:"value"},bs={class:"type-line"},ks={key:1,class:"value"},zs={class:"type-line"},hs={key:1,class:"value"},Cs={class:"type-line"},Is=["title"],xs={class:"type-line"},Vs=["title"],Ts={class:"type-line"},Ps=["title"],Ss={class:"ip-section"},As={class:"ip-features"},Ls={class:"feature-list"},Ds={class:"feature-item"},Bs={class:"feature-item"},Us={class:"feature-item"},Ms={class:"feature-item"},Ns={class:"feature-item"},Rs={key:0,class:"ip-section"},Os={class:"detailed-type"},Es={class:"type-line"},Fs={class:"type-line"},Ks={class:"value"},$s={class:"type-line"},js={class:"value"},Gs={class:"pagination-wrapper"},Ws={class:"product-select-dialog"},qs={key:0,class:"ip-detail"},Qs={class:"detail-section"},Hs={key:0},Js={key:1,class:"text-gray-400"},Xs={key:1,class:"text-gray-400"},Ys={class:"detail-section"},Zs={key:0},ws={key:1,class:"text-gray-400"},el={key:0},tl={key:1,class:"text-gray-400"},sl={key:0},ll={key:1},al={key:2,class:"text-gray-400"},il={key:0},nl={key:1,class:"text-gray-400"},ol={key:0},dl={key:1,class:"text-gray-400"},ul={key:0},rl={key:1,class:"text-gray-400"},cl={key:0},pl={key:1},_l={key:2,class:"text-gray-400"},fl={class:"detail-section"},yl={key:0},vl={key:1,class:"text-gray-400"},ml={key:1,class:"text-gray-400"},gl={key:0},bl={key:1},kl={key:2,class:"text-gray-400"},zl={key:0},hl={key:1,class:"text-gray-400"},Cl={class:"detail-section"},Il={class:"detail-section"},xl={key:0,class:"referer-info"},Vl={key:1,class:"text-gray-400"},Tl={key:0,class:"referer-info"},Pl={key:1,class:"text-gray-400"},Sl={class:"timeline-container"},Al={key:0,class:"timeline-content"},Ll={class:"timeline-header"},Dl={class:"timeline-list"},Bl={class:"timeline-item-content"},Ul={class:"action-description"},Ml={class:"action-text"},Nl={key:0,class:"action-detail"},Rl=Ne({__name:"index",setup(x){const j=C(!1),G=C(!1),u=C(null),m=te({ip:"",timeRange:"today",visitorType:"",productId:""}),M=C(!1),W=C(!1),q=C([]),N=C([]),R=C(""),A=C(""),V=te({page:1,size:20,total:0}),z=te({page:1,size:20,total:0}),Q=C([]),T=C({totalIps:0,todayIps:0,totalCountries:0,totalCities:0,genuineCount:0,fakeCount:0,countryStats:[],cityStats:[],productTypeStats:[],sourceStats:[]}),O=n=>n?new Date(n).toLocaleString("zh-CN"):"--",E=n=>{const e=["proxy","vpn","tor","anonymizer"],f=(n.organization||"").toLowerCase();return e.some(v=>f.includes(v))},ge=n=>{const e=["amazon","google","microsoft","cloudflare","digitalocean","linode","vultr","aws","gcp","azure"],f=(n.organization||"").toLowerCase();return e.some(v=>f.includes(v))},oe=n=>L(n)?"爬虫":E(n)?"代理":"访客",de=n=>L(n)?"primary":E(n)?"warning":"success",H=n=>{const e=["google","facebook","twitter","linkedin","microsoft","bytedance","tiktok"],f=(n.organization||"").toLowerCase(),v=(n.user_agent||"").trim(),b=e.some(g=>f.includes(g)),K=!v||v.length<20;return b&&K},L=n=>{if(H(n))return!0;const e=["bot","crawler","spider","scraper","crawl","googlebot","bingbot","slurp","duckduckbot","facebook","facebookexternalhit","facebot","twitter","twitterbot","linkedin","linkedinbot","whatsapp","telegrambot","bytedance","bytespider","semrush","ahrefs","mj12bot","petalbot","yandex","baidu"],f=(n.user_agent||"").toLowerCase(),v=(n.organization||"").toLowerCase();return e.some(b=>f.includes(b)||v.includes(b))},be=n=>{const e=n.user_agent||"";return e.includes("Mobile")?"Mobile":e.includes("Tablet")?"Tablet":e.includes("Desktop")?"Desktop":null},ke=n=>{const e=n.user_agent||"";return e.includes("Android")?"Android":e.includes("iOS")||e.includes("iPhone")||e.includes("iPad")?"iOS":e.includes("Windows")?"Windows":e.includes("Mac")?"macOS":e.includes("Linux")?"Linux":null},ze=n=>{const e=(n.user_agent||"").toLowerCase(),f=(n.organization||"").toLowerCase();return H(n)?f.includes("google")?"Google 审核爬虫":f.includes("facebook")?"Facebook 审核爬虫":f.includes("twitter")?"Twitter 审核爬虫":f.includes("linkedin")?"LinkedIn 审核爬虫":f.includes("microsoft")?"Microsoft 审核爬虫":f.includes("bytedance")||f.includes("tiktok")?"TikTok 审核爬虫":"审核爬虫":e.includes("googlebot")||f.includes("google")&&e.includes("bot")?"Googlebot":e.includes("bingbot")||f.includes("microsoft")&&e.includes("bot")?"BingBot":e.includes("facebook")?"Facebook Crawler":e.includes("twitter")?"Twitter Bot":e.includes("ahrefs")||f.includes("ahrefs")?"aHrefs Bot":e.includes("httpx")?"httpx":e.includes("barkrowler")?"Barkrowler":L(n)?"通用爬虫":null},he=n=>{const e=(n.user_agent||"").toLowerCase(),f=(n.organization||"").toLowerCase();return H(n)?"广告/内容合规审核（无UA或异常UA）":e.includes("googlebot")||f.includes("google")&&e.includes("bot")||e.includes("bingbot")||f.includes("microsoft")&&e.includes("bot")?"搜索引擎蜘蛛":e.includes("facebook")||e.includes("twitter")?"社交媒体爬虫":e.includes("ahrefs")||f.includes("ahrefs")?"SEO分析爬虫":L(n)?"通用网络爬虫":null},ue=n=>({A:"primary",B:"success",C:"warning",D:"danger",E:"info"})[n]||"info",re=n=>({A:"A页",B:"B页",C:"C页",D:"D页",E:"E页"})[n]||n,Ce=n=>({YouTube:"danger","Android App":"success",Google:"primary",Facebook:"primary",Instagram:"warning",TikTok:"danger","Twitter/X":"info",直接访问:"info",其他:""})[n]||"info",Ie=()=>({today:"今天",yesterday:"昨天",week:"本周",month:"本月",all:"全部时间"})[m.timeRange]||"今天",F=async()=>{try{j.value=!0;const n={page:z.page,size:z.size,...m},e=await ne.getVisitorIps(n);e.code===200&&(Q.value=e.data.list,z.total=e.data.total)}catch(n){console.error("获取访客IP列表失败:",n),U.error("获取访客IP列表失败")}finally{j.value=!1}},J=async()=>{try{const n=await ne.getIpStatistics({timeRange:m.timeRange||"today"});n.code===200&&(T.value=n.data)}catch(n){console.error("获取统计数据失败:",n),U.error("获取统计数据失败")}},X=()=>{z.page=1,F(),J()},xe=()=>{Object.assign(m,{ip:"",timeRange:"today",visitorType:"",productId:""}),A.value="",X()},Y=async()=>{try{W.value=!0;const{data:n}=await He({page:V.page,size:V.size});q.value=n.list||[],N.value=n.list||[],V.total=n.total||0}catch{U.error("加载商品列表失败")}finally{W.value=!1}},Ve=()=>{if(!R.value){N.value=q.value;return}const n=R.value.toLowerCase();N.value=q.value.filter(e=>{var f,v;return((f=e.title)==null?void 0:f.toLowerCase().includes(n))||((v=e.spu_id)==null?void 0:v.toLowerCase().includes(n))})},ce=n=>{m.productId=n.spu_id,A.value=n.title,M.value=!1,U.success(`已选择商品: ${n.title}`)},Te=()=>{m.productId="",A.value=""},Pe=n=>{z.size=n,z.page=1,F()},Se=n=>{z.page=n,F()},Ae=async n=>{try{const e=await ne.getVisitorIp(n.ip_address);e.code===200&&(u.value=e.data,G.value=!0)}catch(e){console.error("获取IP详情失败:",e),U.error("获取IP详情失败")}};return Re(()=>{F(),J(),Y()}),(n,e)=>{const f=y("el-input"),v=y("el-form-item"),b=y("el-option"),K=y("el-select"),g=y("el-icon"),D=y("el-button"),Le=y("el-form"),I=y("el-card"),P=y("el-col"),pe=y("el-row"),c=y("el-tag"),_e=y("el-pagination"),Z=y("el-table-column"),De=y("el-table"),w=y("el-dialog"),_=y("el-descriptions-item"),S=y("el-descriptions"),fe=y("el-link"),$=y("el-text"),Be=y("el-timeline-item"),Ue=y("el-timeline"),Me=y("el-empty"),ee=Oe("loading");return i(),r("div",Xe,[l(I,{class:"search-card",shadow:"never"},{default:s(()=>[l(Le,{model:m,inline:!0,class:"search-form"},{default:s(()=>[l(v,{label:"IP地址"},{default:s(()=>[l(f,{modelValue:m.ip,"onUpdate:modelValue":e[0]||(e[0]=a=>m.ip=a),placeholder:"请输入IP地址",clearable:"",style:{width:"200px"},onKeyup:Ee(X,["enter"])},null,8,["modelValue"])]),_:1}),l(v,{label:"时间筛选"},{default:s(()=>[l(K,{modelValue:m.timeRange,"onUpdate:modelValue":e[1]||(e[1]=a=>m.timeRange=a),placeholder:"请选择时间范围",style:{width:"150px"}},{default:s(()=>[l(b,{label:"当天",value:"today"}),l(b,{label:"昨天",value:"yesterday"}),l(b,{label:"本周",value:"week"}),l(b,{label:"本月",value:"month"}),l(b,{label:"全部",value:"all"})]),_:1},8,["modelValue"])]),_:1}),l(v,{label:"访客类型"},{default:s(()=>[l(K,{modelValue:m.visitorType,"onUpdate:modelValue":e[2]||(e[2]=a=>m.visitorType=a),placeholder:"请选择类型",clearable:"",style:{width:"150px"}},{default:s(()=>[l(b,{label:"访客",value:"visitor"}),l(b,{label:"爬虫",value:"bot"}),l(b,{label:"代理",value:"proxy"})]),_:1},8,["modelValue"])]),_:1}),l(v,{label:"商品筛选"},{default:s(()=>[l(f,{modelValue:A.value,"onUpdate:modelValue":e[3]||(e[3]=a=>A.value=a),placeholder:"点击选择商品",readonly:"",style:{width:"200px"},onClick:e[4]||(e[4]=a=>M.value=!0)},{suffix:s(()=>[m.productId?(i(),p(g,{key:0,onClick:ve(Te,["stop"]),style:{cursor:"pointer"}},{default:s(()=>[l(h(Fe))]),_:1})):(i(),p(g,{key:1},{default:s(()=>[l(h(me))]),_:1}))]),_:1},8,["modelValue"])]),_:1}),l(v,null,{default:s(()=>[l(D,{type:"primary",onClick:X},{default:s(()=>[...e[13]||(e[13]=[d("搜索",-1)])]),_:1}),l(D,{onClick:xe},{default:s(()=>[...e[14]||(e[14]=[d("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t("div",Ye,[t("h3",null,"统计数据（"+o(Ie())+"）",1)]),l(pe,{gutter:20,class:"statistics-cards"},{default:s(()=>[l(P,{span:4},{default:s(()=>[l(I,{class:"stat-card"},{default:s(()=>[t("div",Ze,[t("div",we,o(T.value.totalIps),1),e[15]||(e[15]=t("div",{class:"stat-label"},"总IP数",-1))]),t("div",et,[l(g,null,{default:s(()=>[l(h(Ke))]),_:1})])]),_:1})]),_:1}),l(P,{span:4},{default:s(()=>[l(I,{class:"stat-card"},{default:s(()=>[t("div",tt,[t("div",st,o(T.value.todayIps),1),e[16]||(e[16]=t("div",{class:"stat-label"},"今日新增",-1))]),t("div",lt,[l(g,null,{default:s(()=>[l(h($e))]),_:1})])]),_:1})]),_:1}),l(P,{span:4},{default:s(()=>[l(I,{class:"stat-card genuine"},{default:s(()=>[t("div",at,[t("div",it,o(T.value.genuineCount),1),e[17]||(e[17]=t("div",{class:"stat-label"},"访问正品",-1))]),t("div",nt,[l(g,null,{default:s(()=>[l(h(je))]),_:1})])]),_:1})]),_:1}),l(P,{span:4},{default:s(()=>[l(I,{class:"stat-card fake"},{default:s(()=>[t("div",ot,[t("div",dt,o(T.value.fakeCount),1),e[18]||(e[18]=t("div",{class:"stat-label"},"访问仿品",-1))]),t("div",ut,[l(g,null,{default:s(()=>[l(h(se))]),_:1})])]),_:1})]),_:1}),l(P,{span:4},{default:s(()=>[l(I,{class:"stat-card"},{default:s(()=>[t("div",rt,[t("div",ct,o(T.value.totalCountries),1),e[19]||(e[19]=t("div",{class:"stat-label"},"涉及国家",-1))]),t("div",pt,[l(g,null,{default:s(()=>[l(h(Ge))]),_:1})])]),_:1})]),_:1}),l(P,{span:4},{default:s(()=>[l(I,{class:"stat-card"},{default:s(()=>[t("div",_t,[t("div",ft,o(T.value.totalCities),1),e[20]||(e[20]=t("div",{class:"stat-label"},"涉及城市",-1))]),t("div",yt,[l(g,null,{default:s(()=>[l(h(We))]),_:1})])]),_:1})]),_:1})]),_:1}),l(pe,{gutter:20,class:"statistics-cards",style:{"margin-top":"20px"}},{default:s(()=>[l(P,{span:24},{default:s(()=>[l(I,{class:"source-stats-card"},{default:s(()=>[e[22]||(e[22]=t("div",{class:"card-header"},[t("h3",null,"访问来源统计")],-1)),t("div",vt,[(i(!0),r(le,null,ae(T.value.sourceStats,a=>(i(),r("div",{key:a.source,class:"source-item"},[t("div",mt,[l(c,{type:Ce(a.source),size:"default"},{default:s(()=>[d(o(a.source),1)]),_:2},1032,["type"])]),t("div",gt,[t("span",bt,o(a.count),1),e[21]||(e[21]=t("span",{class:"count-label"},"次",-1))])]))),128))])]),_:1})]),_:1})]),_:1}),l(I,{class:"table-card",shadow:"never"},{default:s(()=>[t("div",kt,[e[24]||(e[24]=t("div",{class:"table-title"},"访客IP列表",-1)),t("div",zt,[l(D,{onClick:J},{default:s(()=>[l(g,null,{default:s(()=>[l(h(qe))]),_:1}),e[23]||(e[23]=d(" 刷新统计 ",-1))]),_:1})])]),ie((i(),r("div",ht,[(i(!0),r(le,null,ae(Q.value,(a,ye)=>(i(),r("div",{key:a.id,class:Qe(["ip-item",{"last-item":ye===Q.value.length-1}])},[t("div",Ct,[t("div",It,o(a.ip_address),1),t("div",xt,[l(D,{type:"primary",size:"small",onClick:Ol=>Ae(a)},{default:s(()=>[...e[25]||(e[25]=[d("查看",-1)])]),_:1},8,["onClick"])])]),t("div",Vt,[t("div",Tt,[e[37]||(e[37]=t("div",{class:"section-title"},"地理位置",-1)),t("div",Pt,[t("div",St,[e[26]||(e[26]=t("span",{class:"label"},"城市:",-1)),t("span",At,o(a.city||"-"),1)]),t("div",Lt,[e[27]||(e[27]=t("span",{class:"label"},"地区:",-1)),t("span",Dt,[d(o(a.region||"-")+" ",1),a.region_code?(i(),p(c,{key:0,size:"small",type:"info",style:{"margin-left":"4px"}},{default:s(()=>[d(o(a.region_code),1)]),_:2},1024)):k("",!0)])]),t("div",Bt,[e[28]||(e[28]=t("span",{class:"label"},"国家:",-1)),t("span",Ut,[d(o(a.country_name||a.country||"-")+" ",1),a.country_code||a.country?(i(),p(c,{key:0,size:"small",type:"info",style:{"margin-left":"4px"}},{default:s(()=>[d(o(a.country_code||a.country),1)]),_:2},1024)):k("",!0)])]),a.continent?(i(),r("div",Mt,[e[29]||(e[29]=t("span",{class:"label"},"大洲:",-1)),t("span",Nt,[d(o(a.continent)+" ",1),a.continent_code?(i(),p(c,{key:0,size:"small",type:"info",style:{"margin-left":"4px"}},{default:s(()=>[d(o(a.continent_code),1)]),_:2},1024)):k("",!0)])])):k("",!0),a.postal_code?(i(),r("div",Rt,[e[30]||(e[30]=t("span",{class:"label"},"邮编:",-1)),t("span",Ot,o(a.postal_code),1)])):k("",!0),a.timezone?(i(),r("div",Et,[e[31]||(e[31]=t("span",{class:"label"},"时区:",-1)),t("span",Ft,o(a.timezone),1)])):k("",!0),a.latitude&&a.longitude?(i(),r("div",Kt,[e[32]||(e[32]=t("span",{class:"label"},"坐标:",-1)),t("span",$t,o(a.latitude)+", "+o(a.longitude),1)])):a.location?(i(),r("div",jt,[e[33]||(e[33]=t("span",{class:"label"},"坐标:",-1)),t("span",Gt,o(a.location),1)])):k("",!0),t("div",Wt,[e[34]||(e[34]=t("span",{class:"label"},"首次访问:",-1)),t("span",qt,o(O(a.first_visit)),1)]),t("div",Qt,[e[35]||(e[35]=t("span",{class:"label"},"最后访问:",-1)),t("span",Ht,o(O(a.last_visit)),1)]),t("div",Jt,[e[36]||(e[36]=t("span",{class:"label"},"访问次数:",-1)),l(c,{type:"info",size:"small"},{default:s(()=>[d(o(a.visit_count),1)]),_:2},1024)])])]),t("div",Xt,[e[46]||(e[46]=t("div",{class:"section-title"},"网络与组织",-1)),t("div",Yt,[t("div",Zt,[e[38]||(e[38]=t("span",{class:"label"},"主机名:",-1)),t("span",{class:"value",title:a.hostname||"-"},o(a.hostname||"-"),9,wt)]),t("div",es,[e[39]||(e[39]=t("span",{class:"label"},"ASN号码:",-1)),t("span",ts,o(a.asn||"-"),1)]),t("div",ss,[e[40]||(e[40]=t("span",{class:"label"},"AS组织名称:",-1)),t("span",{class:"value",title:a.as_name||"-"},o(a.as_name||"-"),9,ls)]),t("div",as,[e[41]||(e[41]=t("span",{class:"label"},"AS域名:",-1)),t("span",is,o(a.as_domain||"-"),1)]),t("div",ns,[e[42]||(e[42]=t("span",{class:"label"},"AS类型:",-1)),t("span",os,[a.as_type?(i(),p(c,{key:0,size:"small",type:"primary"},{default:s(()=>[d(o(a.as_type),1)]),_:2},1024)):(i(),r("span",ds,"-"))])]),a.organization&&a.organization!==a.asn+" "+a.as_name?(i(),r("div",us,[e[43]||(e[43]=t("span",{class:"label"},"组织信息:",-1)),t("span",{class:"value",title:a.organization},o(a.organization),9,rs)])):k("",!0),t("div",cs,[E(a)?(i(),p(c,{key:0,size:"small",type:"info"},{default:s(()=>[...e[44]||(e[44]=[d("代理",-1)])]),_:1})):k("",!0),ge(a)?(i(),p(c,{key:1,size:"small",type:"warning"},{default:s(()=>[...e[45]||(e[45]=[d("机房",-1)])]),_:1})):k("",!0)])])]),t("div",ps,[e[55]||(e[55]=t("div",{class:"section-title"},"访问信息",-1)),t("div",_s,[t("div",fs,[e[47]||(e[47]=t("span",{class:"label"},"访问类型:",-1)),l(c,{type:de(a),size:"small"},{default:s(()=>[d(o(oe(a)),1)]),_:2},1032,["type"])]),t("div",ys,[e[48]||(e[48]=t("span",{class:"label"},"设备:",-1)),t("span",vs,o(be(a)||"-"),1)]),t("div",ms,[e[49]||(e[49]=t("span",{class:"label"},"系统:",-1)),t("span",gs,o(ke(a)||"-"),1)]),t("div",bs,[e[50]||(e[50]=t("span",{class:"label"},"商品ID:",-1)),a.product_id?(i(),p(c,{key:0,size:"small",type:"success"},{default:s(()=>[d(o(a.product_id),1)]),_:2},1024)):(i(),r("span",ks,"-"))]),t("div",zs,[e[51]||(e[51]=t("span",{class:"label"},"产品类型:",-1)),a.product_type?(i(),p(c,{key:0,size:"small",type:ue(a.product_type)},{default:s(()=>[d(o(re(a.product_type)),1)]),_:2},1032,["type"])):(i(),r("span",hs,"-"))]),t("div",Cs,[e[52]||(e[52]=t("span",{class:"label"},"访问页面:",-1)),t("span",{class:"value referer",title:a.access_address||"-"},o(a.access_address||"-"),9,Is)]),t("div",xs,[e[53]||(e[53]=t("span",{class:"label"},"来源页面:",-1)),t("span",{class:"value referer",title:a.referer||"-"},o(a.referer||"-"),9,Vs)]),t("div",Ts,[e[54]||(e[54]=t("span",{class:"label"},"User-Agent:",-1)),t("span",{class:"value referer",title:a.user_agent||"-"},o(a.user_agent||"-"),9,Ps)])])]),t("div",Ss,[e[71]||(e[71]=t("div",{class:"section-title"},"IP 特征标识",-1)),t("div",As,[t("div",Ls,[t("div",Ds,[e[58]||(e[58]=t("span",{class:"feature-label"},"匿名IP (VPN/Proxy):",-1)),a.is_anonymous?(i(),p(c,{key:0,type:"danger",size:"small"},{default:s(()=>[l(g,null,{default:s(()=>[l(h(se))]),_:1}),e[56]||(e[56]=d(" 是 ",-1))]),_:1})):(i(),p(c,{key:1,type:"success",size:"small"},{default:s(()=>[...e[57]||(e[57]=[d("否",-1)])]),_:1}))]),t("div",Bs,[e[61]||(e[61]=t("span",{class:"feature-label"},"托管IP (数据中心):",-1)),a.is_hosting?(i(),p(c,{key:0,type:"warning",size:"small"},{default:s(()=>[l(g,null,{default:s(()=>[l(h(se))]),_:1}),e[59]||(e[59]=d(" 是 ",-1))]),_:1})):(i(),p(c,{key:1,type:"success",size:"small"},{default:s(()=>[...e[60]||(e[60]=[d("否",-1)])]),_:1}))]),t("div",Us,[e[64]||(e[64]=t("span",{class:"feature-label"},"移动网络:",-1)),a.is_mobile?(i(),p(c,{key:0,type:"primary",size:"small"},{default:s(()=>[...e[62]||(e[62]=[d("是",-1)])]),_:1})):(i(),p(c,{key:1,type:"info",size:"small"},{default:s(()=>[...e[63]||(e[63]=[d("否",-1)])]),_:1}))]),t("div",Ms,[e[67]||(e[67]=t("span",{class:"feature-label"},"任播IP:",-1)),a.is_anycast?(i(),p(c,{key:0,type:"primary",size:"small"},{default:s(()=>[...e[65]||(e[65]=[d("是",-1)])]),_:1})):(i(),p(c,{key:1,type:"info",size:"small"},{default:s(()=>[...e[66]||(e[66]=[d("否",-1)])]),_:1}))]),t("div",Ns,[e[70]||(e[70]=t("span",{class:"feature-label"},"卫星网络:",-1)),a.is_satellite?(i(),p(c,{key:0,type:"primary",size:"small"},{default:s(()=>[...e[68]||(e[68]=[d("是",-1)])]),_:1})):(i(),p(c,{key:1,type:"info",size:"small"},{default:s(()=>[...e[69]||(e[69]=[d("否",-1)])]),_:1}))])])])]),L(a)||E(a)?(i(),r("div",Rs,[e[75]||(e[75]=t("div",{class:"section-title"},"详细类型",-1)),t("div",Os,[t("div",Es,[e[72]||(e[72]=t("span",{class:"label"},"类型:",-1)),l(c,{type:de(a),size:"small"},{default:s(()=>[d(o(oe(a)),1)]),_:2},1032,["type"])]),t("div",Fs,[e[73]||(e[73]=t("span",{class:"label"},"名称:",-1)),t("span",Ks,o(ze(a)||"-"),1)]),t("div",$s,[e[74]||(e[74]=t("span",{class:"label"},"说明:",-1)),t("span",js,o(he(a)||"-"),1)])])])):k("",!0)])],2))),128))])),[[ee,j.value]]),t("div",Gs,[l(_e,{"current-page":z.page,"onUpdate:currentPage":e[5]||(e[5]=a=>z.page=a),"page-size":z.size,"onUpdate:pageSize":e[6]||(e[6]=a=>z.size=a),total:z.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:Pe,onCurrentChange:Se},null,8,["current-page","page-size","total"])])]),_:1}),l(w,{modelValue:M.value,"onUpdate:modelValue":e[10]||(e[10]=a=>M.value=a),title:"选择商品",width:"800px","close-on-click-modal":!1},{default:s(()=>[t("div",Ws,[l(f,{modelValue:R.value,"onUpdate:modelValue":e[7]||(e[7]=a=>R.value=a),placeholder:"搜索商品标题或ID",clearable:"",style:{"margin-bottom":"20px"},onInput:Ve},{prefix:s(()=>[l(g,null,{default:s(()=>[l(h(me))]),_:1})]),_:1},8,["modelValue"]),ie((i(),p(De,{data:N.value,height:"400","highlight-current-row":"",onRowClick:ce},{default:s(()=>[l(Z,{prop:"spu_id",label:"商品ID",width:"180"}),l(Z,{prop:"title",label:"商品标题","show-overflow-tooltip":""}),l(Z,{label:"操作",width:"100",align:"center"},{default:s(a=>[l(D,{type:"primary",size:"small",onClick:ve(ye=>ce(a.row),["stop"])},{default:s(()=>[...e[76]||(e[76]=[d("选择",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ee,W.value]]),l(_e,{"current-page":V.page,"onUpdate:currentPage":e[8]||(e[8]=a=>V.page=a),"page-size":V.size,"onUpdate:pageSize":e[9]||(e[9]=a=>V.size=a),total:V.total,"page-sizes":[10,20,50],layout:"total, sizes, prev, pager, next",style:{"margin-top":"20px"},onSizeChange:Y,onCurrentChange:Y},null,8,["current-page","page-size","total"])])]),_:1},8,["modelValue"]),l(w,{modelValue:G.value,"onUpdate:modelValue":e[11]||(e[11]=a=>G.value=a),title:"IP详情",width:"800px","close-on-click-modal":!1},{default:s(()=>[u.value?(i(),r("div",qs,[t("div",Qs,[e[77]||(e[77]=t("h4",{class:"section-title"},"基础信息",-1)),l(S,{column:2,border:"",size:"default"},{default:s(()=>[l(_,{label:"IP地址"},{default:s(()=>[d(o(u.value.ip_address),1)]),_:1}),l(_,{label:"主机名"},{default:s(()=>[u.value.hostname?(i(),r("span",Hs,o(u.value.hostname),1)):(i(),r("span",Js,"--"))]),_:1}),l(_,{label:"访问次数"},{default:s(()=>[l(c,{type:"info"},{default:s(()=>[d(o(u.value.visit_count),1)]),_:1})]),_:1}),l(_,{label:"产品类型"},{default:s(()=>[u.value.product_type?(i(),p(c,{key:0,type:ue(u.value.product_type),size:"small"},{default:s(()=>[d(o(re(u.value.product_type)),1)]),_:1},8,["type"])):(i(),r("span",Xs,"--"))]),_:1}),l(_,{label:"首次访问"},{default:s(()=>[d(o(O(u.value.first_visit)),1)]),_:1}),l(_,{label:"最后访问"},{default:s(()=>[d(o(O(u.value.last_visit)),1)]),_:1})]),_:1})]),t("div",Ys,[e[78]||(e[78]=t("h4",{class:"section-title"},"地理位置信息",-1)),l(S,{column:2,border:"",size:"default"},{default:s(()=>[l(_,{label:"城市"},{default:s(()=>[u.value.city?(i(),r("span",Zs,o(u.value.city),1)):(i(),r("span",ws,"--"))]),_:1}),l(_,{label:"地区"},{default:s(()=>[u.value.region?(i(),r("span",el,o(u.value.region),1)):(i(),r("span",tl,"--"))]),_:1}),l(_,{label:"国家代码"},{default:s(()=>[u.value.country_code?(i(),r("span",sl,o(u.value.country_code),1)):u.value.country?(i(),r("span",ll,o(u.value.country),1)):(i(),r("span",al,"--"))]),_:1}),l(_,{label:"大洲"},{default:s(()=>[u.value.continent?(i(),r("span",il,o(u.value.continent)+" ("+o(u.value.continent_code)+") ",1)):(i(),r("span",nl,"--"))]),_:1}),l(_,{label:"邮编"},{default:s(()=>[u.value.postal_code?(i(),r("span",ol,o(u.value.postal_code),1)):(i(),r("span",dl,"--"))]),_:1}),l(_,{label:"时区"},{default:s(()=>[u.value.timezone?(i(),r("span",ul,o(u.value.timezone),1)):(i(),r("span",rl,"--"))]),_:1}),l(_,{label:"经纬度",span:2},{default:s(()=>[u.value.latitude&&u.value.longitude?(i(),r("span",cl,o(u.value.latitude)+", "+o(u.value.longitude),1)):u.value.location?(i(),r("span",pl,o(u.value.location),1)):(i(),r("span",_l,"--"))]),_:1})]),_:1})]),t("div",fl,[e[79]||(e[79]=t("h4",{class:"section-title"},"AS (自治系统) 信息",-1)),l(S,{column:2,border:"",size:"default"},{default:s(()=>[l(_,{label:"ASN"},{default:s(()=>[u.value.asn?(i(),r("span",yl,o(u.value.asn),1)):(i(),r("span",vl,"--"))]),_:1}),l(_,{label:"AS 类型"},{default:s(()=>[u.value.as_type?(i(),p(c,{key:0,size:"small"},{default:s(()=>[d(o(u.value.as_type),1)]),_:1})):(i(),r("span",ml,"--"))]),_:1}),l(_,{label:"AS 组织名称",span:2},{default:s(()=>[u.value.as_name?(i(),r("span",gl,o(u.value.as_name),1)):u.value.organization?(i(),r("span",bl,o(u.value.organization),1)):(i(),r("span",kl,"--"))]),_:1}),l(_,{label:"AS 域名",span:2},{default:s(()=>[u.value.as_domain?(i(),r("span",zl,o(u.value.as_domain),1)):(i(),r("span",hl,"--"))]),_:1})]),_:1})]),t("div",Cl,[e[90]||(e[90]=t("h4",{class:"section-title"},"IP 特征标识",-1)),l(S,{column:3,border:"",size:"default"},{default:s(()=>[l(_,{label:"匿名 IP"},{default:s(()=>[u.value.is_anonymous?(i(),p(c,{key:0,type:"danger",size:"small"},{default:s(()=>[...e[80]||(e[80]=[d("是 (VPN/Proxy)",-1)])]),_:1})):(i(),p(c,{key:1,type:"success",size:"small"},{default:s(()=>[...e[81]||(e[81]=[d("否",-1)])]),_:1}))]),_:1}),l(_,{label:"托管 IP"},{default:s(()=>[u.value.is_hosting?(i(),p(c,{key:0,type:"warning",size:"small"},{default:s(()=>[...e[82]||(e[82]=[d("是 (数据中心)",-1)])]),_:1})):(i(),p(c,{key:1,type:"success",size:"small"},{default:s(()=>[...e[83]||(e[83]=[d("否",-1)])]),_:1}))]),_:1}),l(_,{label:"移动网络"},{default:s(()=>[u.value.is_mobile?(i(),p(c,{key:0,type:"primary",size:"small"},{default:s(()=>[...e[84]||(e[84]=[d("是",-1)])]),_:1})):(i(),p(c,{key:1,type:"info",size:"small"},{default:s(()=>[...e[85]||(e[85]=[d("否",-1)])]),_:1}))]),_:1}),l(_,{label:"任播 IP"},{default:s(()=>[u.value.is_anycast?(i(),p(c,{key:0,type:"info",size:"small"},{default:s(()=>[...e[86]||(e[86]=[d("是",-1)])]),_:1})):(i(),p(c,{key:1,type:"info",size:"small"},{default:s(()=>[...e[87]||(e[87]=[d("否",-1)])]),_:1}))]),_:1}),l(_,{label:"卫星网络"},{default:s(()=>[u.value.is_satellite?(i(),p(c,{key:0,type:"info",size:"small"},{default:s(()=>[...e[88]||(e[88]=[d("是",-1)])]),_:1})):(i(),p(c,{key:1,type:"info",size:"small"},{default:s(()=>[...e[89]||(e[89]=[d("否",-1)])]),_:1}))]),_:1})]),_:1})]),t("div",Il,[e[91]||(e[91]=t("h4",{class:"section-title"},"访问信息",-1)),l(S,{column:1,border:"",size:"default"},{default:s(()=>[l(_,{label:"访问页面"},{default:s(()=>[u.value.access_address?(i(),r("div",xl,[l(fe,{href:u.value.access_address,target:"_blank",type:"primary",size:"small"},{default:s(()=>[d(o(u.value.access_address),1)]),_:1},8,["href"])])):(i(),r("span",Vl,"--"))]),_:1}),l(_,{label:"来源页面"},{default:s(()=>[u.value.referer?(i(),r("div",Tl,[l(fe,{href:u.value.referer,target:"_blank",type:"primary",size:"small"},{default:s(()=>[d(o(u.value.referer),1)]),_:1},8,["href"])])):(i(),r("span",Pl,"--"))]),_:1})]),_:1})])])):k("",!0)]),_:1},8,["modelValue"]),l(w,{modelValue:n.timelineDialogVisible,"onUpdate:modelValue":e[12]||(e[12]=a=>n.timelineDialogVisible=a),title:"用户行为轨迹",width:"800px","close-on-click-modal":!1},{default:s(()=>[ie((i(),r("div",Sl,[n.currentTimeline?(i(),r("div",Al,[t("div",Ll,[l(S,{column:2,size:"small",border:""},{default:s(()=>[l(_,{label:"Session ID"},{default:s(()=>[l($,{size:"small",type:"info"},{default:s(()=>[d(o(n.currentTimeline.sessionId),1)]),_:1})]),_:1}),l(_,{label:"数据来源"},{default:s(()=>[l(c,{type:n.currentTimeline.source==="redis"?"success":"info",size:"small"},{default:s(()=>[d(o(n.currentTimeline.source==="redis"?"Redis (实时)":"MySQL (历史)"),1)]),_:1},8,["type"])]),_:1}),l(_,{label:"进入时间"},{default:s(()=>[d(o(n.currentTimeline.enterTime),1)]),_:1}),l(_,{label:"离开时间"},{default:s(()=>[d(o(n.currentTimeline.exitTime||"未离开"),1)]),_:1}),l(_,{label:"停留时长"},{default:s(()=>[l($,{type:"primary"},{default:s(()=>[d(o(n.currentTimeline.durationText),1)]),_:1})]),_:1}),l(_,{label:"操作次数"},{default:s(()=>[l($,{type:"warning"},{default:s(()=>[d(o(n.currentTimeline.actions.length)+" 次",1)]),_:1})]),_:1})]),_:1})]),t("div",Dl,[l(Ue,null,{default:s(()=>[(i(!0),r(le,null,ae(n.currentTimeline.actions,a=>(i(),p(Be,{key:a.sequence,timestamp:a.time,type:n.getActionType(a.type),placement:"top"},{default:s(()=>[t("div",Bl,[t("div",Ul,[l(c,{type:n.getActionTagType(a.type),size:"small"},{default:s(()=>[d(o(a.typeName),1)]),_:2},1032,["type"]),t("span",Ml,o(a.description),1)]),a.detail?(i(),r("div",Nl,[l($,{size:"small",type:"info"},{default:s(()=>[d(" 详情: "+o(JSON.stringify(a.detail)),1)]),_:2},1024)])):k("",!0)])]),_:2},1032,["timestamp","type"]))),128))]),_:1})])])):(i(),p(Me,{key:1,description:"暂无轨迹数据"}))])),[[ee,n.timelineLoading]])]),_:1},8,["modelValue"])])}}}),$l=Je(Rl,[["__scopeId","data-v-be0e67c8"]]);export{$l as default};
