import{a5 as L,d as Ee,h as I,P as le,Z as Fe,r as y,Q as Ke,c as u,o as n,b as l,a as s,w as t,_ as je,g as p,q as me,u as b,aK as Ge,x as ge,e as d,U as We,t as o,aU as qe,aO as Qe,bn as He,aN as ae,bo as Je,bp as Xe,F as ie,f as ne,W as oe,E as Ye,n as Ze,bm as we,R as z,N as C}from"./index-DLk1q4sZ.js";import{g as es}from"./product-CgBqzbFQ.js";import{_ as ss}from"./_plugin-vue_export-helper-DlAUqK2U.js";const N={getVisitorIps:P=>L.get("/admin/statistics/visitor-ips",P),getVisitorIp:P=>L.get(`/admin/statistics/visitor-ips/${P}`),getIpStatistics:P=>L.get("/admin/statistics/visitor-ips-stats",P),deleteVisitorIp:P=>L.delete(`/admin/statistics/visitor-ips/${P}`),syncBehaviorData:()=>L.post("/admin/statistics/sync-behavior-data"),clearAllIpCache:()=>L.post("/admin/statistics/visitor-ips/clear-cache"),refreshIpInfo:P=>L.post("/admin/statistics/visitor-ips/refresh",{ip:P})},ts={class:"visitor-ip-list"},ls={class:"statistics-title"},as={class:"stat-content"},is={class:"stat-value"},ns={class:"stat-icon"},os={class:"stat-content"},ds={class:"stat-value"},rs={class:"stat-icon"},us={class:"stat-content"},cs={class:"stat-value"},ps={class:"stat-icon"},_s={class:"stat-content"},fs={class:"stat-value"},ys={class:"stat-icon"},vs={class:"stat-content"},ms={class:"stat-value"},gs={class:"stat-icon"},bs={class:"stat-content"},ks={class:"stat-value"},zs={class:"stat-icon"},hs={class:"source-stats-list"},Is={class:"source-name"},Cs={class:"source-count"},Ps={class:"count-value"},xs={class:"table-header"},Vs={class:"table-actions"},Ts={class:"ip-list"},Ss={class:"ip-header"},As={class:"ip-address"},Ls={class:"ip-actions"},Ds={class:"ip-content"},Bs={class:"ip-section"},Us={class:"address-info"},Ms={class:"address-line"},Ns={class:"value"},Rs={class:"address-line"},$s={class:"value"},Os={class:"address-line"},Es={class:"value"},Fs={key:0,class:"address-line"},Ks={class:"value"},js={key:1,class:"address-line"},Gs={class:"value"},Ws={key:2,class:"address-line"},qs={class:"value"},Qs={key:3,class:"address-line"},Hs={class:"value"},Js={key:4,class:"address-line"},Xs={class:"value"},Ys={class:"address-line"},Zs={class:"value"},ws={class:"address-line"},et={class:"value"},st={class:"address-line"},tt={class:"ip-section"},lt={class:"organization-info"},at={class:"org-line"},it=["title"],nt={class:"org-line"},ot={class:"value"},dt={class:"org-line"},rt=["title"],ut={class:"org-line"},ct={class:"value"},pt={class:"org-line"},_t={class:"value"},ft={key:1},yt={key:0,class:"org-line"},vt=["title"],mt={class:"org-tags"},gt={class:"ip-section"},bt={class:"basic-type"},kt={class:"type-line"},zt={class:"type-line"},ht={class:"value"},It={class:"type-line"},Ct={class:"value"},Pt={class:"type-line"},xt={key:1,class:"value"},Vt={class:"type-line"},Tt={key:1,class:"value"},St={class:"type-line"},At=["title"],Lt={class:"type-line"},Dt=["title"],Bt={class:"type-line"},Ut=["title"],Mt={class:"ip-section"},Nt={class:"ip-features"},Rt={class:"feature-list"},$t={class:"feature-item"},Ot={class:"feature-item"},Et={class:"feature-item"},Ft={class:"feature-item"},Kt={class:"feature-item"},jt={key:0,class:"ip-section"},Gt={class:"detailed-type"},Wt={class:"type-line"},qt={class:"type-line"},Qt={class:"value"},Ht={class:"type-line"},Jt={class:"value"},Xt={class:"pagination-wrapper"},Yt={class:"product-select-dialog"},Zt={key:0,class:"ip-detail"},wt={class:"detail-section"},el={key:0},sl={key:1,class:"text-gray-400"},tl={key:1,class:"text-gray-400"},ll={class:"detail-section"},al={key:0},il={key:1,class:"text-gray-400"},nl={key:0},ol={key:1,class:"text-gray-400"},dl={key:0},rl={key:1},ul={key:2,class:"text-gray-400"},cl={key:0},pl={key:1,class:"text-gray-400"},_l={key:0},fl={key:1,class:"text-gray-400"},yl={key:0},vl={key:1,class:"text-gray-400"},ml={key:0},gl={key:1},bl={key:2,class:"text-gray-400"},kl={class:"detail-section"},zl={key:0},hl={key:1,class:"text-gray-400"},Il={key:1,class:"text-gray-400"},Cl={key:0},Pl={key:1},xl={key:2,class:"text-gray-400"},Vl={key:0},Tl={key:1,class:"text-gray-400"},Sl={class:"detail-section"},Al={class:"detail-section"},Ll={key:0,class:"referer-info"},Dl={key:1,class:"text-gray-400"},Bl={key:0,class:"referer-info"},Ul={key:1,class:"text-gray-400"},Ml={class:"timeline-container"},Nl={key:0,class:"timeline-content"},Rl={class:"timeline-header"},$l={class:"timeline-list"},Ol={class:"timeline-item-content"},El={class:"action-description"},Fl={class:"action-text"},Kl={key:0,class:"action-detail"},jl=Ee({__name:"index",setup(P){const G=I(!1),W=I(!1),q=I(!1),r=I(null),g=le({ip:"",timeRange:"today",visitorType:"",productId:""}),R=I(!1),Q=I(!1),H=I([]),$=I([]),O=I(""),B=I(""),V=le({page:1,size:20,total:0}),h=le({page:1,size:20,total:0}),J=I([]),T=I({totalIps:0,todayIps:0,totalCountries:0,totalCities:0,genuineCount:0,fakeCount:0,countryStats:[],cityStats:[],productTypeStats:[],sourceStats:[]}),E=i=>i?new Date(i).toLocaleString("zh-CN"):"--",F=i=>{const e=["proxy","vpn","tor","anonymizer"],f=(i.organization||"").toLowerCase();return e.some(v=>f.includes(v))},be=i=>{const e=["amazon","google","microsoft","cloudflare","digitalocean","linode","vultr","aws","gcp","azure"],f=(i.organization||"").toLowerCase();return e.some(v=>f.includes(v))},de=i=>U(i)?"爬虫":F(i)?"代理":"访客",re=i=>U(i)?"primary":F(i)?"warning":"success",X=i=>{const e=["google","facebook","twitter","linkedin","microsoft","bytedance","tiktok"],f=(i.organization||"").toLowerCase(),v=(i.user_agent||"").trim(),k=e.some(m=>f.includes(m)),K=!v||v.length<20;return k&&K},U=i=>{if(X(i))return!0;const e=["bot","crawler","spider","scraper","crawl","googlebot","bingbot","slurp","duckduckbot","facebook","facebookexternalhit","facebot","twitter","twitterbot","linkedin","linkedinbot","whatsapp","telegrambot","bytedance","bytespider","semrush","ahrefs","mj12bot","petalbot","yandex","baidu"],f=(i.user_agent||"").toLowerCase(),v=(i.organization||"").toLowerCase();return e.some(k=>f.includes(k)||v.includes(k))},ke=i=>{const e=i.user_agent||"";return e.includes("Mobile")?"Mobile":e.includes("Tablet")?"Tablet":e.includes("Desktop")?"Desktop":null},ze=i=>{const e=i.user_agent||"";return e.includes("Android")?"Android":e.includes("iOS")||e.includes("iPhone")||e.includes("iPad")?"iOS":e.includes("Windows")?"Windows":e.includes("Mac")?"macOS":e.includes("Linux")?"Linux":null},he=i=>{const e=(i.user_agent||"").toLowerCase(),f=(i.organization||"").toLowerCase();return X(i)?f.includes("google")?"Google 审核爬虫":f.includes("facebook")?"Facebook 审核爬虫":f.includes("twitter")?"Twitter 审核爬虫":f.includes("linkedin")?"LinkedIn 审核爬虫":f.includes("microsoft")?"Microsoft 审核爬虫":f.includes("bytedance")||f.includes("tiktok")?"TikTok 审核爬虫":"审核爬虫":e.includes("googlebot")||f.includes("google")&&e.includes("bot")?"Googlebot":e.includes("bingbot")||f.includes("microsoft")&&e.includes("bot")?"BingBot":e.includes("facebook")?"Facebook Crawler":e.includes("twitter")?"Twitter Bot":e.includes("ahrefs")||f.includes("ahrefs")?"aHrefs Bot":e.includes("httpx")?"httpx":e.includes("barkrowler")?"Barkrowler":U(i)?"通用爬虫":null},Ie=i=>{const e=(i.user_agent||"").toLowerCase(),f=(i.organization||"").toLowerCase();return X(i)?"广告/内容合规审核（无UA或异常UA）":e.includes("googlebot")||f.includes("google")&&e.includes("bot")||e.includes("bingbot")||f.includes("microsoft")&&e.includes("bot")?"搜索引擎蜘蛛":e.includes("facebook")||e.includes("twitter")?"社交媒体爬虫":e.includes("ahrefs")||f.includes("ahrefs")?"SEO分析爬虫":U(i)?"通用网络爬虫":null},ue=i=>({A:"primary",B:"success",C:"warning",D:"danger",E:"info"})[i]||"info",ce=i=>({A:"A页",B:"B页",C:"C页",D:"D页",E:"E页"})[i]||i,Ce=i=>({YouTube:"danger","Android App":"success",Google:"primary",Facebook:"primary",Instagram:"warning",TikTok:"danger","Twitter/X":"info",直接访问:"info",其他:""})[i]||"info",Pe=()=>({today:"今天",yesterday:"昨天",week:"本周",month:"本月",all:"全部时间"})[g.timeRange]||"今天",M=async()=>{try{G.value=!0;const i={page:h.page,size:h.size,...g},e=await N.getVisitorIps(i);e.code===200&&(J.value=e.data.list,h.total=e.data.total)}catch(i){console.error("获取访客IP列表失败:",i),C.error("获取访客IP列表失败")}finally{G.value=!1}},Y=async()=>{try{const i=await N.getIpStatistics({timeRange:g.timeRange||"today"});i.code===200&&(T.value=i.data)}catch(i){console.error("获取统计数据失败:",i),C.error("获取统计数据失败")}},Z=()=>{h.page=1,M(),Y()},xe=()=>{Object.assign(g,{ip:"",timeRange:"today",visitorType:"",productId:""}),B.value="",Z()},w=async()=>{try{Q.value=!0;const{data:i}=await es({page:V.page,size:V.size});H.value=i.list||[],$.value=i.list||[],V.total=i.total||0}catch{C.error("加载商品列表失败")}finally{Q.value=!1}},Ve=()=>{if(!O.value){$.value=H.value;return}const i=O.value.toLowerCase();$.value=H.value.filter(e=>{var f,v;return((f=e.title)==null?void 0:f.toLowerCase().includes(i))||((v=e.spu_id)==null?void 0:v.toLowerCase().includes(i))})},pe=i=>{g.productId=i.spu_id,B.value=i.title,R.value=!1,C.success(`已选择商品: ${i.title}`)},Te=()=>{g.productId="",B.value=""},Se=i=>{h.size=i,h.page=1,M()},Ae=i=>{h.page=i,M()},Le=async i=>{try{const e=await N.getVisitorIp(i.ip_address);e.code===200&&(r.value=e.data,q.value=!0)}catch(e){console.error("获取IP详情失败:",e),C.error("获取IP详情失败")}},De=async()=>{var i;try{W.value=!0;const e=await N.clearAllIpCache();e.code===200?C.success(e.message||`成功清理 ${((i=e.data)==null?void 0:i.count)||0} 个IP缓存`):C.error(e.message||"清空缓存失败")}catch(e){console.error("清空IP缓存失败:",e),C.error("清空缓存失败")}finally{W.value=!1}},Be=async i=>{try{C.info(`正在重新识别 IP: ${i.ip_address}...`);const e=await N.refreshIpInfo(i.ip_address);e.code===200?(C.success("IP信息已重新识别并更新"),await M()):C.error(e.message||"重新识别失败")}catch(e){console.error("重新识别IP失败:",e),C.error("重新识别IP失败")}};return Fe(()=>{M(),Y(),w()}),(i,e)=>{const f=y("el-input"),v=y("el-form-item"),k=y("el-option"),K=y("el-select"),m=y("el-icon"),S=y("el-button"),Ue=y("el-form"),x=y("el-card"),A=y("el-col"),_e=y("el-row"),c=y("el-tag"),fe=y("el-pagination"),ee=y("el-table-column"),Me=y("el-table"),se=y("el-dialog"),_=y("el-descriptions-item"),D=y("el-descriptions"),ye=y("el-link"),j=y("el-text"),Ne=y("el-timeline-item"),Re=y("el-timeline"),$e=y("el-empty"),te=Ke("loading");return n(),u("div",ts,[l(x,{class:"search-card",shadow:"never"},{default:t(()=>[l(Ue,{model:g,inline:!0,class:"search-form"},{default:t(()=>[l(v,{label:"IP地址"},{default:t(()=>[l(f,{modelValue:g.ip,"onUpdate:modelValue":e[0]||(e[0]=a=>g.ip=a),placeholder:"请输入IP地址",clearable:"",style:{width:"200px"},onKeyup:je(Z,["enter"])},null,8,["modelValue"])]),_:1}),l(v,{label:"时间筛选"},{default:t(()=>[l(K,{modelValue:g.timeRange,"onUpdate:modelValue":e[1]||(e[1]=a=>g.timeRange=a),placeholder:"请选择时间范围",style:{width:"150px"}},{default:t(()=>[l(k,{label:"当天",value:"today"}),l(k,{label:"昨天",value:"yesterday"}),l(k,{label:"本周",value:"week"}),l(k,{label:"本月",value:"month"}),l(k,{label:"全部",value:"all"})]),_:1},8,["modelValue"])]),_:1}),l(v,{label:"访客类型"},{default:t(()=>[l(K,{modelValue:g.visitorType,"onUpdate:modelValue":e[2]||(e[2]=a=>g.visitorType=a),placeholder:"请选择类型",clearable:"",style:{width:"150px"}},{default:t(()=>[l(k,{label:"访客",value:"visitor"}),l(k,{label:"爬虫",value:"bot"}),l(k,{label:"代理",value:"proxy"})]),_:1},8,["modelValue"])]),_:1}),l(v,{label:"商品筛选"},{default:t(()=>[l(f,{modelValue:B.value,"onUpdate:modelValue":e[3]||(e[3]=a=>B.value=a),placeholder:"点击选择商品",readonly:"",style:{width:"200px"},onClick:e[4]||(e[4]=a=>R.value=!0)},{suffix:t(()=>[g.productId?(n(),p(m,{key:0,onClick:me(Te,["stop"]),style:{cursor:"pointer"}},{default:t(()=>[l(b(Ge))]),_:1})):(n(),p(m,{key:1},{default:t(()=>[l(b(ge))]),_:1}))]),_:1},8,["modelValue"])]),_:1}),l(v,null,{default:t(()=>[l(S,{type:"primary",onClick:Z},{default:t(()=>[...e[13]||(e[13]=[d("搜索",-1)])]),_:1}),l(S,{onClick:xe},{default:t(()=>[...e[14]||(e[14]=[d("重置",-1)])]),_:1}),l(S,{type:"warning",onClick:De,loading:W.value},{default:t(()=>[l(m,null,{default:t(()=>[l(b(We))]),_:1}),e[15]||(e[15]=d(" 一键清空缓存 ",-1))]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1}),s("div",ls,[s("h3",null,"统计数据（"+o(Pe())+"）",1)]),l(_e,{gutter:20,class:"statistics-cards"},{default:t(()=>[l(A,{span:4},{default:t(()=>[l(x,{class:"stat-card"},{default:t(()=>[s("div",as,[s("div",is,o(T.value.totalIps),1),e[16]||(e[16]=s("div",{class:"stat-label"},"总IP数",-1))]),s("div",ns,[l(m,null,{default:t(()=>[l(b(qe))]),_:1})])]),_:1})]),_:1}),l(A,{span:4},{default:t(()=>[l(x,{class:"stat-card"},{default:t(()=>[s("div",os,[s("div",ds,o(T.value.todayIps),1),e[17]||(e[17]=s("div",{class:"stat-label"},"今日新增",-1))]),s("div",rs,[l(m,null,{default:t(()=>[l(b(Qe))]),_:1})])]),_:1})]),_:1}),l(A,{span:4},{default:t(()=>[l(x,{class:"stat-card genuine"},{default:t(()=>[s("div",us,[s("div",cs,o(T.value.genuineCount),1),e[18]||(e[18]=s("div",{class:"stat-label"},"访问正品",-1))]),s("div",ps,[l(m,null,{default:t(()=>[l(b(He))]),_:1})])]),_:1})]),_:1}),l(A,{span:4},{default:t(()=>[l(x,{class:"stat-card fake"},{default:t(()=>[s("div",_s,[s("div",fs,o(T.value.fakeCount),1),e[19]||(e[19]=s("div",{class:"stat-label"},"访问仿品",-1))]),s("div",ys,[l(m,null,{default:t(()=>[l(b(ae))]),_:1})])]),_:1})]),_:1}),l(A,{span:4},{default:t(()=>[l(x,{class:"stat-card"},{default:t(()=>[s("div",vs,[s("div",ms,o(T.value.totalCountries),1),e[20]||(e[20]=s("div",{class:"stat-label"},"涉及国家",-1))]),s("div",gs,[l(m,null,{default:t(()=>[l(b(Je))]),_:1})])]),_:1})]),_:1}),l(A,{span:4},{default:t(()=>[l(x,{class:"stat-card"},{default:t(()=>[s("div",bs,[s("div",ks,o(T.value.totalCities),1),e[21]||(e[21]=s("div",{class:"stat-label"},"涉及城市",-1))]),s("div",zs,[l(m,null,{default:t(()=>[l(b(Xe))]),_:1})])]),_:1})]),_:1})]),_:1}),l(_e,{gutter:20,class:"statistics-cards",style:{"margin-top":"20px"}},{default:t(()=>[l(A,{span:24},{default:t(()=>[l(x,{class:"source-stats-card"},{default:t(()=>[e[23]||(e[23]=s("div",{class:"card-header"},[s("h3",null,"访问来源统计")],-1)),s("div",hs,[(n(!0),u(ie,null,ne(T.value.sourceStats,a=>(n(),u("div",{key:a.source,class:"source-item"},[s("div",Is,[l(c,{type:Ce(a.source),size:"default"},{default:t(()=>[d(o(a.source),1)]),_:2},1032,["type"])]),s("div",Cs,[s("span",Ps,o(a.count),1),e[22]||(e[22]=s("span",{class:"count-label"},"次",-1))])]))),128))])]),_:1})]),_:1})]),_:1}),l(x,{class:"table-card",shadow:"never"},{default:t(()=>[s("div",xs,[e[25]||(e[25]=s("div",{class:"table-title"},"访客IP列表",-1)),s("div",Vs,[l(S,{onClick:Y},{default:t(()=>[l(m,null,{default:t(()=>[l(b(Ye))]),_:1}),e[24]||(e[24]=d(" 刷新统计 ",-1))]),_:1})])]),oe((n(),u("div",Ts,[(n(!0),u(ie,null,ne(J.value,(a,ve)=>(n(),u("div",{key:a.id,class:Ze(["ip-item",{"last-item":ve===J.value.length-1}])},[s("div",Ss,[s("div",As,o(a.ip_address),1),s("div",Ls,[l(S,{type:"success",size:"small",onClick:Oe=>Be(a)},{default:t(()=>[l(m,null,{default:t(()=>[l(b(we))]),_:1}),e[26]||(e[26]=d(" 重新识别 ",-1))]),_:1},8,["onClick"]),l(S,{type:"primary",size:"small",onClick:Oe=>Le(a)},{default:t(()=>[...e[27]||(e[27]=[d("查看",-1)])]),_:1},8,["onClick"])])]),s("div",Ds,[s("div",Bs,[e[39]||(e[39]=s("div",{class:"section-title"},"地理位置",-1)),s("div",Us,[s("div",Ms,[e[28]||(e[28]=s("span",{class:"label"},"城市:",-1)),s("span",Ns,o(a.city||"-"),1)]),s("div",Rs,[e[29]||(e[29]=s("span",{class:"label"},"地区:",-1)),s("span",$s,[d(o(a.region||"-")+" ",1),a.region_code?(n(),p(c,{key:0,size:"small",type:"info",style:{"margin-left":"4px"}},{default:t(()=>[d(o(a.region_code),1)]),_:2},1024)):z("",!0)])]),s("div",Os,[e[30]||(e[30]=s("span",{class:"label"},"国家:",-1)),s("span",Es,[d(o(a.country_name||a.country||"-")+" ",1),a.country_code||a.country?(n(),p(c,{key:0,size:"small",type:"info",style:{"margin-left":"4px"}},{default:t(()=>[d(o(a.country_code||a.country),1)]),_:2},1024)):z("",!0)])]),a.continent?(n(),u("div",Fs,[e[31]||(e[31]=s("span",{class:"label"},"大洲:",-1)),s("span",Ks,[d(o(a.continent)+" ",1),a.continent_code?(n(),p(c,{key:0,size:"small",type:"info",style:{"margin-left":"4px"}},{default:t(()=>[d(o(a.continent_code),1)]),_:2},1024)):z("",!0)])])):z("",!0),a.postal_code?(n(),u("div",js,[e[32]||(e[32]=s("span",{class:"label"},"邮编:",-1)),s("span",Gs,o(a.postal_code),1)])):z("",!0),a.timezone?(n(),u("div",Ws,[e[33]||(e[33]=s("span",{class:"label"},"时区:",-1)),s("span",qs,o(a.timezone),1)])):z("",!0),a.latitude&&a.longitude?(n(),u("div",Qs,[e[34]||(e[34]=s("span",{class:"label"},"坐标:",-1)),s("span",Hs,o(a.latitude)+", "+o(a.longitude),1)])):a.location?(n(),u("div",Js,[e[35]||(e[35]=s("span",{class:"label"},"坐标:",-1)),s("span",Xs,o(a.location),1)])):z("",!0),s("div",Ys,[e[36]||(e[36]=s("span",{class:"label"},"首次访问:",-1)),s("span",Zs,o(E(a.first_visit)),1)]),s("div",ws,[e[37]||(e[37]=s("span",{class:"label"},"最后访问:",-1)),s("span",et,o(E(a.last_visit)),1)]),s("div",st,[e[38]||(e[38]=s("span",{class:"label"},"访问次数:",-1)),l(c,{type:"info",size:"small"},{default:t(()=>[d(o(a.visit_count),1)]),_:2},1024)])])]),s("div",tt,[e[48]||(e[48]=s("div",{class:"section-title"},"网络与组织",-1)),s("div",lt,[s("div",at,[e[40]||(e[40]=s("span",{class:"label"},"主机名:",-1)),s("span",{class:"value",title:a.hostname||"-"},o(a.hostname||"-"),9,it)]),s("div",nt,[e[41]||(e[41]=s("span",{class:"label"},"ASN号码:",-1)),s("span",ot,o(a.asn||"-"),1)]),s("div",dt,[e[42]||(e[42]=s("span",{class:"label"},"AS组织名称:",-1)),s("span",{class:"value",title:a.as_name||"-"},o(a.as_name||"-"),9,rt)]),s("div",ut,[e[43]||(e[43]=s("span",{class:"label"},"AS域名:",-1)),s("span",ct,o(a.as_domain||"-"),1)]),s("div",pt,[e[44]||(e[44]=s("span",{class:"label"},"AS类型:",-1)),s("span",_t,[a.as_type?(n(),p(c,{key:0,size:"small",type:"primary"},{default:t(()=>[d(o(a.as_type),1)]),_:2},1024)):(n(),u("span",ft,"-"))])]),a.organization&&a.organization!==a.asn+" "+a.as_name?(n(),u("div",yt,[e[45]||(e[45]=s("span",{class:"label"},"组织信息:",-1)),s("span",{class:"value",title:a.organization},o(a.organization),9,vt)])):z("",!0),s("div",mt,[F(a)?(n(),p(c,{key:0,size:"small",type:"info"},{default:t(()=>[...e[46]||(e[46]=[d("代理",-1)])]),_:1})):z("",!0),be(a)?(n(),p(c,{key:1,size:"small",type:"warning"},{default:t(()=>[...e[47]||(e[47]=[d("机房",-1)])]),_:1})):z("",!0)])])]),s("div",gt,[e[57]||(e[57]=s("div",{class:"section-title"},"访问信息",-1)),s("div",bt,[s("div",kt,[e[49]||(e[49]=s("span",{class:"label"},"访问类型:",-1)),l(c,{type:re(a),size:"small"},{default:t(()=>[d(o(de(a)),1)]),_:2},1032,["type"])]),s("div",zt,[e[50]||(e[50]=s("span",{class:"label"},"设备:",-1)),s("span",ht,o(ke(a)||"-"),1)]),s("div",It,[e[51]||(e[51]=s("span",{class:"label"},"系统:",-1)),s("span",Ct,o(ze(a)||"-"),1)]),s("div",Pt,[e[52]||(e[52]=s("span",{class:"label"},"商品ID:",-1)),a.product_id?(n(),p(c,{key:0,size:"small",type:"success"},{default:t(()=>[d(o(a.product_id),1)]),_:2},1024)):(n(),u("span",xt,"-"))]),s("div",Vt,[e[53]||(e[53]=s("span",{class:"label"},"产品类型:",-1)),a.product_type?(n(),p(c,{key:0,size:"small",type:ue(a.product_type)},{default:t(()=>[d(o(ce(a.product_type)),1)]),_:2},1032,["type"])):(n(),u("span",Tt,"-"))]),s("div",St,[e[54]||(e[54]=s("span",{class:"label"},"访问页面:",-1)),s("span",{class:"value referer",title:a.access_address||"-"},o(a.access_address||"-"),9,At)]),s("div",Lt,[e[55]||(e[55]=s("span",{class:"label"},"来源页面:",-1)),s("span",{class:"value referer",title:a.referer||"-"},o(a.referer||"-"),9,Dt)]),s("div",Bt,[e[56]||(e[56]=s("span",{class:"label"},"User-Agent:",-1)),s("span",{class:"value referer",title:a.user_agent||"-"},o(a.user_agent||"-"),9,Ut)])])]),s("div",Mt,[e[73]||(e[73]=s("div",{class:"section-title"},"IP 特征标识",-1)),s("div",Nt,[s("div",Rt,[s("div",$t,[e[60]||(e[60]=s("span",{class:"feature-label"},"匿名IP (VPN/Proxy):",-1)),a.is_anonymous?(n(),p(c,{key:0,type:"danger",size:"small"},{default:t(()=>[l(m,null,{default:t(()=>[l(b(ae))]),_:1}),e[58]||(e[58]=d(" 是 ",-1))]),_:1})):(n(),p(c,{key:1,type:"success",size:"small"},{default:t(()=>[...e[59]||(e[59]=[d("否",-1)])]),_:1}))]),s("div",Ot,[e[63]||(e[63]=s("span",{class:"feature-label"},"托管IP (数据中心):",-1)),a.is_hosting?(n(),p(c,{key:0,type:"warning",size:"small"},{default:t(()=>[l(m,null,{default:t(()=>[l(b(ae))]),_:1}),e[61]||(e[61]=d(" 是 ",-1))]),_:1})):(n(),p(c,{key:1,type:"success",size:"small"},{default:t(()=>[...e[62]||(e[62]=[d("否",-1)])]),_:1}))]),s("div",Et,[e[66]||(e[66]=s("span",{class:"feature-label"},"移动网络:",-1)),a.is_mobile?(n(),p(c,{key:0,type:"primary",size:"small"},{default:t(()=>[...e[64]||(e[64]=[d("是",-1)])]),_:1})):(n(),p(c,{key:1,type:"info",size:"small"},{default:t(()=>[...e[65]||(e[65]=[d("否",-1)])]),_:1}))]),s("div",Ft,[e[69]||(e[69]=s("span",{class:"feature-label"},"任播IP:",-1)),a.is_anycast?(n(),p(c,{key:0,type:"primary",size:"small"},{default:t(()=>[...e[67]||(e[67]=[d("是",-1)])]),_:1})):(n(),p(c,{key:1,type:"info",size:"small"},{default:t(()=>[...e[68]||(e[68]=[d("否",-1)])]),_:1}))]),s("div",Kt,[e[72]||(e[72]=s("span",{class:"feature-label"},"卫星网络:",-1)),a.is_satellite?(n(),p(c,{key:0,type:"primary",size:"small"},{default:t(()=>[...e[70]||(e[70]=[d("是",-1)])]),_:1})):(n(),p(c,{key:1,type:"info",size:"small"},{default:t(()=>[...e[71]||(e[71]=[d("否",-1)])]),_:1}))])])])]),U(a)||F(a)?(n(),u("div",jt,[e[77]||(e[77]=s("div",{class:"section-title"},"详细类型",-1)),s("div",Gt,[s("div",Wt,[e[74]||(e[74]=s("span",{class:"label"},"类型:",-1)),l(c,{type:re(a),size:"small"},{default:t(()=>[d(o(de(a)),1)]),_:2},1032,["type"])]),s("div",qt,[e[75]||(e[75]=s("span",{class:"label"},"名称:",-1)),s("span",Qt,o(he(a)||"-"),1)]),s("div",Ht,[e[76]||(e[76]=s("span",{class:"label"},"说明:",-1)),s("span",Jt,o(Ie(a)||"-"),1)])])])):z("",!0)])],2))),128))])),[[te,G.value]]),s("div",Xt,[l(fe,{"current-page":h.page,"onUpdate:currentPage":e[5]||(e[5]=a=>h.page=a),"page-size":h.size,"onUpdate:pageSize":e[6]||(e[6]=a=>h.size=a),total:h.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:Se,onCurrentChange:Ae},null,8,["current-page","page-size","total"])])]),_:1}),l(se,{modelValue:R.value,"onUpdate:modelValue":e[10]||(e[10]=a=>R.value=a),title:"选择商品",width:"800px","close-on-click-modal":!1},{default:t(()=>[s("div",Yt,[l(f,{modelValue:O.value,"onUpdate:modelValue":e[7]||(e[7]=a=>O.value=a),placeholder:"搜索商品标题或ID",clearable:"",style:{"margin-bottom":"20px"},onInput:Ve},{prefix:t(()=>[l(m,null,{default:t(()=>[l(b(ge))]),_:1})]),_:1},8,["modelValue"]),oe((n(),p(Me,{data:$.value,height:"400","highlight-current-row":"",onRowClick:pe},{default:t(()=>[l(ee,{prop:"spu_id",label:"商品ID",width:"180"}),l(ee,{prop:"title",label:"商品标题","show-overflow-tooltip":""}),l(ee,{label:"操作",width:"100",align:"center"},{default:t(a=>[l(S,{type:"primary",size:"small",onClick:me(ve=>pe(a.row),["stop"])},{default:t(()=>[...e[78]||(e[78]=[d("选择",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[te,Q.value]]),l(fe,{"current-page":V.page,"onUpdate:currentPage":e[8]||(e[8]=a=>V.page=a),"page-size":V.size,"onUpdate:pageSize":e[9]||(e[9]=a=>V.size=a),total:V.total,"page-sizes":[10,20,50],layout:"total, sizes, prev, pager, next",style:{"margin-top":"20px"},onSizeChange:w,onCurrentChange:w},null,8,["current-page","page-size","total"])])]),_:1},8,["modelValue"]),l(se,{modelValue:q.value,"onUpdate:modelValue":e[11]||(e[11]=a=>q.value=a),title:"IP详情",width:"800px","close-on-click-modal":!1},{default:t(()=>[r.value?(n(),u("div",Zt,[s("div",wt,[e[79]||(e[79]=s("h4",{class:"section-title"},"基础信息",-1)),l(D,{column:2,border:"",size:"default"},{default:t(()=>[l(_,{label:"IP地址"},{default:t(()=>[d(o(r.value.ip_address),1)]),_:1}),l(_,{label:"主机名"},{default:t(()=>[r.value.hostname?(n(),u("span",el,o(r.value.hostname),1)):(n(),u("span",sl,"--"))]),_:1}),l(_,{label:"访问次数"},{default:t(()=>[l(c,{type:"info"},{default:t(()=>[d(o(r.value.visit_count),1)]),_:1})]),_:1}),l(_,{label:"产品类型"},{default:t(()=>[r.value.product_type?(n(),p(c,{key:0,type:ue(r.value.product_type),size:"small"},{default:t(()=>[d(o(ce(r.value.product_type)),1)]),_:1},8,["type"])):(n(),u("span",tl,"--"))]),_:1}),l(_,{label:"首次访问"},{default:t(()=>[d(o(E(r.value.first_visit)),1)]),_:1}),l(_,{label:"最后访问"},{default:t(()=>[d(o(E(r.value.last_visit)),1)]),_:1})]),_:1})]),s("div",ll,[e[80]||(e[80]=s("h4",{class:"section-title"},"地理位置信息",-1)),l(D,{column:2,border:"",size:"default"},{default:t(()=>[l(_,{label:"城市"},{default:t(()=>[r.value.city?(n(),u("span",al,o(r.value.city),1)):(n(),u("span",il,"--"))]),_:1}),l(_,{label:"地区"},{default:t(()=>[r.value.region?(n(),u("span",nl,o(r.value.region),1)):(n(),u("span",ol,"--"))]),_:1}),l(_,{label:"国家代码"},{default:t(()=>[r.value.country_code?(n(),u("span",dl,o(r.value.country_code),1)):r.value.country?(n(),u("span",rl,o(r.value.country),1)):(n(),u("span",ul,"--"))]),_:1}),l(_,{label:"大洲"},{default:t(()=>[r.value.continent?(n(),u("span",cl,o(r.value.continent)+" ("+o(r.value.continent_code)+") ",1)):(n(),u("span",pl,"--"))]),_:1}),l(_,{label:"邮编"},{default:t(()=>[r.value.postal_code?(n(),u("span",_l,o(r.value.postal_code),1)):(n(),u("span",fl,"--"))]),_:1}),l(_,{label:"时区"},{default:t(()=>[r.value.timezone?(n(),u("span",yl,o(r.value.timezone),1)):(n(),u("span",vl,"--"))]),_:1}),l(_,{label:"经纬度",span:2},{default:t(()=>[r.value.latitude&&r.value.longitude?(n(),u("span",ml,o(r.value.latitude)+", "+o(r.value.longitude),1)):r.value.location?(n(),u("span",gl,o(r.value.location),1)):(n(),u("span",bl,"--"))]),_:1})]),_:1})]),s("div",kl,[e[81]||(e[81]=s("h4",{class:"section-title"},"AS (自治系统) 信息",-1)),l(D,{column:2,border:"",size:"default"},{default:t(()=>[l(_,{label:"ASN"},{default:t(()=>[r.value.asn?(n(),u("span",zl,o(r.value.asn),1)):(n(),u("span",hl,"--"))]),_:1}),l(_,{label:"AS 类型"},{default:t(()=>[r.value.as_type?(n(),p(c,{key:0,size:"small"},{default:t(()=>[d(o(r.value.as_type),1)]),_:1})):(n(),u("span",Il,"--"))]),_:1}),l(_,{label:"AS 组织名称",span:2},{default:t(()=>[r.value.as_name?(n(),u("span",Cl,o(r.value.as_name),1)):r.value.organization?(n(),u("span",Pl,o(r.value.organization),1)):(n(),u("span",xl,"--"))]),_:1}),l(_,{label:"AS 域名",span:2},{default:t(()=>[r.value.as_domain?(n(),u("span",Vl,o(r.value.as_domain),1)):(n(),u("span",Tl,"--"))]),_:1})]),_:1})]),s("div",Sl,[e[92]||(e[92]=s("h4",{class:"section-title"},"IP 特征标识",-1)),l(D,{column:3,border:"",size:"default"},{default:t(()=>[l(_,{label:"匿名 IP"},{default:t(()=>[r.value.is_anonymous?(n(),p(c,{key:0,type:"danger",size:"small"},{default:t(()=>[...e[82]||(e[82]=[d("是 (VPN/Proxy)",-1)])]),_:1})):(n(),p(c,{key:1,type:"success",size:"small"},{default:t(()=>[...e[83]||(e[83]=[d("否",-1)])]),_:1}))]),_:1}),l(_,{label:"托管 IP"},{default:t(()=>[r.value.is_hosting?(n(),p(c,{key:0,type:"warning",size:"small"},{default:t(()=>[...e[84]||(e[84]=[d("是 (数据中心)",-1)])]),_:1})):(n(),p(c,{key:1,type:"success",size:"small"},{default:t(()=>[...e[85]||(e[85]=[d("否",-1)])]),_:1}))]),_:1}),l(_,{label:"移动网络"},{default:t(()=>[r.value.is_mobile?(n(),p(c,{key:0,type:"primary",size:"small"},{default:t(()=>[...e[86]||(e[86]=[d("是",-1)])]),_:1})):(n(),p(c,{key:1,type:"info",size:"small"},{default:t(()=>[...e[87]||(e[87]=[d("否",-1)])]),_:1}))]),_:1}),l(_,{label:"任播 IP"},{default:t(()=>[r.value.is_anycast?(n(),p(c,{key:0,type:"info",size:"small"},{default:t(()=>[...e[88]||(e[88]=[d("是",-1)])]),_:1})):(n(),p(c,{key:1,type:"info",size:"small"},{default:t(()=>[...e[89]||(e[89]=[d("否",-1)])]),_:1}))]),_:1}),l(_,{label:"卫星网络"},{default:t(()=>[r.value.is_satellite?(n(),p(c,{key:0,type:"info",size:"small"},{default:t(()=>[...e[90]||(e[90]=[d("是",-1)])]),_:1})):(n(),p(c,{key:1,type:"info",size:"small"},{default:t(()=>[...e[91]||(e[91]=[d("否",-1)])]),_:1}))]),_:1})]),_:1})]),s("div",Al,[e[93]||(e[93]=s("h4",{class:"section-title"},"访问信息",-1)),l(D,{column:1,border:"",size:"default"},{default:t(()=>[l(_,{label:"访问页面"},{default:t(()=>[r.value.access_address?(n(),u("div",Ll,[l(ye,{href:r.value.access_address,target:"_blank",type:"primary",size:"small"},{default:t(()=>[d(o(r.value.access_address),1)]),_:1},8,["href"])])):(n(),u("span",Dl,"--"))]),_:1}),l(_,{label:"来源页面"},{default:t(()=>[r.value.referer?(n(),u("div",Bl,[l(ye,{href:r.value.referer,target:"_blank",type:"primary",size:"small"},{default:t(()=>[d(o(r.value.referer),1)]),_:1},8,["href"])])):(n(),u("span",Ul,"--"))]),_:1})]),_:1})])])):z("",!0)]),_:1},8,["modelValue"]),l(se,{modelValue:i.timelineDialogVisible,"onUpdate:modelValue":e[12]||(e[12]=a=>i.timelineDialogVisible=a),title:"用户行为轨迹",width:"800px","close-on-click-modal":!1},{default:t(()=>[oe((n(),u("div",Ml,[i.currentTimeline?(n(),u("div",Nl,[s("div",Rl,[l(D,{column:2,size:"small",border:""},{default:t(()=>[l(_,{label:"Session ID"},{default:t(()=>[l(j,{size:"small",type:"info"},{default:t(()=>[d(o(i.currentTimeline.sessionId),1)]),_:1})]),_:1}),l(_,{label:"数据来源"},{default:t(()=>[l(c,{type:i.currentTimeline.source==="redis"?"success":"info",size:"small"},{default:t(()=>[d(o(i.currentTimeline.source==="redis"?"Redis (实时)":"MySQL (历史)"),1)]),_:1},8,["type"])]),_:1}),l(_,{label:"进入时间"},{default:t(()=>[d(o(i.currentTimeline.enterTime),1)]),_:1}),l(_,{label:"离开时间"},{default:t(()=>[d(o(i.currentTimeline.exitTime||"未离开"),1)]),_:1}),l(_,{label:"停留时长"},{default:t(()=>[l(j,{type:"primary"},{default:t(()=>[d(o(i.currentTimeline.durationText),1)]),_:1})]),_:1}),l(_,{label:"操作次数"},{default:t(()=>[l(j,{type:"warning"},{default:t(()=>[d(o(i.currentTimeline.actions.length)+" 次",1)]),_:1})]),_:1})]),_:1})]),s("div",$l,[l(Re,null,{default:t(()=>[(n(!0),u(ie,null,ne(i.currentTimeline.actions,a=>(n(),p(Ne,{key:a.sequence,timestamp:a.time,type:i.getActionType(a.type),placement:"top"},{default:t(()=>[s("div",Ol,[s("div",El,[l(c,{type:i.getActionTagType(a.type),size:"small"},{default:t(()=>[d(o(a.typeName),1)]),_:2},1032,["type"]),s("span",Fl,o(a.description),1)]),a.detail?(n(),u("div",Kl,[l(j,{size:"small",type:"info"},{default:t(()=>[d(" 详情: "+o(JSON.stringify(a.detail)),1)]),_:2},1024)])):z("",!0)])]),_:2},1032,["timestamp","type"]))),128))]),_:1})])])):(n(),p($e,{key:1,description:"暂无轨迹数据"}))])),[[te,i.timelineLoading]])]),_:1},8,["modelValue"])])}}}),Ql=ss(jl,[["__scopeId","data-v-381197a4"]]);export{Ql as default};
