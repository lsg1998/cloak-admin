import{d as M,h as v,P as Z,Z as ie,r as s,Q as de,c as re,o as j,b as e,w as l,_ as N,u as c,x as P,aq as R,e as d,E as K,W as ue,a as r,g as pe,t as V,ar as ce,as as me,U as _e,$ as fe,N as h,a0 as ge}from"./index-Dq1mQvu6.js";import{g as ve,d as be,u as ye,c as Ve}from"./domainConfig-zq6ie3HI.js";import{_ as he}from"./_plugin-vue_export-helper-DlAUqK2U.js";const we={class:"domain-config-management"},Ce={class:"card-header"},ze={class:"header-left"},xe={class:"table-actions"},ke={class:"domain-info"},Ue={class:"time-info"},De={class:"action-buttons"},Se={class:"pagination-wrapper"},Ae={class:"dialog-footer"},Ze=M({name:"DomainConfigList"}),Te=M({...Ze,setup($e){const k=v(!1),U=v(!1),b=v(!1),D=v(""),S=v(),m=Z({name:"",domain:"",is_active:null}),T=v([]),O=v([]),i=Z({page:1,size:20,total:0}),o=Z({id:null,name:"",domain:"",protocol:"https",is_active:1,sort_order:0,description:""}),F={name:[{required:!0,message:"请输入域名名称",trigger:"blur"}],domain:[{required:!0,message:"请输入域名地址",trigger:"blur"},{pattern:/^[a-zA-Z0-9][a-zA-Z0-9-]{0,61}[a-zA-Z0-9](\.[a-zA-Z0-9][a-zA-Z0-9-]{0,61}[a-zA-Z0-9])*$/,message:"请输入有效的域名格式",trigger:"blur"}],protocol:[{required:!0,message:"请选择协议",trigger:"change"}],is_active:[{required:!0,message:"请选择状态",trigger:"change"}]},g=async()=>{k.value=!0;try{const n={page:i.page,size:i.size,...m},t=await ve(n);T.value=t.data,i.total=t.data.length}catch(n){console.error("加载域名配置失败:",n),h.error("加载域名配置失败")}finally{k.value=!1}},C=()=>{i.page=1,g()},H=()=>{Object.assign(m,{name:"",domain:"",is_active:null}),C()},L=n=>{i.size=n,i.page=1,g()},I=n=>{i.page=n,g()},Q=n=>{O.value=n},W=()=>{D.value="新增域名配置",Y(),b.value=!0},G=n=>{D.value="编辑域名配置",Object.assign(o,{id:n.id,name:n.name,domain:n.domain,protocol:n.protocol,is_active:n.is_active,sort_order:n.sort_order,description:n.description||""}),b.value=!0},J=async n=>{try{await ge.confirm(`确定要删除域名配置"${n.name}"吗？`,"确认删除",{type:"warning"}),await be(n.id),h.success("删除成功"),g()}catch(t){t!=="cancel"&&(console.error("删除域名配置失败:",t),h.error("删除失败"))}},X=async()=>{if(S.value)try{if(await S.value.validate(),U.value=!0,o.id){const n={id:o.id,name:o.name,domain:o.domain,protocol:o.protocol,is_active:o.is_active,sort_order:o.sort_order,description:o.description};await ye(n),h.success("更新成功")}else{const n={name:o.name,domain:o.domain,protocol:o.protocol,is_active:o.is_active,sort_order:o.sort_order,description:o.description};await Ve(n),h.success("创建成功")}b.value=!1,g()}catch(n){console.error("提交失败:",n),h.error("操作失败")}finally{U.value=!1}},Y=()=>{Object.assign(o,{id:null,name:"",domain:"",protocol:"https",is_active:1,sort_order:0,description:""})};return ie(()=>{g()}),(n,t)=>{const u=s("el-icon"),w=s("el-input"),p=s("el-form-item"),z=s("el-option"),$=s("el-select"),f=s("el-button"),q=s("el-form"),B=s("el-card"),A=s("el-tag"),_=s("el-table-column"),ee=s("el-table"),le=s("el-pagination"),y=s("el-col"),x=s("el-row"),E=s("el-radio"),te=s("el-radio-group"),ae=s("el-input-number"),oe=s("el-dialog"),ne=de("loading");return j(),re("div",we,[e(B,{class:"search-card",shadow:"never"},{default:l(()=>[e(q,{model:m,inline:"",class:"search-form"},{default:l(()=>[e(p,{label:"域名名称"},{default:l(()=>[e(w,{modelValue:m.name,"onUpdate:modelValue":t[0]||(t[0]=a=>m.name=a),placeholder:"请输入域名名称",clearable:"",style:{width:"200px"},onKeyup:N(C,["enter"])},{prefix:l(()=>[e(u,null,{default:l(()=>[e(c(P))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(p,{label:"域名地址"},{default:l(()=>[e(w,{modelValue:m.domain,"onUpdate:modelValue":t[1]||(t[1]=a=>m.domain=a),placeholder:"请输入域名地址",clearable:"",style:{width:"200px"},onKeyup:N(C,["enter"])},{prefix:l(()=>[e(u,null,{default:l(()=>[e(c(R))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(p,{label:"状态"},{default:l(()=>[e($,{modelValue:m.is_active,"onUpdate:modelValue":t[2]||(t[2]=a=>m.is_active=a),placeholder:"请选择状态",clearable:"",style:{width:"120px"}},{default:l(()=>[e(z,{label:"启用",value:1}),e(z,{label:"禁用",value:0})]),_:1},8,["modelValue"])]),_:1}),e(p,null,{default:l(()=>[e(f,{type:"primary",onClick:C},{default:l(()=>[e(u,null,{default:l(()=>[e(c(P))]),_:1}),t[13]||(t[13]=d(" 搜索 ",-1))]),_:1}),e(f,{onClick:H},{default:l(()=>[e(u,null,{default:l(()=>[e(c(K))]),_:1}),t[14]||(t[14]=d(" 重置 ",-1))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(B,{class:"table-card",shadow:"never"},{header:l(()=>[r("div",Ce,[r("div",ze,[t[15]||(t[15]=r("span",null,"域名配置列表",-1)),e(A,{type:"info",size:"small"},{default:l(()=>[d(V(i.total)+" 条记录",1)]),_:1})]),r("div",xe,[e(f,{type:"primary",onClick:W},{default:l(()=>[e(u,null,{default:l(()=>[e(c(fe))]),_:1}),t[16]||(t[16]=d(" 新增域名 ",-1))]),_:1}),e(f,{size:"small",onClick:g},{default:l(()=>[e(u,null,{default:l(()=>[e(c(K))]),_:1}),t[17]||(t[17]=d(" 刷新 ",-1))]),_:1})])])]),default:l(()=>[ue((j(),pe(ee,{data:T.value,stripe:"",border:"",style:{width:"100%"},onSelectionChange:Q},{default:l(()=>[e(_,{type:"selection",width:"55",align:"center"}),e(_,{prop:"name",label:"域名名称",width:"150","show-overflow-tooltip":""}),e(_,{prop:"domain",label:"域名地址",width:"200","show-overflow-tooltip":""},{default:l(({row:a})=>[r("div",ke,[e(u,null,{default:l(()=>[e(c(R))]),_:1}),r("span",null,V(a.protocol)+"://"+V(a.domain),1)])]),_:1}),e(_,{prop:"protocol",label:"协议",width:"80",align:"center"},{default:l(({row:a})=>[e(A,{type:a.protocol==="https"?"success":"warning",size:"small"},{default:l(()=>[d(V(a.protocol.toUpperCase()),1)]),_:2},1032,["type"])]),_:1}),e(_,{prop:"is_active",label:"状态",width:"100",align:"center"},{default:l(({row:a})=>[e(A,{type:a.is_active?"success":"info",size:"small",effect:"light"},{default:l(()=>[d(V(a.is_active?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),e(_,{prop:"sort_order",label:"排序",width:"80",align:"center"}),e(_,{prop:"description",label:"描述","min-width":"200","show-overflow-tooltip":""}),e(_,{prop:"created_at",label:"创建时间",width:"180","show-overflow-tooltip":""},{default:l(({row:a})=>[r("div",Ue,[e(u,{class:"time-icon"},{default:l(()=>[e(c(ce))]),_:1}),r("span",null,V(a.created_at),1)])]),_:1}),e(_,{label:"操作",width:"200",align:"center",fixed:"right"},{default:l(({row:a})=>[r("div",De,[e(f,{size:"small",type:"primary",link:"",onClick:se=>G(a)},{default:l(()=>[e(u,null,{default:l(()=>[e(c(me))]),_:1}),t[18]||(t[18]=d(" 编辑 ",-1))]),_:1},8,["onClick"]),e(f,{size:"small",type:"danger",link:"",onClick:se=>J(a)},{default:l(()=>[e(u,null,{default:l(()=>[e(c(_e))]),_:1}),t[19]||(t[19]=d(" 删除 ",-1))]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["data"])),[[ne,k.value]]),r("div",Se,[e(le,{"current-page":i.page,"onUpdate:currentPage":t[3]||(t[3]=a=>i.page=a),"page-size":i.size,"onUpdate:pageSize":t[4]||(t[4]=a=>i.size=a),"page-sizes":[10,20,50,100],total:i.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:L,onCurrentChange:I},null,8,["current-page","page-size","total"])])]),_:1}),e(oe,{modelValue:b.value,"onUpdate:modelValue":t[12]||(t[12]=a=>b.value=a),title:D.value,width:"600px","close-on-click-modal":!1,"destroy-on-close":""},{footer:l(()=>[r("div",Ae,[e(f,{onClick:t[11]||(t[11]=a=>b.value=!1)},{default:l(()=>[...t[22]||(t[22]=[d("取消",-1)])]),_:1}),e(f,{type:"primary",onClick:X,loading:U.value},{default:l(()=>[...t[23]||(t[23]=[d(" 确定 ",-1)])]),_:1},8,["loading"])])]),default:l(()=>[e(q,{model:o,rules:F,ref_key:"formRef",ref:S,"label-width":"100px"},{default:l(()=>[e(x,{gutter:20},{default:l(()=>[e(y,{span:12},{default:l(()=>[e(p,{label:"域名名称",prop:"name"},{default:l(()=>[e(w,{modelValue:o.name,"onUpdate:modelValue":t[5]||(t[5]=a=>o.name=a),placeholder:"请输入域名名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(y,{span:12},{default:l(()=>[e(p,{label:"协议",prop:"protocol"},{default:l(()=>[e($,{modelValue:o.protocol,"onUpdate:modelValue":t[6]||(t[6]=a=>o.protocol=a),placeholder:"请选择协议",style:{width:"100%"}},{default:l(()=>[e(z,{label:"HTTPS",value:"https"}),e(z,{label:"HTTP",value:"http"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(x,{gutter:20},{default:l(()=>[e(y,{span:24},{default:l(()=>[e(p,{label:"域名地址",prop:"domain"},{default:l(()=>[e(w,{modelValue:o.domain,"onUpdate:modelValue":t[7]||(t[7]=a=>o.domain=a),placeholder:"请输入域名地址，如：example.com"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(x,{gutter:20},{default:l(()=>[e(y,{span:12},{default:l(()=>[e(p,{label:"状态",prop:"is_active"},{default:l(()=>[e(te,{modelValue:o.is_active,"onUpdate:modelValue":t[8]||(t[8]=a=>o.is_active=a)},{default:l(()=>[e(E,{value:1},{default:l(()=>[...t[20]||(t[20]=[d("启用",-1)])]),_:1}),e(E,{value:0},{default:l(()=>[...t[21]||(t[21]=[d("禁用",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(y,{span:12},{default:l(()=>[e(p,{label:"排序",prop:"sort_order"},{default:l(()=>[e(ae,{modelValue:o.sort_order,"onUpdate:modelValue":t[9]||(t[9]=a=>o.sort_order=a),min:0,max:999,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(x,{gutter:20},{default:l(()=>[e(y,{span:24},{default:l(()=>[e(p,{label:"描述",prop:"description"},{default:l(()=>[e(w,{modelValue:o.description,"onUpdate:modelValue":t[10]||(t[10]=a=>o.description=a),type:"textarea",rows:3,placeholder:"请输入域名描述（可选）"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),je=he(Te,[["__scopeId","data-v-42d840f8"]]);export{je as default};
