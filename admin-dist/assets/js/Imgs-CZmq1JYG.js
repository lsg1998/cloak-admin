import{d as z,af as q,h as w,ag as G,D as S,ah as F,ai as M,s as N,r,c as y,o as f,b as s,a as o,g as P,R as U,n as Z,w as p,F as J,q as H,a7 as C,a6 as g,a8 as O,u as Q,$ as W}from"./index-Ch2GYJpF.js";import{u as K}from"./upload-FsD5psBo.js";import{_ as x}from"./_plugin-vue_export-helper-DlAUqK2U.js";const X={class:"upload-box"},Y=["src"],ee={key:1,class:"upload-empty"},le={class:"el-upload__tip"},te=z({name:"UploadImg"}),ae=z({...te,props:{imageUrl:{default:""},api:{},drag:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},fileSize:{default:5},fileType:{default:()=>["image/jpeg","image/png","image/gif"]},height:{default:"150px"},width:{default:"150px"},borderRadius:{default:"8px"}},emits:["update:imageUrl"],setup(n,{emit:E}){q(a=>({v10fcd1c8:a.width,v423b5ade:a.height,v6156f470:a.borderRadius}));const i=n,m=w("id-"+G()),v=w(!1),c=S(F,void 0),d=S(M,void 0),b=N(()=>i.disabled||(c==null?void 0:c.disabled)),k=E,$=async a=>{let t=new FormData;t.append("file",a.file);try{const e=i.api??K,{data:l}=await e(t);k("update:imageUrl",l.fileUrl),d!=null&&d.prop&&(c==null||c.validateField([d.prop]))}catch(e){a.onError(e)}},D=()=>{k("update:imageUrl","")},T=()=>{const a=document.querySelector(`#${m.value} .el-upload__input`);a&&a.dispatchEvent(new MouseEvent("click"))},B=a=>{const t=a.size/1024/1024<i.fileSize,e=i.fileType.includes(a.type);return e||g({title:"温馨提示",message:"上传图片不符合所需的格式！",type:"warning"}),t||setTimeout(()=>{g({title:"温馨提示",message:`上传图片大小不能超过 ${i.fileSize}M！`,type:"warning"})},0),e&&t},L=()=>{g({title:"温馨提示",message:"图片上传成功！",type:"success"})},I=()=>{g({title:"温馨提示",message:"图片上传失败，请您重新上传！",type:"error"})};return(a,t)=>{const e=r("Edit"),l=r("el-icon"),u=r("ZoomIn"),h=r("Delete"),V=r("Plus"),R=r("el-upload"),j=r("el-image-viewer");return f(),y("div",X,[s(R,{id:m.value,action:"#",class:Z(["upload",b.value?"disabled":"",n.drag?"no-border":""]),multiple:!1,disabled:b.value,"show-file-list":!1,"http-request":$,"before-upload":B,"on-success":L,"on-error":I,drag:n.drag,accept:n.fileType.join(",")},{default:p(()=>[n.imageUrl?(f(),y(J,{key:0},[o("img",{src:n.imageUrl,class:"upload-image"},null,8,Y),o("div",{class:"upload-handle",onClick:t[1]||(t[1]=H(()=>{},["stop"]))},[b.value?U("",!0):(f(),y("div",{key:0,class:"handle-icon",onClick:T},[s(l,null,{default:p(()=>[s(e)]),_:1}),t[3]||(t[3]=o("span",null,"编辑",-1))])),o("div",{class:"handle-icon",onClick:t[0]||(t[0]=_=>v.value=!0)},[s(l,null,{default:p(()=>[s(u)]),_:1}),t[4]||(t[4]=o("span",null,"查看",-1))]),b.value?U("",!0):(f(),y("div",{key:1,class:"handle-icon",onClick:D},[s(l,null,{default:p(()=>[s(h)]),_:1}),t[5]||(t[5]=o("span",null,"删除",-1))]))])],64)):(f(),y("div",ee,[C(a.$slots,"empty",{},()=>[s(l,null,{default:p(()=>[s(V)]),_:1})],!0)]))]),_:3},8,["id","class","disabled","drag","accept"]),o("div",le,[C(a.$slots,"tip",{},void 0,!0)]),v.value?(f(),P(j,{key:0,"url-list":[n.imageUrl],onClose:t[2]||(t[2]=_=>v.value=!1)},null,8,["url-list"])):U("",!0)])}}}),ge=x(ae,[["__scopeId","data-v-0fe19d29"]]),se={class:"upload-box"},ie={class:"upload-empty"},oe=["src"],ne=["onClick"],de=["onClick"],ue={class:"el-upload__tip"},re=z({name:"UploadImgs"}),ce=z({...re,props:{fileList:{default:()=>[]},api:{},drag:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},limit:{default:5},fileSize:{default:5},fileType:{default:()=>["image/jpeg","image/png","image/gif"]},height:{default:"150px"},width:{default:"150px"},borderRadius:{default:"8px"}},emits:["update:fileList"],setup(n,{emit:E}){q(e=>({v933ef43e:e.borderRadius,v1db09123:e.width,v7e92996a:e.height}));const i=n,m=S(F,void 0),v=S(M,void 0),c=N(()=>i.disabled||(m==null?void 0:m.disabled)),d=w(i.fileList);O(()=>i.fileList,e=>{d.value=e});const b=e=>{const l=e.size/1024/1024<i.fileSize,u=i.fileType.includes(e.type);return u||g({title:"温馨提示",message:"上传图片不符合所需的格式！",type:"warning"}),l||setTimeout(()=>{g({title:"温馨提示",message:`上传图片大小不能超过 ${i.fileSize}M！`,type:"warning"})},0),u&&l},k=async e=>{let l=new FormData;l.append("file",e.file);try{const u=i.api??K,{data:h}=await u(l);e.onSuccess(h)}catch(u){e.onError(u)}},$=E,D=(e,l)=>{e&&(l.url=e.fileUrl,$("update:fileList",d.value),v!=null&&v.prop&&(m==null||m.validateField([v.prop])),g({title:"温馨提示",message:"图片上传成功！",type:"success"}))},T=e=>{d.value=d.value.filter(l=>l.url!==e.url||l.name!==e.name),$("update:fileList",d.value)},B=()=>{g({title:"温馨提示",message:"图片上传失败，请您重新上传！",type:"error"})},L=()=>{g({title:"温馨提示",message:`当前最多只能上传 ${i.limit} 张图片，请移除后上传！`,type:"warning"})},I=w(""),a=w(!1),t=e=>{I.value=e.url,a.value=!0};return(e,l)=>{const u=r("el-icon"),h=r("ZoomIn"),V=r("Delete"),R=r("el-upload"),j=r("el-image-viewer");return f(),y("div",se,[s(R,{"file-list":d.value,"onUpdate:fileList":l[1]||(l[1]=_=>d.value=_),action:"#","list-type":"picture-card",class:Z(["upload",c.value?"disabled":"",n.drag?"no-border":""]),multiple:!0,disabled:c.value,limit:n.limit,"http-request":k,"before-upload":b,"on-exceed":L,"on-success":D,"on-error":B,drag:n.drag,accept:n.fileType.join(",")},{file:p(({file:_})=>[o("img",{src:_.url,class:"upload-image"},null,8,oe),o("div",{class:"upload-handle",onClick:l[0]||(l[0]=H(()=>{},["stop"]))},[o("div",{class:"handle-icon",onClick:A=>t(_)},[s(u,null,{default:p(()=>[s(h)]),_:1}),l[3]||(l[3]=o("span",null,"查看",-1))],8,ne),c.value?U("",!0):(f(),y("div",{key:0,class:"handle-icon",onClick:A=>T(_)},[s(u,null,{default:p(()=>[s(V)]),_:1}),l[4]||(l[4]=o("span",null,"删除",-1))],8,de))])]),default:p(()=>[o("div",ie,[C(e.$slots,"empty",{},()=>[s(u,null,{default:p(()=>[s(Q(W))]),_:1})],!0)])]),_:3},8,["file-list","class","disabled","limit","drag","accept"]),o("div",ue,[C(e.$slots,"tip",{},void 0,!0)]),a.value?(f(),P(j,{key:0,"url-list":[I.value],onClose:l[2]||(l[2]=_=>a.value=!1)},null,8,["url-list"])):U("",!0)])}}}),ve=x(ce,[["__scopeId","data-v-974aeb38"]]);export{ve as U,ge as a};
