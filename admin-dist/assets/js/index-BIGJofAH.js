import{d as R,h as u,Z as T,aE as A,r as d,Q as D,g as N,o as g,w as c,W as B,c as x,a as e,e as F,t as _,R as L,b as t,u as U,E as M,M as $,N as H}from"./index-9AIO1u2x.js";import"./index-BpCvQqaw.js";import{g as I}from"./statistics-DZYbVN7W.js";import{aU as O}from"./installCanvasRenderer-Bf4uGEF_.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Q={class:"card-header"},W={class:"header-actions"},Z={class:"traffic-content"},j={class:"hourly-chart"},q={class:"section-title"},G={class:"timezone-label"},J={class:"stats-inline"},K={class:"total-visits-inline"},X={key:0,class:"peak-inline"},Y=R({__name:"index",setup(ee){const v=u(!1),r=u("24h"),p=u("Asia/Shanghai"),n=u({total_visits:0,source_stats:[],hourly_stats:[],daily_stats:[],peak_hour:0,peak_count:0,low_hour:null,low_count:0}),f=u();let o=null;const w=a=>`${a.toString().padStart(2,"0")}:00`,k=()=>{if(!f.value)return;o=O(f.value);const a=n.value.hourly_stats.map(l=>l.label),s=n.value.hourly_stats.map(l=>l.count),i={tooltip:{trigger:"axis",formatter:l=>{const m=l[0];return`${m.name}<br/>访问量: ${m.value}`}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:a,axisLabel:{rotate:45,interval:r.value==="24h"?2:0}},yAxis:{type:"value",name:"访问量"},series:[{name:"访问量",type:"line",data:s,smooth:!0,itemStyle:{color:"#409EFF"},lineStyle:{color:"#409EFF",width:2},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(64, 158, 255, 0.3)"},{offset:1,color:"rgba(64, 158, 255, 0.1)"}]}},emphasis:{itemStyle:{color:"#66b1ff"}}}]};o.setOption(i),window.addEventListener("resize",b)},b=()=>{o&&o.resize()},C=()=>{h()},S=()=>{h()},h=async()=>{v.value=!0;try{const a=await I({timeRange:r.value,timezone:p.value});a.code===200&&(n.value=a.data,await $(),o&&o.dispose(),k())}catch(a){console.error("加载流量统计数据失败:",a),H.error("加载流量统计数据失败")}finally{v.value=!1}};return T(()=>{h()}),A(()=>{o&&o.dispose(),window.removeEventListener("resize",b)}),(a,s)=>{const i=d("el-option"),l=d("el-select"),m=d("el-icon"),z=d("el-button"),V=d("el-card"),E=D("loading");return g(),N(V,{class:"traffic-statistics-card",shadow:"never"},{header:c(()=>[e("div",Q,[s[2]||(s[2]=e("span",null,"流量统计",-1)),e("div",W,[t(l,{modelValue:p.value,"onUpdate:modelValue":s[0]||(s[0]=y=>p.value=y),size:"small",onChange:C,style:{width:"140px","margin-right":"8px"}},{default:c(()=>[t(i,{label:"北京时间",value:"Asia/Shanghai"}),t(i,{label:"欧洲时间",value:"Europe/Paris"})]),_:1},8,["modelValue"]),t(l,{modelValue:r.value,"onUpdate:modelValue":s[1]||(s[1]=y=>r.value=y),size:"small",onChange:S,style:{width:"120px"}},{default:c(()=>[t(i,{label:"最近24小时",value:"24h"}),t(i,{label:"最近7天",value:"7d"}),t(i,{label:"最近30天",value:"30d"})]),_:1},8,["modelValue"]),t(z,{type:"primary",size:"small",onClick:h},{default:c(()=>[t(m,null,{default:c(()=>[t(U(M))]),_:1})]),_:1})])])]),default:c(()=>[B((g(),x("div",Z,[e("div",j,[e("div",q,[e("span",null,[F(_(r.value==="24h"?"24小时":r.value==="7d"?"7天":"30天")+"流量趋势 ",1),e("span",G,"("+_(p.value==="Asia/Shanghai"?"北京时间":"欧洲时间")+")",1)]),e("span",J,[e("span",K,"总访问量："+_(n.value.total_visits||0),1),n.value.peak_hour!==void 0?(g(),x("span",X," 峰值时段："+_(w(n.value.peak_hour))+" ("+_(n.value.peak_count)+"次访问) ",1)):L("",!0)])]),e("div",{ref_key:"hourlyChartRef",ref:f,class:"chart-container"},null,512)])])),[[E,v.value]])]),_:1})}}}),ne=P(Y,[["__scopeId","data-v-564a6708"]]);export{ne as T};
