import{a5 as S,d as je,h as v,P as oe,Z as Qe,r as p,Q as Ge,c as d,o as i,b as t,w as a,_ as We,g as x,q as fe,u as z,aQ as qe,x as ve,e as c,aR as He,a as l,t as n,aM as Je,aG as Ze,be as Xe,bf as Ye,W as ie,E as me,F as ge,f as ye,n as et,R as P,as as tt,aD as st,N as g,a0 as at}from"./index-BfIcwMEJ.js";import{g as lt}from"./product-4KaWHM5J.js";import{_ as ot}from"./_plugin-vue_export-helper-DlAUqK2U.js";const K={getVisitorIps:y=>S.get("/admin/statistics/visitor-ips",y),getVisitorIp:y=>S.get(`/admin/statistics/visitor-ips/${y}`),getIpStatistics:()=>S.get("/admin/statistics/visitor-ips-stats"),deleteVisitorIp:y=>S.delete(`/admin/statistics/visitor-ips/${y}`),syncBehaviorData:()=>S.post("/admin/statistics/sync-behavior-data")},be={getSummary:y=>S.get("/admin/user-behavior/summary",y),getTimeline:y=>S.get("/admin/user-behavior/timeline",y),fetchFromRedis:y=>S.get("/admin/user-behavior/fetch-from-redis",{ip:y})},it={class:"visitor-ip-list"},nt={class:"stat-content"},rt={class:"stat-value"},dt={class:"stat-icon"},ut={class:"stat-content"},ct={class:"stat-value"},pt={class:"stat-icon"},_t={class:"stat-content"},ft={class:"stat-value"},vt={class:"stat-icon"},mt={class:"stat-content"},gt={class:"stat-value"},yt={class:"stat-icon"},bt={class:"table-header"},ht={class:"table-actions"},kt={class:"ip-list"},zt={class:"ip-header"},Ct={class:"ip-address"},xt={class:"ip-actions"},It={class:"ip-content"},Vt={class:"ip-section"},wt={class:"address-info"},St={class:"address-line"},Pt={class:"value"},Tt={class:"address-line"},Lt={class:"value"},Dt={class:"address-line"},Bt=["title"],At={class:"ip-section"},Rt={class:"organization-info"},Mt={class:"org-name"},Ut={class:"org-tags"},Nt={class:"ip-section"},Ft={class:"basic-type"},$t={class:"type-line"},Ot={class:"type-line"},Kt={class:"value"},Et={class:"type-line"},jt={class:"value"},Qt={class:"type-line"},Gt={key:1,class:"value"},Wt={class:"ip-section"},qt={class:"behavior-info"},Ht={class:"behavior-summary"},Jt={key:0,class:"duration-text"},Zt={key:1,class:"no-data-text"},Xt={class:"behavior-actions"},Yt={key:0,class:"ip-section"},es={class:"detailed-type"},ts={class:"type-line"},ss={class:"type-line"},as={class:"value"},ls={class:"type-line"},os={class:"value"},is={class:"pagination-wrapper"},ns={class:"product-select-dialog"},rs={key:0,class:"ip-detail"},ds={key:0},us={key:1,class:"text-gray-400"},cs={key:0},ps={key:1,class:"text-gray-400"},_s={key:0},fs={key:1,class:"text-gray-400"},vs={key:0},ms={key:1,class:"text-gray-400"},gs={key:0},ys={key:1,class:"text-gray-400"},bs={key:0},hs={key:1,class:"text-gray-400"},ks={key:0},zs={key:1,class:"text-gray-400"},Cs={key:0},xs={key:1,class:"text-gray-400"},Is={key:0,class:"referer-info"},Vs={key:1,class:"text-gray-400"},ws={key:0,class:"location-info"},Ss={class:"timeline-container"},Ps={key:0,class:"timeline-content"},Ts={class:"timeline-header"},Ls={class:"timeline-list"},Ds={class:"timeline-item-content"},Bs={class:"action-description"},As={class:"action-text"},Rs={key:0,class:"action-detail"},Ms=je({__name:"index",setup(y){const E=v(!1),j=v(!1),Q=v(!1),u=v(null),G=v(!1),W=v(!1),C=v(null),b=oe({ip:"",timeRange:"",visitorType:"",productId:""}),R=v(!1),q=v(!1),H=v([]),M=v([]),U=v(""),L=v(""),I=oe({page:1,size:20,total:0}),h=oe({page:1,size:20,total:0}),J=v([]),D=v({totalIps:0,todayIps:0,totalCountries:0,totalCities:0,countryStats:[],cityStats:[]}),Z=s=>s?new Date(s).toLocaleString("zh-CN"):"--",he=s=>{const e=[];return s.country&&e.push(s.country),s.region&&e.push(s.region),s.city&&e.push(s.city),e.length>0?e.join(" - "):null},N=s=>{const e=["proxy","vpn","tor","anonymizer"],r=(s.organization||"").toLowerCase();return e.some(f=>r.includes(f))},ke=s=>{const e=["amazon","google","microsoft","cloudflare","digitalocean","linode","vultr","aws","gcp","azure"],r=(s.organization||"").toLowerCase();return e.some(f=>r.includes(f))},ne=s=>B(s)?"爬虫":N(s)?"代理":"访客",re=s=>B(s)?"primary":N(s)?"warning":"success",X=s=>{const e=["google","facebook","twitter","linkedin","microsoft","bytedance","tiktok"],r=(s.organization||"").toLowerCase(),f=(s.user_agent||"").trim(),k=e.some(m=>r.includes(m)),F=!f||f.length<20;return k&&F},B=s=>{if(X(s))return!0;const e=["bot","crawler","spider","scraper","crawl","googlebot","bingbot","slurp","duckduckbot","facebook","facebookexternalhit","facebot","twitter","twitterbot","linkedin","linkedinbot","whatsapp","telegrambot","bytedance","bytespider","semrush","ahrefs","mj12bot","petalbot","yandex","baidu"],r=(s.user_agent||"").toLowerCase(),f=(s.organization||"").toLowerCase();return e.some(k=>r.includes(k)||f.includes(k))},ze=s=>{const e=s.user_agent||"";return e.includes("Mobile")?"Mobile":e.includes("Tablet")?"Tablet":e.includes("Desktop")?"Desktop":null},Ce=s=>{const e=s.user_agent||"";return e.includes("Android")?"Android":e.includes("iOS")||e.includes("iPhone")||e.includes("iPad")?"iOS":e.includes("Windows")?"Windows":e.includes("Mac")?"macOS":e.includes("Linux")?"Linux":null},xe=s=>{const e=(s.user_agent||"").toLowerCase(),r=(s.organization||"").toLowerCase();return X(s)?r.includes("google")?"Google 审核爬虫":r.includes("facebook")?"Facebook 审核爬虫":r.includes("twitter")?"Twitter 审核爬虫":r.includes("linkedin")?"LinkedIn 审核爬虫":r.includes("microsoft")?"Microsoft 审核爬虫":r.includes("bytedance")||r.includes("tiktok")?"TikTok 审核爬虫":"审核爬虫":e.includes("googlebot")||r.includes("google")&&e.includes("bot")?"Googlebot":e.includes("bingbot")||r.includes("microsoft")&&e.includes("bot")?"BingBot":e.includes("facebook")?"Facebook Crawler":e.includes("twitter")?"Twitter Bot":e.includes("ahrefs")||r.includes("ahrefs")?"aHrefs Bot":e.includes("httpx")?"httpx":e.includes("barkrowler")?"Barkrowler":B(s)?"通用爬虫":null},Ie=s=>{const e=(s.user_agent||"").toLowerCase(),r=(s.organization||"").toLowerCase();return X(s)?"广告/内容合规审核（无UA或异常UA）":e.includes("googlebot")||r.includes("google")&&e.includes("bot")||e.includes("bingbot")||r.includes("microsoft")&&e.includes("bot")?"搜索引擎蜘蛛":e.includes("facebook")||e.includes("twitter")?"社交媒体爬虫":e.includes("ahrefs")||r.includes("ahrefs")?"SEO分析爬虫":B(s)?"通用网络爬虫":null},A=async()=>{try{E.value=!0;const s={page:h.page,size:h.size,...b},e=await K.getVisitorIps(s);e.code===200&&(J.value=e.data.list,h.total=e.data.total)}catch(s){console.error("获取访客IP列表失败:",s),g.error("获取访客IP列表失败")}finally{E.value=!1}},Y=async()=>{try{const s=await K.getIpStatistics();s.code===200&&(D.value=s.data)}catch(s){console.error("获取统计数据失败:",s),g.error("获取统计数据失败")}},ee=()=>{h.page=1,A()},Ve=()=>{Object.assign(b,{ip:"",timeRange:"",visitorType:"",productId:""}),L.value="",ee()},te=async()=>{try{q.value=!0;const{data:s}=await lt({page:I.page,size:I.size});H.value=s.list||[],M.value=s.list||[],I.total=s.total||0}catch{g.error("加载商品列表失败")}finally{q.value=!1}},we=()=>{if(!U.value){M.value=H.value;return}const s=U.value.toLowerCase();M.value=H.value.filter(e=>{var r,f;return((r=e.title)==null?void 0:r.toLowerCase().includes(s))||((f=e.spu_id)==null?void 0:f.toLowerCase().includes(s))})},de=s=>{b.productId=s.spu_id,L.value=s.title,R.value=!1,g.success(`已选择商品: ${s.title}`)},Se=()=>{b.productId="",L.value=""},Pe=async()=>{try{await at.confirm("确定要同步Redis中的用户行为数据到MySQL吗？","同步确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),j.value=!0;const{data:s}=await K.syncBehaviorData();s.successCount>0?(g.success(`同步完成！成功: ${s.successCount} 条，失败: ${s.failCount} 条`),await Promise.all([A(),Y()])):g.info("没有数据需要同步")}catch(s){s!=="cancel"&&g.error(s.message||"同步失败")}finally{j.value=!1}},Te=s=>{h.size=s,h.page=1,A()},Le=s=>{h.page=s,A()},De=async s=>{try{const e=await K.getVisitorIp(s.ip_address);e.code===200&&(u.value=e.data,Q.value=!0)}catch(e){console.error("获取IP详情失败:",e),g.error("获取IP详情失败")}},Be=async s=>{try{const e=await be.fetchFromRedis(s.ip_address);e.code===200&&(e.data?(s.behaviorSummary=e.data,g.success("获取成功（来自Redis）")):g.info("Redis中暂无该IP的轨迹数据"))}catch(e){console.error("从Redis获取数据失败:",e),g.error("获取失败")}},Ae=async s=>{try{if(!s.behaviorSummary){g.warning("该IP暂无行为轨迹数据");return}W.value=!0,G.value=!0,C.value=null;const e={sessionId:s.behaviorSummary.sessionId,ip:s.ip_address,productId:s.behaviorSummary.productId,date:s.behaviorSummary.visitDate.replace(/-/g,"")},r=await be.getTimeline(e);r.code===200&&(C.value=r.data)}catch(e){console.error("获取用户行为轨迹失败:",e),g.error("获取用户行为轨迹失败")}finally{W.value=!1}},Re=s=>({enter:"success",leave:"info",scroll:"primary",click_sku:"warning",select_province:"warning",select_city:"warning",fill_name:"warning",fill_phone:"warning",submit_order:"danger",order_success:"success",order_fail:"danger"})[s]||"info",Me=s=>({enter:"success",leave:"info",scroll:"",click_sku:"warning",select_province:"primary",select_city:"primary",fill_name:"warning",fill_phone:"warning",submit_order:"danger",order_success:"success",order_fail:"danger"})[s]||"info";return Qe(()=>{A(),Y(),te()}),(s,e)=>{const r=p("el-input"),f=p("el-form-item"),k=p("el-option"),F=p("el-select"),m=p("el-icon"),V=p("el-button"),Ue=p("el-form"),T=p("el-card"),$=p("el-col"),Ne=p("el-row"),w=p("el-tag"),ue=p("el-pagination"),se=p("el-table-column"),Fe=p("el-table"),ae=p("el-dialog"),_=p("el-descriptions-item"),$e=p("el-link"),ce=p("el-descriptions"),O=p("el-text"),Oe=p("el-timeline-item"),Ke=p("el-timeline"),Ee=p("el-empty"),le=Ge("loading");return i(),d("div",it,[t(T,{class:"search-card",shadow:"never"},{default:a(()=>[t(Ue,{model:b,inline:!0,class:"search-form"},{default:a(()=>[t(f,{label:"IP地址"},{default:a(()=>[t(r,{modelValue:b.ip,"onUpdate:modelValue":e[0]||(e[0]=o=>b.ip=o),placeholder:"请输入IP地址",clearable:"",style:{width:"200px"},onKeyup:We(ee,["enter"])},null,8,["modelValue"])]),_:1}),t(f,{label:"时间筛选"},{default:a(()=>[t(F,{modelValue:b.timeRange,"onUpdate:modelValue":e[1]||(e[1]=o=>b.timeRange=o),placeholder:"请选择时间范围",clearable:"",style:{width:"150px"}},{default:a(()=>[t(k,{label:"当天",value:"today"}),t(k,{label:"昨天",value:"yesterday"}),t(k,{label:"本周",value:"week"}),t(k,{label:"本月",value:"month"})]),_:1},8,["modelValue"])]),_:1}),t(f,{label:"访客类型"},{default:a(()=>[t(F,{modelValue:b.visitorType,"onUpdate:modelValue":e[2]||(e[2]=o=>b.visitorType=o),placeholder:"请选择类型",clearable:"",style:{width:"150px"}},{default:a(()=>[t(k,{label:"访客",value:"visitor"}),t(k,{label:"爬虫",value:"bot"}),t(k,{label:"代理",value:"proxy"})]),_:1},8,["modelValue"])]),_:1}),t(f,{label:"商品筛选"},{default:a(()=>[t(r,{modelValue:L.value,"onUpdate:modelValue":e[3]||(e[3]=o=>L.value=o),placeholder:"点击选择商品",readonly:"",style:{width:"200px"},onClick:e[4]||(e[4]=o=>R.value=!0)},{suffix:a(()=>[b.productId?(i(),x(m,{key:0,onClick:fe(Se,["stop"]),style:{cursor:"pointer"}},{default:a(()=>[t(z(qe))]),_:1})):(i(),x(m,{key:1},{default:a(()=>[t(z(ve))]),_:1}))]),_:1},8,["modelValue"])]),_:1}),t(f,null,{default:a(()=>[t(V,{type:"primary",onClick:ee},{default:a(()=>[...e[13]||(e[13]=[c("搜索",-1)])]),_:1}),t(V,{onClick:Ve},{default:a(()=>[...e[14]||(e[14]=[c("重置",-1)])]),_:1}),t(V,{type:"success",onClick:Pe,loading:j.value},{default:a(()=>[t(m,null,{default:a(()=>[t(z(He))]),_:1}),e[15]||(e[15]=c(" 一键同步轨迹 ",-1))]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1}),t(Ne,{gutter:20,class:"statistics-cards"},{default:a(()=>[t($,{span:6},{default:a(()=>[t(T,{class:"stat-card"},{default:a(()=>[l("div",nt,[l("div",rt,n(D.value.totalIps),1),e[16]||(e[16]=l("div",{class:"stat-label"},"总IP数",-1))]),l("div",dt,[t(m,null,{default:a(()=>[t(z(Je))]),_:1})])]),_:1})]),_:1}),t($,{span:6},{default:a(()=>[t(T,{class:"stat-card"},{default:a(()=>[l("div",ut,[l("div",ct,n(D.value.todayIps),1),e[17]||(e[17]=l("div",{class:"stat-label"},"今日新增",-1))]),l("div",pt,[t(m,null,{default:a(()=>[t(z(Ze))]),_:1})])]),_:1})]),_:1}),t($,{span:6},{default:a(()=>[t(T,{class:"stat-card"},{default:a(()=>[l("div",_t,[l("div",ft,n(D.value.totalCountries),1),e[18]||(e[18]=l("div",{class:"stat-label"},"涉及国家",-1))]),l("div",vt,[t(m,null,{default:a(()=>[t(z(Xe))]),_:1})])]),_:1})]),_:1}),t($,{span:6},{default:a(()=>[t(T,{class:"stat-card"},{default:a(()=>[l("div",mt,[l("div",gt,n(D.value.totalCities),1),e[19]||(e[19]=l("div",{class:"stat-label"},"涉及城市",-1))]),l("div",yt,[t(m,null,{default:a(()=>[t(z(Ye))]),_:1})])]),_:1})]),_:1})]),_:1}),t(T,{class:"table-card",shadow:"never"},{default:a(()=>[l("div",bt,[e[21]||(e[21]=l("div",{class:"table-title"},"访客IP列表",-1)),l("div",ht,[t(V,{onClick:Y},{default:a(()=>[t(m,null,{default:a(()=>[t(z(me))]),_:1}),e[20]||(e[20]=c(" 刷新统计 ",-1))]),_:1})])]),ie((i(),d("div",kt,[(i(!0),d(ge,null,ye(J.value,(o,pe)=>(i(),d("div",{key:o.id,class:et(["ip-item",{"last-item":pe===J.value.length-1}])},[l("div",zt,[l("div",Ct,n(o.ip_address),1),l("div",xt,[t(V,{type:"primary",size:"small",onClick:_e=>De(o)},{default:a(()=>[...e[22]||(e[22]=[c("查看",-1)])]),_:1},8,["onClick"])])]),l("div",It,[l("div",Vt,[e[26]||(e[26]=l("div",{class:"section-title"},"地址信息",-1)),l("div",wt,[l("div",St,[e[23]||(e[23]=l("span",{class:"label"},"地址:",-1)),l("span",Pt,n(he(o)||"-"),1)]),l("div",Tt,[e[24]||(e[24]=l("span",{class:"label"},"时间:",-1)),l("span",Lt,n(Z(o.last_visit)),1)]),l("div",Dt,[e[25]||(e[25]=l("span",{class:"label"},"来源:",-1)),l("span",{class:"value referer",title:o.referer||"-"},n(o.referer||"-"),9,Bt)])])]),l("div",At,[e[29]||(e[29]=l("div",{class:"section-title"},"组织信息",-1)),l("div",Rt,[l("div",Mt,n(o.organization||"-"),1),l("div",Ut,[N(o)?(i(),x(w,{key:0,size:"small",type:"info"},{default:a(()=>[...e[27]||(e[27]=[c("代理",-1)])]),_:1})):P("",!0),ke(o)?(i(),x(w,{key:1,size:"small",type:"warning"},{default:a(()=>[...e[28]||(e[28]=[c("机房",-1)])]),_:1})):P("",!0)])])]),l("div",Nt,[e[34]||(e[34]=l("div",{class:"section-title"},"基础类型",-1)),l("div",Ft,[l("div",$t,[e[30]||(e[30]=l("span",{class:"label"},"类型:",-1)),t(w,{type:re(o),size:"small"},{default:a(()=>[c(n(ne(o)),1)]),_:2},1032,["type"])]),l("div",Ot,[e[31]||(e[31]=l("span",{class:"label"},"设备:",-1)),l("span",Kt,n(ze(o)||"-"),1)]),l("div",Et,[e[32]||(e[32]=l("span",{class:"label"},"系统:",-1)),l("span",jt,n(Ce(o)||"-"),1)]),l("div",Qt,[e[33]||(e[33]=l("span",{class:"label"},"商品:",-1)),o.product_id?(i(),x(w,{key:0,size:"small",type:"success"},{default:a(()=>[c(n(o.product_id),1)]),_:2},1024)):(i(),d("span",Gt,"-"))])])]),l("div",Wt,[e[37]||(e[37]=l("div",{class:"section-title"},"用户轨迹",-1)),l("div",qt,[l("div",Ht,[t(m,null,{default:a(()=>[t(z(tt))]),_:1}),o.behaviorSummary?(i(),d("span",Jt," 停留 "+n(o.behaviorSummary.durationText||"0秒"),1)):(i(),d("span",Zt,"暂无轨迹数据"))]),l("div",Xt,[o.behaviorSummary?P("",!0):(i(),x(V,{key:0,type:"warning",size:"small",onClick:_e=>Be(o)},{default:a(()=>[t(m,null,{default:a(()=>[t(z(me))]),_:1}),e[35]||(e[35]=c(" 获取 ",-1))]),_:1},8,["onClick"])),t(V,{type:"primary",size:"small",disabled:!o.behaviorSummary,onClick:_e=>Ae(o)},{default:a(()=>[t(m,null,{default:a(()=>[t(z(st))]),_:1}),e[36]||(e[36]=c(" 查看详情 ",-1))]),_:1},8,["disabled","onClick"])])])]),B(o)||N(o)?(i(),d("div",Yt,[e[41]||(e[41]=l("div",{class:"section-title"},"详细类型",-1)),l("div",es,[l("div",ts,[e[38]||(e[38]=l("span",{class:"label"},"类型:",-1)),t(w,{type:re(o),size:"small"},{default:a(()=>[c(n(ne(o)),1)]),_:2},1032,["type"])]),l("div",ss,[e[39]||(e[39]=l("span",{class:"label"},"名称:",-1)),l("span",as,n(xe(o)||"-"),1)]),l("div",ls,[e[40]||(e[40]=l("span",{class:"label"},"说明:",-1)),l("span",os,n(Ie(o)||"-"),1)])])])):P("",!0)])],2))),128))])),[[le,E.value]]),l("div",is,[t(ue,{"current-page":h.page,"onUpdate:currentPage":e[5]||(e[5]=o=>h.page=o),"page-size":h.size,"onUpdate:pageSize":e[6]||(e[6]=o=>h.size=o),total:h.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:Te,onCurrentChange:Le},null,8,["current-page","page-size","total"])])]),_:1}),t(ae,{modelValue:R.value,"onUpdate:modelValue":e[10]||(e[10]=o=>R.value=o),title:"选择商品",width:"800px","close-on-click-modal":!1},{default:a(()=>[l("div",ns,[t(r,{modelValue:U.value,"onUpdate:modelValue":e[7]||(e[7]=o=>U.value=o),placeholder:"搜索商品标题或ID",clearable:"",style:{"margin-bottom":"20px"},onInput:we},{prefix:a(()=>[t(m,null,{default:a(()=>[t(z(ve))]),_:1})]),_:1},8,["modelValue"]),ie((i(),x(Fe,{data:M.value,height:"400","highlight-current-row":"",onRowClick:de},{default:a(()=>[t(se,{prop:"spu_id",label:"商品ID",width:"180"}),t(se,{prop:"title",label:"商品标题","show-overflow-tooltip":""}),t(se,{label:"操作",width:"100",align:"center"},{default:a(o=>[t(V,{type:"primary",size:"small",onClick:fe(pe=>de(o.row),["stop"])},{default:a(()=>[...e[42]||(e[42]=[c("选择",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[le,q.value]]),t(ue,{"current-page":I.page,"onUpdate:currentPage":e[8]||(e[8]=o=>I.page=o),"page-size":I.size,"onUpdate:pageSize":e[9]||(e[9]=o=>I.size=o),total:I.total,"page-sizes":[10,20,50],layout:"total, sizes, prev, pager, next",style:{"margin-top":"20px"},onSizeChange:te,onCurrentChange:te},null,8,["current-page","page-size","total"])])]),_:1},8,["modelValue"]),t(ae,{modelValue:Q.value,"onUpdate:modelValue":e[11]||(e[11]=o=>Q.value=o),title:"IP详情",width:"600px","close-on-click-modal":!1},{default:a(()=>[u.value?(i(),d("div",rs,[t(ce,{column:2,border:""},{default:a(()=>[t(_,{label:"IP地址"},{default:a(()=>[c(n(u.value.ip_address),1)]),_:1}),t(_,{label:"国家"},{default:a(()=>[u.value.country?(i(),d("span",ds,n(u.value.country),1)):(i(),d("span",us,"--"))]),_:1}),t(_,{label:"国家代码"},{default:a(()=>[u.value.country?(i(),d("span",cs,n(u.value.country),1)):(i(),d("span",ps,"--"))]),_:1}),t(_,{label:"地区"},{default:a(()=>[u.value.region?(i(),d("span",_s,n(u.value.region),1)):(i(),d("span",fs,"--"))]),_:1}),t(_,{label:"城市"},{default:a(()=>[u.value.city?(i(),d("span",vs,n(u.value.city),1)):(i(),d("span",ms,"--"))]),_:1}),t(_,{label:"时区"},{default:a(()=>[u.value.timezone?(i(),d("span",gs,n(u.value.timezone),1)):(i(),d("span",ys,"--"))]),_:1}),t(_,{label:"ISP"},{default:a(()=>[u.value.organization?(i(),d("span",bs,n(u.value.organization),1)):(i(),d("span",hs,"--"))]),_:1}),t(_,{label:"主机名"},{default:a(()=>[u.value.hostname?(i(),d("span",ks,n(u.value.hostname),1)):(i(),d("span",zs,"--"))]),_:1}),t(_,{label:"邮编"},{default:a(()=>[u.value.postal_code?(i(),d("span",Cs,n(u.value.postal_code),1)):(i(),d("span",xs,"--"))]),_:1}),t(_,{label:"来源页面"},{default:a(()=>[u.value.referer?(i(),d("div",Is,[t($e,{href:u.value.referer,target:"_blank",type:"primary",size:"small"},{default:a(()=>[c(n(u.value.referer),1)]),_:1},8,["href"])])):(i(),d("span",Vs,"--"))]),_:1}),t(_,{label:"访问次数"},{default:a(()=>[t(w,{type:"info"},{default:a(()=>[c(n(u.value.visit_count),1)]),_:1})]),_:1}),t(_,{label:"首次访问"},{default:a(()=>[c(n(Z(u.value.first_visit)),1)]),_:1}),t(_,{label:"最后访问"},{default:a(()=>[c(n(Z(u.value.last_visit)),1)]),_:1})]),_:1}),u.value.location?(i(),d("div",ws,[e[43]||(e[43]=l("h4",null,"地理位置",-1)),l("p",null,"坐标: "+n(u.value.location),1)])):P("",!0)])):P("",!0)]),_:1},8,["modelValue"]),t(ae,{modelValue:G.value,"onUpdate:modelValue":e[12]||(e[12]=o=>G.value=o),title:"用户行为轨迹",width:"800px","close-on-click-modal":!1},{default:a(()=>[ie((i(),d("div",Ss,[C.value?(i(),d("div",Ps,[l("div",Ts,[t(ce,{column:2,size:"small",border:""},{default:a(()=>[t(_,{label:"Session ID"},{default:a(()=>[t(O,{size:"small",type:"info"},{default:a(()=>[c(n(C.value.sessionId),1)]),_:1})]),_:1}),t(_,{label:"数据来源"},{default:a(()=>[t(w,{type:C.value.source==="redis"?"success":"info",size:"small"},{default:a(()=>[c(n(C.value.source==="redis"?"Redis (实时)":"MySQL (历史)"),1)]),_:1},8,["type"])]),_:1}),t(_,{label:"进入时间"},{default:a(()=>[c(n(C.value.enterTime),1)]),_:1}),t(_,{label:"离开时间"},{default:a(()=>[c(n(C.value.exitTime||"未离开"),1)]),_:1}),t(_,{label:"停留时长"},{default:a(()=>[t(O,{type:"primary"},{default:a(()=>[c(n(C.value.durationText),1)]),_:1})]),_:1}),t(_,{label:"操作次数"},{default:a(()=>[t(O,{type:"warning"},{default:a(()=>[c(n(C.value.actions.length)+" 次",1)]),_:1})]),_:1})]),_:1})]),l("div",Ls,[t(Ke,null,{default:a(()=>[(i(!0),d(ge,null,ye(C.value.actions,o=>(i(),x(Oe,{key:o.sequence,timestamp:o.time,type:Re(o.type),placement:"top"},{default:a(()=>[l("div",Ds,[l("div",Bs,[t(w,{type:Me(o.type),size:"small"},{default:a(()=>[c(n(o.typeName),1)]),_:2},1032,["type"]),l("span",As,n(o.description),1)]),o.detail?(i(),d("div",Rs,[t(O,{size:"small",type:"info"},{default:a(()=>[c(" 详情: "+n(JSON.stringify(o.detail)),1)]),_:2},1024)])):P("",!0)])]),_:2},1032,["timestamp","type"]))),128))]),_:1})])])):(i(),x(Ee,{key:1,description:"暂无轨迹数据"}))])),[[le,W.value]])]),_:1},8,["modelValue"])])}}}),$s=ot(Ms,[["__scopeId","data-v-438ea41d"]]);export{$s as default};
