import{a5 as D,d as $e,h,P as le,Z as Ee,r as f,Q as Fe,c as r,o as i,b as l,a as t,w as s,_ as fe,g as c,q as me,u as C,aK as je,x as ge,e as u,U as qe,t as o,aV as Ge,aP as We,bq as Qe,aO as He,bo as Je,br as Xe,F as ae,f as ie,W as ne,E as Ye,n as Ze,bp as we,R as v,N as I}from"./index-DSPHYFnb.js";import{g as es}from"./product-BOiOTIi5.js";import{_ as ss}from"./_plugin-vue_export-helper-DlAUqK2U.js";const N={getVisitorIps:x=>D.get("/admin/statistics/visitor-ips",x),getVisitorIp:x=>D.get("/admin/statistics/visitor-ips/detail",{ip:x}),getIpStatistics:x=>D.get("/admin/statistics/visitor-ips-stats",x),deleteVisitorIp:x=>D.delete("/admin/statistics/visitor-ips/delete",{ip:x}),syncBehaviorData:()=>D.post("/admin/statistics/sync-behavior-data"),clearAllIpCache:()=>D.post("/admin/statistics/visitor-ips/clear-cache"),refreshIpInfo:x=>D.post("/admin/statistics/visitor-ips/refresh",{ip:x})},ts={class:"visitor-ip-list"},ls={class:"statistics-title"},as={class:"stat-content"},is={class:"stat-value"},ns={class:"stat-icon"},os={class:"stat-content"},ds={class:"stat-value"},us={class:"stat-icon"},rs={class:"stat-content"},cs={class:"stat-value"},ps={class:"stat-icon"},_s={class:"stat-content"},ys={class:"stat-value"},vs={class:"stat-icon"},fs={class:"stat-content"},ms={class:"stat-value"},gs={class:"stat-icon"},bs={class:"stat-content"},ks={class:"stat-value"},zs={class:"stat-icon"},hs={class:"source-stats-list"},Cs={class:"source-name"},Is={class:"source-count"},xs={class:"count-value"},Ps={class:"table-header"},Vs={class:"table-actions"},Ts={class:"ip-list"},Ss={class:"ip-header"},As={class:"ip-address"},Ls={class:"ip-actions"},Ds={class:"ip-content"},Bs={class:"ip-section"},Ms={class:"address-info"},Us={class:"address-line"},Ns={class:"value"},Rs={class:"address-line"},Ks={class:"value"},Os={class:"address-line"},$s={class:"value"},Es={key:0,class:"address-line"},Fs={class:"value"},js={key:1,class:"address-line"},qs={class:"value"},Gs={key:2,class:"address-line"},Ws={class:"value"},Qs={key:3,class:"address-line"},Hs={class:"value"},Js={key:4,class:"address-line"},Xs={class:"value"},Ys={class:"address-line"},Zs={class:"value"},ws={class:"address-line"},et={class:"value"},st={class:"address-line"},tt={class:"ip-section"},lt={class:"organization-info"},at={class:"org-line"},it=["title"],nt={class:"org-line"},ot={class:"value"},dt={class:"org-line"},ut=["title"],rt={class:"org-line"},ct={class:"value"},pt={class:"org-line"},_t={class:"value"},yt={key:1},vt={key:0,class:"org-line"},ft=["title"],mt={class:"org-tags"},gt={class:"ip-section"},bt={class:"basic-type"},kt={class:"type-line"},zt={class:"type-line"},ht={class:"value"},Ct={class:"type-line"},It={class:"value"},xt={class:"type-line"},Pt={key:1,class:"value"},Vt={class:"type-line"},Tt={key:1,class:"value"},St={class:"type-line"},At={key:1,class:"value"},Lt={key:0,class:"type-line"},Dt={class:"type-line"},Bt=["title"],Mt={class:"type-line"},Ut=["title"],Nt={class:"type-line"},Rt=["title"],Kt={class:"ip-section"},Ot={class:"privacy-tags"},$t={class:"privacy-item"},Et={class:"privacy-item"},Ft={class:"privacy-item"},jt={class:"privacy-item"},qt={class:"privacy-item"},Gt={key:0,class:"ip-section"},Wt={class:"detailed-type"},Qt={class:"type-line"},Ht={class:"type-line"},Jt={class:"value"},Xt={class:"type-line"},Yt={class:"value"},Zt={class:"pagination-wrapper"},wt={class:"product-select-dialog"},el={key:0,class:"ip-detail"},sl={class:"detail-section"},tl={key:0},ll={key:1,class:"text-gray-400"},al={key:1,class:"text-gray-400"},il={class:"detail-section"},nl={key:0},ol={key:1,class:"text-gray-400"},dl={key:0},ul={key:1,class:"text-gray-400"},rl={key:0},cl={key:1},pl={key:2,class:"text-gray-400"},_l={key:0},yl={key:1,class:"text-gray-400"},vl={key:0},fl={key:1,class:"text-gray-400"},ml={key:0},gl={key:1,class:"text-gray-400"},bl={key:0},kl={key:1},zl={key:2,class:"text-gray-400"},hl={class:"detail-section"},Cl={key:0},Il={key:1,class:"text-gray-400"},xl={key:1,class:"text-gray-400"},Pl={key:0},Vl={key:1},Tl={key:2,class:"text-gray-400"},Sl={key:0},Al={key:1,class:"text-gray-400"},Ll={key:0},Dl={key:1,class:"text-gray-400"},Bl={key:0,class:"detail-section"},Ml={key:0},Ul={key:1,class:"text-gray-400"},Nl={key:1,class:"detail-section"},Rl={key:2,class:"detail-section"},Kl=["href"],Ol={key:3,class:"detail-section"},$l={class:"detail-section"},El={class:"detail-section"},Fl={key:0,class:"referer-info"},jl={key:1,class:"text-gray-400"},ql={key:0,class:"referer-info"},Gl={key:1,class:"text-gray-400"},Wl={class:"timeline-container"},Ql={key:0,class:"timeline-content"},Hl={class:"timeline-header"},Jl={class:"timeline-list"},Xl={class:"timeline-item-content"},Yl={class:"action-description"},Zl={class:"action-text"},wl={key:0,class:"action-detail"},ea=$e({__name:"index",setup(x){const G=h(!1),W=h(!1),Q=h(!1),n=h(null),g=le({ip:"",timeRange:"today",visitorType:"",productId:"",emParam:""}),R=h(!1),H=h(!1),J=h([]),K=h([]),O=h(""),B=h(""),T=le({page:1,size:20,total:0}),z=le({page:1,size:20,total:0}),X=h([]),S=h({totalIps:0,todayIps:0,totalCountries:0,totalCities:0,genuineCount:0,fakeCount:0,countryStats:[],cityStats:[],productTypeStats:[],sourceStats:[]}),$=d=>d?new Date(d).toLocaleString("zh-CN"):"--",E=d=>{const e=["proxy","vpn","tor","anonymizer"],y=(d.organization||"").toLowerCase();return e.some(m=>y.includes(m))},be=d=>{const e=["amazon","google","microsoft","cloudflare","digitalocean","linode","vultr","aws","gcp","azure"],y=(d.organization||"").toLowerCase();return e.some(m=>y.includes(m))},oe=d=>M(d)?"爬虫":E(d)?"代理":"访客",de=d=>M(d)?"primary":E(d)?"warning":"success",Y=d=>{const e=["google","facebook","twitter","linkedin","microsoft","bytedance","tiktok"],y=(d.organization||"").toLowerCase(),m=(d.user_agent||"").trim(),k=e.some(b=>y.includes(b)),j=!m||m.length<20;return k&&j},M=d=>{if(Y(d))return!0;const e=["bot","crawler","spider","scraper","crawl","googlebot","bingbot","slurp","duckduckbot","facebook","facebookexternalhit","facebot","twitter","twitterbot","linkedin","linkedinbot","whatsapp","telegrambot","bytedance","bytespider","semrush","ahrefs","mj12bot","petalbot","yandex","baidu"],y=(d.user_agent||"").toLowerCase(),m=(d.organization||"").toLowerCase();return e.some(k=>y.includes(k)||m.includes(k))},ke=d=>{const e=d.user_agent||"";return e.includes("Mobile")?"Mobile":e.includes("Tablet")?"Tablet":e.includes("Desktop")?"Desktop":null},ze=d=>{const e=d.user_agent||"";return e.includes("Android")?"Android":e.includes("iOS")||e.includes("iPhone")||e.includes("iPad")?"iOS":e.includes("Windows")?"Windows":e.includes("Mac")?"macOS":e.includes("Linux")?"Linux":null},he=d=>{const e=(d.user_agent||"").toLowerCase(),y=(d.organization||"").toLowerCase();return Y(d)?y.includes("google")?"Google 审核爬虫":y.includes("facebook")?"Facebook 审核爬虫":y.includes("twitter")?"Twitter 审核爬虫":y.includes("linkedin")?"LinkedIn 审核爬虫":y.includes("microsoft")?"Microsoft 审核爬虫":y.includes("bytedance")||y.includes("tiktok")?"TikTok 审核爬虫":"审核爬虫":e.includes("googlebot")||y.includes("google")&&e.includes("bot")?"Googlebot":e.includes("bingbot")||y.includes("microsoft")&&e.includes("bot")?"BingBot":e.includes("facebook")?"Facebook Crawler":e.includes("twitter")?"Twitter Bot":e.includes("ahrefs")||y.includes("ahrefs")?"aHrefs Bot":e.includes("httpx")?"httpx":e.includes("barkrowler")?"Barkrowler":M(d)?"通用爬虫":null},Ce=d=>{const e=(d.user_agent||"").toLowerCase(),y=(d.organization||"").toLowerCase();return Y(d)?"广告/内容合规审核（无UA或异常UA）":e.includes("googlebot")||y.includes("google")&&e.includes("bot")||e.includes("bingbot")||y.includes("microsoft")&&e.includes("bot")?"搜索引擎蜘蛛":e.includes("facebook")||e.includes("twitter")?"社交媒体爬虫":e.includes("ahrefs")||y.includes("ahrefs")?"SEO分析爬虫":M(d)?"通用网络爬虫":null},ue=d=>({A:"primary",B:"success",C:"warning",D:"danger",E:"info"})[d]||"info",re=d=>({A:"A页",B:"B页",C:"C页",D:"D页",E:"E页"})[d]||d,Ie=d=>({YouTube:"danger","Android App":"success",Google:"primary",Facebook:"primary",Instagram:"warning",TikTok:"danger","Twitter/X":"info",直接访问:"info",其他:"info"})[d]||"info",xe=()=>({today:"今天",yesterday:"昨天",week:"本周",month:"本月",all:"全部时间"})[g.timeRange]||"今天",U=async()=>{try{G.value=!0;const d={page:z.page,size:z.size,...g},e=await N.getVisitorIps(d);e.code===200&&(X.value=e.data.list,z.total=e.data.total)}catch(d){console.error("获取访客IP列表失败:",d),I.error("获取访客IP列表失败")}finally{G.value=!1}},Z=async()=>{try{const d=await N.getIpStatistics({timeRange:g.timeRange||"today"});d.code===200&&(S.value=d.data)}catch(d){console.error("获取统计数据失败:",d),I.error("获取统计数据失败")}},F=()=>{z.page=1,U(),Z()},Pe=()=>{Object.assign(g,{ip:"",timeRange:"today",visitorType:"",productId:"",emParam:""}),B.value="",F()},w=async()=>{try{H.value=!0;const{data:d}=await es({page:T.page,size:T.size});J.value=d.list||[],K.value=d.list||[],T.total=d.total||0}catch{I.error("加载商品列表失败")}finally{H.value=!1}},Ve=()=>{if(!O.value){K.value=J.value;return}const d=O.value.toLowerCase();K.value=J.value.filter(e=>{var y,m;return((y=e.title)==null?void 0:y.toLowerCase().includes(d))||((m=e.spu_id)==null?void 0:m.toLowerCase().includes(d))})},ce=d=>{g.productId=d.spu_id,B.value=d.title,R.value=!1,I.success(`已选择商品: ${d.title}`)},Te=()=>{g.productId="",B.value=""},Se=d=>{z.size=d,z.page=1,U()},Ae=d=>{z.page=d,U()},Le=async d=>{try{const e=await N.getVisitorIp(d.ip_address);e.code===200&&(n.value=e.data,Q.value=!0)}catch(e){console.error("获取IP详情失败:",e),I.error("获取IP详情失败")}},De=async()=>{var d;try{W.value=!0;const e=await N.clearAllIpCache();e.code===200?I.success(e.message||`成功清理 ${((d=e.data)==null?void 0:d.count)||0} 个IP缓存`):I.error(e.message||"清空缓存失败")}catch(e){console.error("清空IP缓存失败:",e),I.error("清空缓存失败")}finally{W.value=!1}},Be=async d=>{try{I.info(`正在重新识别 IP: ${d.ip_address}...`);const e=await N.refreshIpInfo(d.ip_address);e.code===200?(I.success("IP信息已重新识别并更新"),await U()):I.error(e.message||"重新识别失败")}catch(e){console.error("重新识别IP失败:",e),I.error("重新识别IP失败")}};return Ee(()=>{U(),Z(),w()}),(d,e)=>{const y=f("el-input"),m=f("el-form-item"),k=f("el-option"),j=f("el-select"),b=f("el-icon"),A=f("el-button"),Me=f("el-form"),V=f("el-card"),L=f("el-col"),pe=f("el-row"),p=f("el-tag"),_e=f("el-pagination"),ee=f("el-table-column"),Ue=f("el-table"),se=f("el-dialog"),_=f("el-descriptions-item"),P=f("el-descriptions"),ye=f("el-link"),q=f("el-text"),Ne=f("el-timeline-item"),Re=f("el-timeline"),Ke=f("el-empty"),te=Fe("loading");return i(),r("div",ts,[l(V,{class:"search-card",shadow:"never"},{default:s(()=>[l(Me,{model:g,inline:!0,class:"search-form"},{default:s(()=>[l(m,{label:"IP地址"},{default:s(()=>[l(y,{modelValue:g.ip,"onUpdate:modelValue":e[0]||(e[0]=a=>g.ip=a),placeholder:"请输入IP地址",clearable:"",style:{width:"200px"},onKeyup:fe(F,["enter"])},null,8,["modelValue"])]),_:1}),l(m,{label:"时间筛选"},{default:s(()=>[l(j,{modelValue:g.timeRange,"onUpdate:modelValue":e[1]||(e[1]=a=>g.timeRange=a),placeholder:"请选择时间范围",style:{width:"150px"}},{default:s(()=>[l(k,{label:"当天",value:"today"}),l(k,{label:"昨天",value:"yesterday"}),l(k,{label:"本周",value:"week"}),l(k,{label:"本月",value:"month"}),l(k,{label:"全部",value:"all"})]),_:1},8,["modelValue"])]),_:1}),l(m,{label:"访客类型"},{default:s(()=>[l(j,{modelValue:g.visitorType,"onUpdate:modelValue":e[2]||(e[2]=a=>g.visitorType=a),placeholder:"请选择类型",clearable:"",style:{width:"150px"}},{default:s(()=>[l(k,{label:"访客",value:"visitor"}),l(k,{label:"爬虫",value:"bot"}),l(k,{label:"代理",value:"proxy"})]),_:1},8,["modelValue"])]),_:1}),l(m,{label:"商品筛选"},{default:s(()=>[l(y,{modelValue:B.value,"onUpdate:modelValue":e[3]||(e[3]=a=>B.value=a),placeholder:"点击选择商品",readonly:"",style:{width:"200px"},onClick:e[4]||(e[4]=a=>R.value=!0)},{suffix:s(()=>[g.productId?(i(),c(b,{key:0,onClick:me(Te,["stop"]),style:{cursor:"pointer"}},{default:s(()=>[l(C(je))]),_:1})):(i(),c(b,{key:1},{default:s(()=>[l(C(ge))]),_:1}))]),_:1},8,["modelValue"])]),_:1}),l(m,{label:"推广参数"},{default:s(()=>[l(y,{modelValue:g.emParam,"onUpdate:modelValue":e[5]||(e[5]=a=>g.emParam=a),placeholder:"请输入em参数",clearable:"",style:{width:"200px"},onKeyup:fe(F,["enter"])},null,8,["modelValue"])]),_:1}),l(m,null,{default:s(()=>[l(A,{type:"primary",onClick:F},{default:s(()=>[...e[14]||(e[14]=[u("搜索",-1)])]),_:1}),l(A,{onClick:Pe},{default:s(()=>[...e[15]||(e[15]=[u("重置",-1)])]),_:1}),l(A,{type:"warning",onClick:De,loading:W.value},{default:s(()=>[l(b,null,{default:s(()=>[l(C(qe))]),_:1}),e[16]||(e[16]=u(" 一键清空缓存 ",-1))]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1}),t("div",ls,[t("h3",null,"统计数据（"+o(xe())+"）",1)]),l(pe,{gutter:20,class:"statistics-cards"},{default:s(()=>[l(L,{span:4},{default:s(()=>[l(V,{class:"stat-card"},{default:s(()=>[t("div",as,[t("div",is,o(S.value.totalIps),1),e[17]||(e[17]=t("div",{class:"stat-label"},"总IP数",-1))]),t("div",ns,[l(b,null,{default:s(()=>[l(C(Ge))]),_:1})])]),_:1})]),_:1}),l(L,{span:4},{default:s(()=>[l(V,{class:"stat-card"},{default:s(()=>[t("div",os,[t("div",ds,o(S.value.todayIps),1),e[18]||(e[18]=t("div",{class:"stat-label"},"今日新增",-1))]),t("div",us,[l(b,null,{default:s(()=>[l(C(We))]),_:1})])]),_:1})]),_:1}),l(L,{span:4},{default:s(()=>[l(V,{class:"stat-card genuine"},{default:s(()=>[t("div",rs,[t("div",cs,o(S.value.genuineCount),1),e[19]||(e[19]=t("div",{class:"stat-label"},"访问正品",-1))]),t("div",ps,[l(b,null,{default:s(()=>[l(C(Qe))]),_:1})])]),_:1})]),_:1}),l(L,{span:4},{default:s(()=>[l(V,{class:"stat-card fake"},{default:s(()=>[t("div",_s,[t("div",ys,o(S.value.fakeCount),1),e[20]||(e[20]=t("div",{class:"stat-label"},"访问仿品",-1))]),t("div",vs,[l(b,null,{default:s(()=>[l(C(He))]),_:1})])]),_:1})]),_:1}),l(L,{span:4},{default:s(()=>[l(V,{class:"stat-card"},{default:s(()=>[t("div",fs,[t("div",ms,o(S.value.totalCountries),1),e[21]||(e[21]=t("div",{class:"stat-label"},"涉及国家",-1))]),t("div",gs,[l(b,null,{default:s(()=>[l(C(Je))]),_:1})])]),_:1})]),_:1}),l(L,{span:4},{default:s(()=>[l(V,{class:"stat-card"},{default:s(()=>[t("div",bs,[t("div",ks,o(S.value.totalCities),1),e[22]||(e[22]=t("div",{class:"stat-label"},"涉及城市",-1))]),t("div",zs,[l(b,null,{default:s(()=>[l(C(Xe))]),_:1})])]),_:1})]),_:1})]),_:1}),l(pe,{gutter:20,class:"statistics-cards",style:{"margin-top":"20px"}},{default:s(()=>[l(L,{span:24},{default:s(()=>[l(V,{class:"source-stats-card"},{default:s(()=>[e[24]||(e[24]=t("div",{class:"card-header"},[t("h3",null,"访问来源统计")],-1)),t("div",hs,[(i(!0),r(ae,null,ie(S.value.sourceStats,a=>(i(),r("div",{key:a.source,class:"source-item"},[t("div",Cs,[l(p,{type:Ie(a.source),size:"default"},{default:s(()=>[u(o(a.source),1)]),_:2},1032,["type"])]),t("div",Is,[t("span",xs,o(a.count),1),e[23]||(e[23]=t("span",{class:"count-label"},"次",-1))])]))),128))])]),_:1})]),_:1})]),_:1}),l(V,{class:"table-card",shadow:"never"},{default:s(()=>[t("div",Ps,[e[26]||(e[26]=t("div",{class:"table-title"},"访客IP列表",-1)),t("div",Vs,[l(A,{onClick:Z},{default:s(()=>[l(b,null,{default:s(()=>[l(C(Ye))]),_:1}),e[25]||(e[25]=u(" 刷新统计 ",-1))]),_:1})])]),ne((i(),r("div",Ts,[(i(!0),r(ae,null,ie(X.value,(a,ve)=>(i(),r("div",{key:a.id,class:Ze(["ip-item",{"last-item":ve===X.value.length-1}])},[t("div",Ss,[t("div",As,o(a.ip_address),1),t("div",Ls,[l(A,{type:"success",size:"small",onClick:Oe=>Be(a)},{default:s(()=>[l(b,null,{default:s(()=>[l(C(we))]),_:1}),e[27]||(e[27]=u(" 重新识别 ",-1))]),_:1},8,["onClick"]),l(A,{type:"primary",size:"small",onClick:Oe=>Le(a)},{default:s(()=>[...e[28]||(e[28]=[u("查看",-1)])]),_:1},8,["onClick"])])]),t("div",Ds,[t("div",Bs,[e[40]||(e[40]=t("div",{class:"section-title"},"地理位置",-1)),t("div",Ms,[t("div",Us,[e[29]||(e[29]=t("span",{class:"label"},"城市:",-1)),t("span",Ns,o(a.city||"-"),1)]),t("div",Rs,[e[30]||(e[30]=t("span",{class:"label"},"地区:",-1)),t("span",Ks,[u(o(a.region||"-")+" ",1),a.region_code?(i(),c(p,{key:0,size:"small",type:"info",style:{"margin-left":"4px"}},{default:s(()=>[u(o(a.region_code),1)]),_:2},1024)):v("",!0)])]),t("div",Os,[e[31]||(e[31]=t("span",{class:"label"},"国家:",-1)),t("span",$s,[u(o(a.country_name||a.country||"-")+" ",1),a.country_code||a.country?(i(),c(p,{key:0,size:"small",type:"info",style:{"margin-left":"4px"}},{default:s(()=>[u(o(a.country_code||a.country),1)]),_:2},1024)):v("",!0)])]),a.continent?(i(),r("div",Es,[e[32]||(e[32]=t("span",{class:"label"},"大洲:",-1)),t("span",Fs,[u(o(a.continent)+" ",1),a.continent_code?(i(),c(p,{key:0,size:"small",type:"info",style:{"margin-left":"4px"}},{default:s(()=>[u(o(a.continent_code),1)]),_:2},1024)):v("",!0)])])):v("",!0),a.postal_code?(i(),r("div",js,[e[33]||(e[33]=t("span",{class:"label"},"邮编:",-1)),t("span",qs,o(a.postal_code),1)])):v("",!0),a.timezone?(i(),r("div",Gs,[e[34]||(e[34]=t("span",{class:"label"},"时区:",-1)),t("span",Ws,o(a.timezone),1)])):v("",!0),a.latitude&&a.longitude?(i(),r("div",Qs,[e[35]||(e[35]=t("span",{class:"label"},"坐标:",-1)),t("span",Hs,o(a.latitude)+", "+o(a.longitude),1)])):a.location?(i(),r("div",Js,[e[36]||(e[36]=t("span",{class:"label"},"坐标:",-1)),t("span",Xs,o(a.location),1)])):v("",!0),t("div",Ys,[e[37]||(e[37]=t("span",{class:"label"},"首次访问:",-1)),t("span",Zs,o($(a.first_visit)),1)]),t("div",ws,[e[38]||(e[38]=t("span",{class:"label"},"最后访问:",-1)),t("span",et,o($(a.last_visit)),1)]),t("div",st,[e[39]||(e[39]=t("span",{class:"label"},"访问次数:",-1)),l(p,{type:"info",size:"small"},{default:s(()=>[u(o(a.visit_count),1)]),_:2},1024)])])]),t("div",tt,[e[49]||(e[49]=t("div",{class:"section-title"},"网络与组织",-1)),t("div",lt,[t("div",at,[e[41]||(e[41]=t("span",{class:"label"},"主机名:",-1)),t("span",{class:"value",title:a.hostname||"-"},o(a.hostname||"-"),9,it)]),t("div",nt,[e[42]||(e[42]=t("span",{class:"label"},"ASN号码:",-1)),t("span",ot,o(a.asn||"-"),1)]),t("div",dt,[e[43]||(e[43]=t("span",{class:"label"},"AS组织名称:",-1)),t("span",{class:"value",title:a.as_name||"-"},o(a.as_name||"-"),9,ut)]),t("div",rt,[e[44]||(e[44]=t("span",{class:"label"},"AS域名:",-1)),t("span",ct,o(a.as_domain||"-"),1)]),t("div",pt,[e[45]||(e[45]=t("span",{class:"label"},"AS类型:",-1)),t("span",_t,[a.as_type?(i(),c(p,{key:0,size:"small",type:"primary"},{default:s(()=>[u(o(a.as_type),1)]),_:2},1024)):(i(),r("span",yt,"-"))])]),a.organization&&a.organization!==a.asn+" "+a.as_name?(i(),r("div",vt,[e[46]||(e[46]=t("span",{class:"label"},"组织信息:",-1)),t("span",{class:"value",title:a.organization},o(a.organization),9,ft)])):v("",!0),t("div",mt,[E(a)?(i(),c(p,{key:0,size:"small",type:"info"},{default:s(()=>[...e[47]||(e[47]=[u("代理",-1)])]),_:1})):v("",!0),be(a)?(i(),c(p,{key:1,size:"small",type:"warning"},{default:s(()=>[...e[48]||(e[48]=[u("机房",-1)])]),_:1})):v("",!0)])])]),t("div",gt,[e[60]||(e[60]=t("div",{class:"section-title"},"访问信息",-1)),t("div",bt,[t("div",kt,[e[50]||(e[50]=t("span",{class:"label"},"访问类型:",-1)),l(p,{type:de(a),size:"small"},{default:s(()=>[u(o(oe(a)),1)]),_:2},1032,["type"])]),t("div",zt,[e[51]||(e[51]=t("span",{class:"label"},"设备:",-1)),t("span",ht,o(ke(a)||"-"),1)]),t("div",Ct,[e[52]||(e[52]=t("span",{class:"label"},"系统:",-1)),t("span",It,o(ze(a)||"-"),1)]),t("div",xt,[e[53]||(e[53]=t("span",{class:"label"},"商品ID:",-1)),a.product_id?(i(),c(p,{key:0,size:"small",type:"success"},{default:s(()=>[u(o(a.product_id),1)]),_:2},1024)):(i(),r("span",Pt,"-"))]),t("div",Vt,[e[54]||(e[54]=t("span",{class:"label"},"推广参数:",-1)),a.em_param?(i(),c(p,{key:0,size:"small",type:"warning"},{default:s(()=>[u(o(a.em_param),1)]),_:2},1024)):(i(),r("span",Tt,"-"))]),t("div",St,[e[55]||(e[55]=t("span",{class:"label"},"产品类型:",-1)),a.product_type?(i(),c(p,{key:0,size:"small",type:ue(a.product_type)},{default:s(()=>[u(o(re(a.product_type)),1)]),_:2},1032,["type"])):(i(),r("span",At,"-"))]),a.cloak_reason?(i(),r("div",Lt,[e[56]||(e[56]=t("span",{class:"label"},"判断原因:",-1)),l(p,{size:"small",type:a.product_type==="fake"?"danger":"success"},{default:s(()=>[u(o(a.cloak_reason),1)]),_:2},1032,["type"])])):v("",!0),t("div",Dt,[e[57]||(e[57]=t("span",{class:"label"},"访问页面:",-1)),t("span",{class:"value referer",title:a.access_address||"-"},o(a.access_address||"-"),9,Bt)]),t("div",Mt,[e[58]||(e[58]=t("span",{class:"label"},"来源页面:",-1)),t("span",{class:"value referer",title:a.referer||"-"},o(a.referer||"-"),9,Ut)]),t("div",Nt,[e[59]||(e[59]=t("span",{class:"label"},"User-Agent:",-1)),t("span",{class:"value referer",title:a.user_agent||"-"},o(a.user_agent||"-"),9,Rt)])])]),t("div",Kt,[e[76]||(e[76]=t("div",{class:"section-title"},"Privacy 隐私检测",-1)),t("div",Ot,[t("span",$t,[e[63]||(e[63]=t("span",{class:"privacy-label"},"VPN:",-1)),a.privacy_vpn||a.is_anonymous?(i(),c(p,{key:0,type:"danger",size:"small"},{default:s(()=>[...e[61]||(e[61]=[u("是",-1)])]),_:1})):(i(),c(p,{key:1,type:"success",size:"small"},{default:s(()=>[...e[62]||(e[62]=[u("否",-1)])]),_:1}))]),t("span",Et,[e[66]||(e[66]=t("span",{class:"privacy-label"},"Proxy:",-1)),a.privacy_proxy?(i(),c(p,{key:0,type:"danger",size:"small"},{default:s(()=>[...e[64]||(e[64]=[u("是",-1)])]),_:1})):(i(),c(p,{key:1,type:"success",size:"small"},{default:s(()=>[...e[65]||(e[65]=[u("否",-1)])]),_:1}))]),t("span",Ft,[e[69]||(e[69]=t("span",{class:"privacy-label"},"Tor:",-1)),a.privacy_tor?(i(),c(p,{key:0,type:"danger",size:"small"},{default:s(()=>[...e[67]||(e[67]=[u("是",-1)])]),_:1})):(i(),c(p,{key:1,type:"success",size:"small"},{default:s(()=>[...e[68]||(e[68]=[u("否",-1)])]),_:1}))]),t("span",jt,[e[72]||(e[72]=t("span",{class:"privacy-label"},"托管:",-1)),a.privacy_hosting||a.is_hosting?(i(),c(p,{key:0,type:"warning",size:"small"},{default:s(()=>[...e[70]||(e[70]=[u("是",-1)])]),_:1})):(i(),c(p,{key:1,type:"success",size:"small"},{default:s(()=>[...e[71]||(e[71]=[u("否",-1)])]),_:1}))]),t("span",qt,[e[75]||(e[75]=t("span",{class:"privacy-label"},"移动:",-1)),a.is_mobile||a.carrier_name?(i(),c(p,{key:0,type:"primary",size:"small"},{default:s(()=>[...e[73]||(e[73]=[u("是",-1)])]),_:1})):(i(),c(p,{key:1,type:"info",size:"small"},{default:s(()=>[...e[74]||(e[74]=[u("否",-1)])]),_:1}))])])]),M(a)||E(a)?(i(),r("div",Gt,[e[80]||(e[80]=t("div",{class:"section-title"},"详细类型",-1)),t("div",Wt,[t("div",Qt,[e[77]||(e[77]=t("span",{class:"label"},"类型:",-1)),l(p,{type:de(a),size:"small"},{default:s(()=>[u(o(oe(a)),1)]),_:2},1032,["type"])]),t("div",Ht,[e[78]||(e[78]=t("span",{class:"label"},"名称:",-1)),t("span",Jt,o(he(a)||"-"),1)]),t("div",Xt,[e[79]||(e[79]=t("span",{class:"label"},"说明:",-1)),t("span",Yt,o(Ce(a)||"-"),1)])])])):v("",!0)])],2))),128))])),[[te,G.value]]),t("div",Zt,[l(_e,{"current-page":z.page,"onUpdate:currentPage":e[6]||(e[6]=a=>z.page=a),"page-size":z.size,"onUpdate:pageSize":e[7]||(e[7]=a=>z.size=a),total:z.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:Se,onCurrentChange:Ae},null,8,["current-page","page-size","total"])])]),_:1}),l(se,{modelValue:R.value,"onUpdate:modelValue":e[11]||(e[11]=a=>R.value=a),title:"选择商品",width:"800px","close-on-click-modal":!1},{default:s(()=>[t("div",wt,[l(y,{modelValue:O.value,"onUpdate:modelValue":e[8]||(e[8]=a=>O.value=a),placeholder:"搜索商品标题或ID",clearable:"",style:{"margin-bottom":"20px"},onInput:Ve},{prefix:s(()=>[l(b,null,{default:s(()=>[l(C(ge))]),_:1})]),_:1},8,["modelValue"]),ne((i(),c(Ue,{data:K.value,height:"400","highlight-current-row":"",onRowClick:ce},{default:s(()=>[l(ee,{prop:"spu_id",label:"商品ID",width:"180"}),l(ee,{prop:"title",label:"商品标题","show-overflow-tooltip":""}),l(ee,{label:"操作",width:"100",align:"center"},{default:s(a=>[l(A,{type:"primary",size:"small",onClick:me(ve=>ce(a.row),["stop"])},{default:s(()=>[...e[81]||(e[81]=[u("选择",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[te,H.value]]),l(_e,{"current-page":T.page,"onUpdate:currentPage":e[9]||(e[9]=a=>T.page=a),"page-size":T.size,"onUpdate:pageSize":e[10]||(e[10]=a=>T.size=a),total:T.total,"page-sizes":[10,20,50],layout:"total, sizes, prev, pager, next",style:{"margin-top":"20px"},onSizeChange:w,onCurrentChange:w},null,8,["current-page","page-size","total"])])]),_:1},8,["modelValue"]),l(se,{modelValue:Q.value,"onUpdate:modelValue":e[12]||(e[12]=a=>Q.value=a),title:"IP详情",width:"800px","close-on-click-modal":!1},{default:s(()=>[n.value?(i(),r("div",el,[t("div",sl,[e[82]||(e[82]=t("h4",{class:"section-title"},"基础信息",-1)),l(P,{column:2,border:"",size:"default"},{default:s(()=>[l(_,{label:"IP地址"},{default:s(()=>[u(o(n.value.ip_address),1)]),_:1}),l(_,{label:"主机名"},{default:s(()=>[n.value.hostname?(i(),r("span",tl,o(n.value.hostname),1)):(i(),r("span",ll,"--"))]),_:1}),l(_,{label:"访问次数"},{default:s(()=>[l(p,{type:"info"},{default:s(()=>[u(o(n.value.visit_count),1)]),_:1})]),_:1}),l(_,{label:"产品类型"},{default:s(()=>[n.value.product_type?(i(),c(p,{key:0,type:ue(n.value.product_type),size:"small"},{default:s(()=>[u(o(re(n.value.product_type)),1)]),_:1},8,["type"])):(i(),r("span",al,"--"))]),_:1}),l(_,{label:"首次访问"},{default:s(()=>[u(o($(n.value.first_visit)),1)]),_:1}),l(_,{label:"最后访问"},{default:s(()=>[u(o($(n.value.last_visit)),1)]),_:1})]),_:1})]),t("div",il,[e[83]||(e[83]=t("h4",{class:"section-title"},"地理位置信息",-1)),l(P,{column:2,border:"",size:"default"},{default:s(()=>[l(_,{label:"城市"},{default:s(()=>[n.value.city?(i(),r("span",nl,o(n.value.city),1)):(i(),r("span",ol,"--"))]),_:1}),l(_,{label:"地区"},{default:s(()=>[n.value.region?(i(),r("span",dl,o(n.value.region),1)):(i(),r("span",ul,"--"))]),_:1}),l(_,{label:"国家代码"},{default:s(()=>[n.value.country_code?(i(),r("span",rl,o(n.value.country_code),1)):n.value.country?(i(),r("span",cl,o(n.value.country),1)):(i(),r("span",pl,"--"))]),_:1}),l(_,{label:"大洲"},{default:s(()=>[n.value.continent?(i(),r("span",_l,o(n.value.continent)+" ("+o(n.value.continent_code)+") ",1)):(i(),r("span",yl,"--"))]),_:1}),l(_,{label:"邮编"},{default:s(()=>[n.value.postal_code?(i(),r("span",vl,o(n.value.postal_code),1)):(i(),r("span",fl,"--"))]),_:1}),l(_,{label:"时区"},{default:s(()=>[n.value.timezone?(i(),r("span",ml,o(n.value.timezone),1)):(i(),r("span",gl,"--"))]),_:1}),l(_,{label:"经纬度",span:2},{default:s(()=>[n.value.latitude&&n.value.longitude?(i(),r("span",bl,o(n.value.latitude)+", "+o(n.value.longitude),1)):n.value.location?(i(),r("span",kl,o(n.value.location),1)):(i(),r("span",zl,"--"))]),_:1})]),_:1})]),t("div",hl,[e[84]||(e[84]=t("h4",{class:"section-title"},"AS (自治系统) 信息",-1)),l(P,{column:2,border:"",size:"default"},{default:s(()=>[l(_,{label:"ASN"},{default:s(()=>[n.value.asn?(i(),r("span",Cl,o(n.value.asn),1)):(i(),r("span",Il,"--"))]),_:1}),l(_,{label:"AS 类型"},{default:s(()=>[n.value.as_type?(i(),c(p,{key:0,size:"small"},{default:s(()=>[u(o(n.value.as_type),1)]),_:1})):(i(),r("span",xl,"--"))]),_:1}),l(_,{label:"AS 组织名称",span:2},{default:s(()=>[n.value.as_name?(i(),r("span",Pl,o(n.value.as_name),1)):n.value.organization?(i(),r("span",Vl,o(n.value.organization),1)):(i(),r("span",Tl,"--"))]),_:1}),l(_,{label:"AS 域名",span:2},{default:s(()=>[n.value.as_domain?(i(),r("span",Sl,o(n.value.as_domain),1)):(i(),r("span",Al,"--"))]),_:1}),l(_,{label:"AS 路由",span:2},{default:s(()=>[n.value.asn_route?(i(),r("span",Ll,o(n.value.asn_route),1)):(i(),r("span",Dl,"--"))]),_:1})]),_:1})]),n.value.privacy_vpn!==void 0||n.value.privacy_proxy!==void 0?(i(),r("div",Bl,[e[95]||(e[95]=t("h4",{class:"section-title"},"隐私检测详情 (Premium)",-1)),l(P,{column:3,border:"",size:"default"},{default:s(()=>[l(_,{label:"VPN"},{default:s(()=>[n.value.privacy_vpn?(i(),c(p,{key:0,type:"danger",size:"small"},{default:s(()=>[...e[85]||(e[85]=[u("是",-1)])]),_:1})):(i(),c(p,{key:1,type:"success",size:"small"},{default:s(()=>[...e[86]||(e[86]=[u("否",-1)])]),_:1}))]),_:1}),l(_,{label:"代理"},{default:s(()=>[n.value.privacy_proxy?(i(),c(p,{key:0,type:"danger",size:"small"},{default:s(()=>[...e[87]||(e[87]=[u("是",-1)])]),_:1})):(i(),c(p,{key:1,type:"success",size:"small"},{default:s(()=>[...e[88]||(e[88]=[u("否",-1)])]),_:1}))]),_:1}),l(_,{label:"Tor"},{default:s(()=>[n.value.privacy_tor?(i(),c(p,{key:0,type:"danger",size:"small"},{default:s(()=>[...e[89]||(e[89]=[u("是",-1)])]),_:1})):(i(),c(p,{key:1,type:"success",size:"small"},{default:s(()=>[...e[90]||(e[90]=[u("否",-1)])]),_:1}))]),_:1}),l(_,{label:"中继"},{default:s(()=>[n.value.privacy_relay?(i(),c(p,{key:0,type:"warning",size:"small"},{default:s(()=>[...e[91]||(e[91]=[u("是",-1)])]),_:1})):(i(),c(p,{key:1,type:"success",size:"small"},{default:s(()=>[...e[92]||(e[92]=[u("否",-1)])]),_:1}))]),_:1}),l(_,{label:"托管服务"},{default:s(()=>[n.value.privacy_hosting?(i(),c(p,{key:0,type:"warning",size:"small"},{default:s(()=>[...e[93]||(e[93]=[u("是",-1)])]),_:1})):(i(),c(p,{key:1,type:"success",size:"small"},{default:s(()=>[...e[94]||(e[94]=[u("否",-1)])]),_:1}))]),_:1}),l(_,{label:"服务类型"},{default:s(()=>[n.value.privacy_service?(i(),r("span",Ml,o(n.value.privacy_service),1)):(i(),r("span",Ul,"--"))]),_:1})]),_:1})])):v("",!0),n.value.company_name||n.value.carrier_name?(i(),r("div",Nl,[e[96]||(e[96]=t("h4",{class:"section-title"},"公司/运营商信息",-1)),l(P,{column:2,border:"",size:"default"},{default:s(()=>[n.value.company_name?(i(),c(_,{key:0,label:"公司名称"},{default:s(()=>[u(o(n.value.company_name),1)]),_:1})):v("",!0),n.value.company_domain?(i(),c(_,{key:1,label:"公司域名"},{default:s(()=>[u(o(n.value.company_domain),1)]),_:1})):v("",!0),n.value.company_type?(i(),c(_,{key:2,label:"公司类型"},{default:s(()=>[l(p,{size:"small"},{default:s(()=>[u(o(n.value.company_type),1)]),_:1})]),_:1})):v("",!0),n.value.carrier_name?(i(),c(_,{key:3,label:"运营商"},{default:s(()=>[u(o(n.value.carrier_name),1)]),_:1})):v("",!0),n.value.carrier_mcc?(i(),c(_,{key:4,label:"MCC"},{default:s(()=>[u(o(n.value.carrier_mcc),1)]),_:1})):v("",!0),n.value.carrier_mnc?(i(),c(_,{key:5,label:"MNC"},{default:s(()=>[u(o(n.value.carrier_mnc),1)]),_:1})):v("",!0)]),_:1})])):v("",!0),n.value.abuse_email?(i(),r("div",Rl,[e[97]||(e[97]=t("h4",{class:"section-title"},"滥用举报联系信息",-1)),l(P,{column:2,border:"",size:"default"},{default:s(()=>[n.value.abuse_name?(i(),c(_,{key:0,label:"联系人"},{default:s(()=>[u(o(n.value.abuse_name),1)]),_:1})):v("",!0),n.value.abuse_email?(i(),c(_,{key:1,label:"邮箱"},{default:s(()=>[t("a",{href:`mailto:${n.value.abuse_email}`},o(n.value.abuse_email),9,Kl)]),_:1})):v("",!0),n.value.abuse_phone?(i(),c(_,{key:2,label:"电话"},{default:s(()=>[u(o(n.value.abuse_phone),1)]),_:1})):v("",!0),n.value.abuse_country?(i(),c(_,{key:3,label:"国家"},{default:s(()=>[u(o(n.value.abuse_country),1)]),_:1})):v("",!0),n.value.abuse_address?(i(),c(_,{key:4,label:"地址",span:2},{default:s(()=>[u(o(n.value.abuse_address),1)]),_:1})):v("",!0),n.value.abuse_network?(i(),c(_,{key:5,label:"网络范围",span:2},{default:s(()=>[u(o(n.value.abuse_network),1)]),_:1})):v("",!0)]),_:1})])):v("",!0),n.value.domains_total?(i(),r("div",Ol,[e[98]||(e[98]=t("h4",{class:"section-title"},"其他信息",-1)),l(P,{column:2,border:"",size:"default"},{default:s(()=>[l(_,{label:"关联域名总数"},{default:s(()=>[u(o(n.value.domains_total),1)]),_:1})]),_:1})])):v("",!0),t("div",$l,[e[109]||(e[109]=t("h4",{class:"section-title"},"IP 特征标识",-1)),l(P,{column:3,border:"",size:"default"},{default:s(()=>[l(_,{label:"匿名 IP"},{default:s(()=>[n.value.is_anonymous?(i(),c(p,{key:0,type:"danger",size:"small"},{default:s(()=>[...e[99]||(e[99]=[u("是 (VPN/Proxy)",-1)])]),_:1})):(i(),c(p,{key:1,type:"success",size:"small"},{default:s(()=>[...e[100]||(e[100]=[u("否",-1)])]),_:1}))]),_:1}),l(_,{label:"托管 IP"},{default:s(()=>[n.value.is_hosting?(i(),c(p,{key:0,type:"warning",size:"small"},{default:s(()=>[...e[101]||(e[101]=[u("是 (数据中心)",-1)])]),_:1})):(i(),c(p,{key:1,type:"success",size:"small"},{default:s(()=>[...e[102]||(e[102]=[u("否",-1)])]),_:1}))]),_:1}),l(_,{label:"移动网络"},{default:s(()=>[n.value.is_mobile?(i(),c(p,{key:0,type:"primary",size:"small"},{default:s(()=>[...e[103]||(e[103]=[u("是",-1)])]),_:1})):(i(),c(p,{key:1,type:"info",size:"small"},{default:s(()=>[...e[104]||(e[104]=[u("否",-1)])]),_:1}))]),_:1}),l(_,{label:"任播 IP"},{default:s(()=>[n.value.is_anycast?(i(),c(p,{key:0,type:"info",size:"small"},{default:s(()=>[...e[105]||(e[105]=[u("是",-1)])]),_:1})):(i(),c(p,{key:1,type:"info",size:"small"},{default:s(()=>[...e[106]||(e[106]=[u("否",-1)])]),_:1}))]),_:1}),l(_,{label:"卫星网络"},{default:s(()=>[n.value.is_satellite?(i(),c(p,{key:0,type:"info",size:"small"},{default:s(()=>[...e[107]||(e[107]=[u("是",-1)])]),_:1})):(i(),c(p,{key:1,type:"info",size:"small"},{default:s(()=>[...e[108]||(e[108]=[u("否",-1)])]),_:1}))]),_:1})]),_:1})]),t("div",El,[e[110]||(e[110]=t("h4",{class:"section-title"},"访问信息",-1)),l(P,{column:1,border:"",size:"default"},{default:s(()=>[l(_,{label:"访问页面"},{default:s(()=>[n.value.access_address?(i(),r("div",Fl,[l(ye,{href:n.value.access_address,target:"_blank",type:"primary",size:"small"},{default:s(()=>[u(o(n.value.access_address),1)]),_:1},8,["href"])])):(i(),r("span",jl,"--"))]),_:1}),l(_,{label:"来源页面"},{default:s(()=>[n.value.referer?(i(),r("div",ql,[l(ye,{href:n.value.referer,target:"_blank",type:"primary",size:"small"},{default:s(()=>[u(o(n.value.referer),1)]),_:1},8,["href"])])):(i(),r("span",Gl,"--"))]),_:1})]),_:1})])])):v("",!0)]),_:1},8,["modelValue"]),l(se,{modelValue:d.timelineDialogVisible,"onUpdate:modelValue":e[13]||(e[13]=a=>d.timelineDialogVisible=a),title:"用户行为轨迹",width:"800px","close-on-click-modal":!1},{default:s(()=>[ne((i(),r("div",Wl,[d.currentTimeline?(i(),r("div",Ql,[t("div",Hl,[l(P,{column:2,size:"small",border:""},{default:s(()=>[l(_,{label:"Session ID"},{default:s(()=>[l(q,{size:"small",type:"info"},{default:s(()=>[u(o(d.currentTimeline.sessionId),1)]),_:1})]),_:1}),l(_,{label:"数据来源"},{default:s(()=>[l(p,{type:d.currentTimeline.source==="redis"?"success":"info",size:"small"},{default:s(()=>[u(o(d.currentTimeline.source==="redis"?"Redis (实时)":"MySQL (历史)"),1)]),_:1},8,["type"])]),_:1}),l(_,{label:"进入时间"},{default:s(()=>[u(o(d.currentTimeline.enterTime),1)]),_:1}),l(_,{label:"离开时间"},{default:s(()=>[u(o(d.currentTimeline.exitTime||"未离开"),1)]),_:1}),l(_,{label:"停留时长"},{default:s(()=>[l(q,{type:"primary"},{default:s(()=>[u(o(d.currentTimeline.durationText),1)]),_:1})]),_:1}),l(_,{label:"操作次数"},{default:s(()=>[l(q,{type:"warning"},{default:s(()=>[u(o(d.currentTimeline.actions.length)+" 次",1)]),_:1})]),_:1})]),_:1})]),t("div",Jl,[l(Re,null,{default:s(()=>[(i(!0),r(ae,null,ie(d.currentTimeline.actions,a=>(i(),c(Ne,{key:a.sequence,timestamp:a.time,type:d.getActionType(a.type),placement:"top"},{default:s(()=>[t("div",Xl,[t("div",Yl,[l(p,{type:d.getActionTagType(a.type),size:"small"},{default:s(()=>[u(o(a.typeName),1)]),_:2},1032,["type"]),t("span",Zl,o(a.description),1)]),a.detail?(i(),r("div",wl,[l(q,{size:"small",type:"info"},{default:s(()=>[u(" 详情: "+o(JSON.stringify(a.detail)),1)]),_:2},1024)])):v("",!0)])]),_:2},1032,["timestamp","type"]))),128))]),_:1})])])):(i(),c(Ke,{key:1,description:"暂无轨迹数据"}))])),[[te,d.timelineLoading]])]),_:1},8,["modelValue"])])}}}),aa=ss(ea,[["__scopeId","data-v-a83e0758"]]);export{aa as default};
