import{d as Q,h as V,P as K,Z as ke,r as m,c as v,o as f,a as d,b as e,g as B,R as Ve,w as a,e as r,u as g,$ as W,i as ye,V as xe,F,f as z,n as Ce,t as b,q as N,as as Y,U as Z,aY as Te,ar as we,aC as H,a0 as Ue,N as x}from"./index-BHNq6tBL.js";import{g as he}from"./product-d8thSld0.js";import{_ as Ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Ae={class:"pixel-templates"},Xe={class:"action-bar"},De={class:"templates-grid"},$e=["onClick"],Fe={class:"template-header"},ze={class:"template-title"},Se={class:"template-actions"},Ee={class:"template-description"},Pe={class:"template-platforms"},Be={class:"platform-tags"},Ne={class:"template-footer"},Oe={class:"template-stats"},Ge={class:"stat-item"},Le={class:"stat-item"},Me={class:"template-apply"},je={class:"detail-header"},qe={class:"detail-actions"},Re={class:"template-config"},Je={class:"config-section"},Ke={class:"config-section"},We={class:"config-section"},Ye={class:"config-section"},Ze={key:0,class:"empty-custom"},He={key:1},Qe={class:"custom-pixel-header"},el={class:"custom-pixel-name"},ll={class:"custom-pixel-code"},ol={class:"config-form"},al={class:"config-form"},tl={class:"config-form"},dl={class:"custom-pixel-config"},nl={class:"custom-pixel-header"},sl={class:"custom-pixel-form"},il={class:"dialog-footer"},ul={class:"dialog-footer"},rl=Q({name:"PixelTemplates"}),pl=Q({...rl,setup(ml){const U=V(!1),A=V(!1),S=V(!1),E=V(!1),X=V(!1),n=V(null),P=V("google_ads"),O=V("google_ads"),G=V([]),T=V([]),s=K({name:"",type:"general",description:"",config:{google_ads:{enabled:!1,conversion_id:"",conversion_label:""},facebook:{enabled:!1,pixel_id:""},tiktok:{enabled:!1,pixel_id:""},custom:[]}}),k=K({productIds:[],mode:"replace"}),ee={name:[{required:!0,message:"请输入模板名称",trigger:"blur"}],type:[{required:!0,message:"请选择模板类型",trigger:"change"}],description:[{required:!0,message:"请输入模板描述",trigger:"blur"}]},le=t=>{n.value=t,P.value="google_ads"},oe=()=>{X.value=!1,re(),U.value=!0},L=t=>{X.value=!0,Object.assign(s,{...t,config:JSON.parse(JSON.stringify(t.config))}),U.value=!0},ae=t=>{Ue.confirm(`确定要删除模板 "${t.name}" 吗？`,"删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const l=T.value.findIndex(u=>u.id===t.id);l>-1&&(T.value.splice(l,1),x.success("模板删除成功"))})},M=t=>{n.value=t,k.productIds=[],k.mode="replace",A.value=!0},te=()=>{s.config.custom.push({name:"",enabled:!0,code:""})},de=t=>{s.config.custom.splice(t,1)},ne=async()=>{S.value=!0;try{if(await new Promise(t=>setTimeout(t,1e3)),X.value){const t=T.value.findIndex(l=>{var u;return l.id===((u=n.value)==null?void 0:u.id)});t>-1&&(T.value[t]={...T.value[t],...s,updatedAt:new Date().toISOString().split("T")[0]}),x.success("模板更新成功")}else{const t={...s,id:Date.now().toString(),usageCount:0,createdAt:new Date().toISOString().split("T")[0],updatedAt:new Date().toISOString().split("T")[0]};T.value.unshift(t),x.success("模板创建成功")}U.value=!1}catch{x.error("保存失败")}finally{S.value=!1}},se=async()=>{if(k.productIds.length===0){x.warning("请选择要应用模板的商品");return}E.value=!0;try{await new Promise(t=>setTimeout(t,1e3)),n.value&&(n.value.usageCount+=k.productIds.length),x.success(`模板已成功应用到 ${k.productIds.length} 个商品`),A.value=!1}catch{x.error("应用失败")}finally{E.value=!1}},ie=()=>{x.info("导入模板功能开发中...")},ue=()=>{x.info("导出模板功能开发中...")},re=()=>{Object.assign(s,{name:"",type:"general",description:"",config:{google_ads:{enabled:!1,conversion_id:"",conversion_label:""},facebook:{enabled:!1,pixel_id:""},tiktok:{enabled:!1,pixel_id:""},custom:[]}})},pe=t=>({general:"info",google_ads:"success",facebook:"primary",tiktok:"warning",multi_platform:"danger"})[t]||"info",me=t=>({general:"通用",google_ads:"Google Ads",facebook:"Facebook",tiktok:"TikTok",multi_platform:"多平台"})[t]||"未知",ce=t=>{var u,p,h,D;const l=[];return(u=t.google_ads)!=null&&u.enabled&&l.push("google_ads"),(p=t.facebook)!=null&&p.enabled&&l.push("facebook"),(h=t.tiktok)!=null&&h.enabled&&l.push("tiktok"),((D=t.custom)==null?void 0:D.length)>0&&l.push("custom"),l},fe=t=>({google_ads:"success",facebook:"primary",tiktok:"warning",custom:"info"})[t]||"info",_e=t=>({google_ads:"Google Ads",facebook:"Facebook",tiktok:"TikTok",custom:"自定义"})[t]||"未知",ge=async()=>{try{const{data:t}=await he({page:1,size:1e3});G.value=t.list}catch(t){console.error("加载商品列表失败:",t)}};return ke(()=>{ge()}),(t,l)=>{const u=m("el-icon"),p=m("el-button"),h=m("el-tag"),D=m("el-card"),w=m("el-switch"),i=m("el-form-item"),_=m("el-input"),$=m("el-form"),C=m("el-tab-pane"),ve=m("el-empty"),j=m("el-tabs"),I=m("el-option"),q=m("el-select"),R=m("el-dialog"),J=m("el-radio"),be=m("el-radio-group");return f(),v("div",Ae,[l[39]||(l[39]=d("div",{class:"page-header"},[d("h2",null,"像素模板管理"),d("p",null,"管理常用的像素配置模板，快速应用到商品")],-1)),d("div",Xe,[e(p,{type:"primary",onClick:oe},{default:a(()=>[e(u,null,{default:a(()=>[e(g(W))]),_:1}),l[27]||(l[27]=r(" 新建模板 ",-1))]),_:1}),e(p,{onClick:ie},{default:a(()=>[e(u,null,{default:a(()=>[e(g(ye))]),_:1}),l[28]||(l[28]=r(" 导入模板 ",-1))]),_:1}),e(p,{onClick:ue},{default:a(()=>[e(u,null,{default:a(()=>[e(g(xe))]),_:1}),l[29]||(l[29]=r(" 导出模板 ",-1))]),_:1})]),e(D,{class:"templates-card",shadow:"never"},{default:a(()=>[d("div",De,[(f(!0),v(F,null,z(T.value,o=>{var y;return f(),v("div",{key:o.id,class:Ce(["template-card",{active:((y=n.value)==null?void 0:y.id)===o.id}]),onClick:c=>le(o)},[d("div",Fe,[d("div",ze,[d("h3",null,b(o.name),1),e(h,{type:pe(o.type),size:"small"},{default:a(()=>[r(b(me(o.type)),1)]),_:2},1032,["type"])]),d("div",Se,[e(p,{size:"small",type:"primary",link:"",onClick:N(c=>L(o),["stop"])},{default:a(()=>[e(u,null,{default:a(()=>[e(g(Y))]),_:1})]),_:1},8,["onClick"]),e(p,{size:"small",type:"danger",link:"",onClick:N(c=>ae(o),["stop"])},{default:a(()=>[e(u,null,{default:a(()=>[e(g(Z))]),_:1})]),_:1},8,["onClick"])])]),d("div",Ee,[d("p",null,b(o.description),1)]),d("div",Pe,[d("div",Be,[(f(!0),v(F,null,z(ce(o.config),c=>(f(),B(h,{key:c,type:fe(c),size:"small",class:"platform-tag"},{default:a(()=>[r(b(_e(c)),1)]),_:2},1032,["type"]))),128))])]),d("div",Ne,[d("div",Oe,[d("span",Ge,[e(u,null,{default:a(()=>[e(g(Te))]),_:1}),r(" 使用 "+b(o.usageCount)+" 次 ",1)]),d("span",Le,[e(u,null,{default:a(()=>[e(g(we))]),_:1}),r(" "+b(o.updatedAt),1)])]),d("div",Me,[e(p,{size:"small",type:"success",onClick:N(c=>M(o),["stop"])},{default:a(()=>[e(u,null,{default:a(()=>[e(g(H))]),_:1}),l[30]||(l[30]=r(" 应用 ",-1))]),_:1},8,["onClick"])])])],10,$e)}),128))])]),_:1}),n.value?(f(),B(D,{key:0,class:"template-detail",shadow:"never"},{header:a(()=>[d("div",je,[d("span",null,"模板详情 - "+b(n.value.name),1),d("div",qe,[e(p,{size:"small",onClick:l[0]||(l[0]=o=>L(n.value))},{default:a(()=>[e(u,null,{default:a(()=>[e(g(Y))]),_:1}),l[31]||(l[31]=r(" 编辑 ",-1))]),_:1}),e(p,{size:"small",type:"success",onClick:l[1]||(l[1]=o=>M(n.value))},{default:a(()=>[e(u,null,{default:a(()=>[e(g(H))]),_:1}),l[32]||(l[32]=r(" 应用到商品 ",-1))]),_:1})])])]),default:a(()=>[d("div",Re,[e(j,{modelValue:P.value,"onUpdate:modelValue":l[9]||(l[9]=o=>P.value=o),type:"card"},{default:a(()=>[e(C,{label:"Google Ads",name:"google_ads"},{default:a(()=>[d("div",Je,[e($,{model:n.value.config.google_ads,"label-width":"120px"},{default:a(()=>[e(i,{label:"启用状态"},{default:a(()=>[e(w,{modelValue:n.value.config.google_ads.enabled,"onUpdate:modelValue":l[2]||(l[2]=o=>n.value.config.google_ads.enabled=o),disabled:""},null,8,["modelValue"])]),_:1}),e(i,{label:"转化ID"},{default:a(()=>[e(_,{modelValue:n.value.config.google_ads.conversion_id,"onUpdate:modelValue":l[3]||(l[3]=o=>n.value.config.google_ads.conversion_id=o),disabled:"",placeholder:"AW-XXXXXXXXX"},null,8,["modelValue"])]),_:1}),e(i,{label:"转化标签"},{default:a(()=>[e(_,{modelValue:n.value.config.google_ads.conversion_label,"onUpdate:modelValue":l[4]||(l[4]=o=>n.value.config.google_ads.conversion_label=o),disabled:"",placeholder:"AbCdEfGhIjKlMnOp"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])]),_:1}),e(C,{label:"Facebook",name:"facebook"},{default:a(()=>[d("div",Ke,[e($,{model:n.value.config.facebook,"label-width":"120px"},{default:a(()=>[e(i,{label:"启用状态"},{default:a(()=>[e(w,{modelValue:n.value.config.facebook.enabled,"onUpdate:modelValue":l[5]||(l[5]=o=>n.value.config.facebook.enabled=o),disabled:""},null,8,["modelValue"])]),_:1}),e(i,{label:"像素ID"},{default:a(()=>[e(_,{modelValue:n.value.config.facebook.pixel_id,"onUpdate:modelValue":l[6]||(l[6]=o=>n.value.config.facebook.pixel_id=o),disabled:"",placeholder:"123456789012345"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])]),_:1}),e(C,{label:"TikTok",name:"tiktok"},{default:a(()=>[d("div",We,[e($,{model:n.value.config.tiktok,"label-width":"120px"},{default:a(()=>[e(i,{label:"启用状态"},{default:a(()=>[e(w,{modelValue:n.value.config.tiktok.enabled,"onUpdate:modelValue":l[7]||(l[7]=o=>n.value.config.tiktok.enabled=o),disabled:""},null,8,["modelValue"])]),_:1}),e(i,{label:"像素ID"},{default:a(()=>[e(_,{modelValue:n.value.config.tiktok.pixel_id,"onUpdate:modelValue":l[8]||(l[8]=o=>n.value.config.tiktok.pixel_id=o),disabled:"",placeholder:"C1234567890ABCDEF"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])]),_:1}),e(C,{label:"自定义像素",name:"custom"},{default:a(()=>[d("div",Ye,[n.value.config.custom.length===0?(f(),v("div",Ze,[e(ve,{description:"暂无自定义像素"})])):(f(),v("div",He,[(f(!0),v(F,null,z(n.value.config.custom,(o,y)=>(f(),v("div",{key:y,class:"custom-pixel-item"},[d("div",Qe,[d("span",el,b(o.name),1),e(h,{type:o.enabled?"success":"info",size:"small"},{default:a(()=>[r(b(o.enabled?"启用":"禁用"),1)]),_:2},1032,["type"])]),d("div",ll,[d("pre",null,[d("code",null,b(o.code),1)])])]))),128))]))])]),_:1})]),_:1},8,["modelValue"])])]),_:1})):Ve("",!0),e(R,{modelValue:U.value,"onUpdate:modelValue":l[22]||(l[22]=o=>U.value=o),title:X.value?"编辑模板":"新建模板",width:"800px","close-on-click-modal":!1},{footer:a(()=>[d("div",il,[e(p,{onClick:l[21]||(l[21]=o=>U.value=!1)},{default:a(()=>[...l[34]||(l[34]=[r("取消",-1)])]),_:1}),e(p,{type:"primary",onClick:ne,loading:S.value},{default:a(()=>[r(b(X.value?"更新":"创建"),1)]),_:1},8,["loading"])])]),default:a(()=>[e($,{ref:"templateFormRef",model:s,rules:ee,"label-width":"120px"},{default:a(()=>[e(i,{label:"模板名称",prop:"name"},{default:a(()=>[e(_,{modelValue:s.name,"onUpdate:modelValue":l[10]||(l[10]=o=>s.name=o),placeholder:"请输入模板名称"},null,8,["modelValue"])]),_:1}),e(i,{label:"模板类型",prop:"type"},{default:a(()=>[e(q,{modelValue:s.type,"onUpdate:modelValue":l[11]||(l[11]=o=>s.type=o),placeholder:"请选择模板类型"},{default:a(()=>[e(I,{label:"通用模板",value:"general"}),e(I,{label:"Google Ads专用",value:"google_ads"}),e(I,{label:"Facebook专用",value:"facebook"}),e(I,{label:"TikTok专用",value:"tiktok"}),e(I,{label:"多平台组合",value:"multi_platform"})]),_:1},8,["modelValue"])]),_:1}),e(i,{label:"模板描述",prop:"description"},{default:a(()=>[e(_,{modelValue:s.description,"onUpdate:modelValue":l[12]||(l[12]=o=>s.description=o),type:"textarea",rows:3,placeholder:"请输入模板描述"},null,8,["modelValue"])]),_:1}),e(i,{label:"像素配置"},{default:a(()=>[e(j,{modelValue:O.value,"onUpdate:modelValue":l[20]||(l[20]=o=>O.value=o),type:"card"},{default:a(()=>[e(C,{label:"Google Ads",name:"google_ads"},{default:a(()=>[d("div",ol,[e(i,{label:"启用状态"},{default:a(()=>[e(w,{modelValue:s.config.google_ads.enabled,"onUpdate:modelValue":l[13]||(l[13]=o=>s.config.google_ads.enabled=o)},null,8,["modelValue"])]),_:1}),e(i,{label:"转化ID",prop:"config.google_ads.conversion_id"},{default:a(()=>[e(_,{modelValue:s.config.google_ads.conversion_id,"onUpdate:modelValue":l[14]||(l[14]=o=>s.config.google_ads.conversion_id=o),placeholder:"AW-XXXXXXXXX"},null,8,["modelValue"])]),_:1}),e(i,{label:"转化标签",prop:"config.google_ads.conversion_label"},{default:a(()=>[e(_,{modelValue:s.config.google_ads.conversion_label,"onUpdate:modelValue":l[15]||(l[15]=o=>s.config.google_ads.conversion_label=o),placeholder:"AbCdEfGhIjKlMnOp"},null,8,["modelValue"])]),_:1})])]),_:1}),e(C,{label:"Facebook",name:"facebook"},{default:a(()=>[d("div",al,[e(i,{label:"启用状态"},{default:a(()=>[e(w,{modelValue:s.config.facebook.enabled,"onUpdate:modelValue":l[16]||(l[16]=o=>s.config.facebook.enabled=o)},null,8,["modelValue"])]),_:1}),e(i,{label:"像素ID",prop:"config.facebook.pixel_id"},{default:a(()=>[e(_,{modelValue:s.config.facebook.pixel_id,"onUpdate:modelValue":l[17]||(l[17]=o=>s.config.facebook.pixel_id=o),placeholder:"123456789012345"},null,8,["modelValue"])]),_:1})])]),_:1}),e(C,{label:"TikTok",name:"tiktok"},{default:a(()=>[d("div",tl,[e(i,{label:"启用状态"},{default:a(()=>[e(w,{modelValue:s.config.tiktok.enabled,"onUpdate:modelValue":l[18]||(l[18]=o=>s.config.tiktok.enabled=o)},null,8,["modelValue"])]),_:1}),e(i,{label:"像素ID",prop:"config.tiktok.pixel_id"},{default:a(()=>[e(_,{modelValue:s.config.tiktok.pixel_id,"onUpdate:modelValue":l[19]||(l[19]=o=>s.config.tiktok.pixel_id=o),placeholder:"C1234567890ABCDEF"},null,8,["modelValue"])]),_:1})])]),_:1}),e(C,{label:"自定义像素",name:"custom"},{default:a(()=>[d("div",dl,[d("div",nl,[e(p,{type:"primary",size:"small",onClick:te},{default:a(()=>[e(u,null,{default:a(()=>[e(g(W))]),_:1}),l[33]||(l[33]=r(" 添加自定义像素 ",-1))]),_:1})]),(f(!0),v(F,null,z(s.config.custom,(o,y)=>(f(),v("div",{key:y,class:"custom-pixel-item"},[d("div",sl,[e(i,{label:"名称",prop:`config.custom.${y}.name`},{default:a(()=>[e(_,{modelValue:o.name,"onUpdate:modelValue":c=>o.name=c,placeholder:"像素名称"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"]),e(i,{label:"启用"},{default:a(()=>[e(w,{modelValue:o.enabled,"onUpdate:modelValue":c=>o.enabled=c},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(p,{type:"danger",size:"small",onClick:c=>de(y)},{default:a(()=>[e(u,null,{default:a(()=>[e(g(Z))]),_:1})]),_:1},8,["onClick"])]),e(i,{label:"代码",prop:`config.custom.${y}.code`},{default:a(()=>[e(_,{modelValue:o.code,"onUpdate:modelValue":c=>o.code=c,type:"textarea",rows:4,placeholder:"请输入像素代码"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"])]))),128))])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),e(R,{modelValue:A.value,"onUpdate:modelValue":l[26]||(l[26]=o=>A.value=o),title:"应用模板到商品",width:"600px","close-on-click-modal":!1},{footer:a(()=>[d("div",ul,[e(p,{onClick:l[25]||(l[25]=o=>A.value=!1)},{default:a(()=>[...l[37]||(l[37]=[r("取消",-1)])]),_:1}),e(p,{type:"primary",onClick:se,loading:E.value},{default:a(()=>[...l[38]||(l[38]=[r(" 确认应用 ",-1)])]),_:1},8,["loading"])])]),default:a(()=>[e($,{model:k,"label-width":"120px"},{default:a(()=>[e(i,{label:"选择商品"},{default:a(()=>[e(q,{modelValue:k.productIds,"onUpdate:modelValue":l[23]||(l[23]=o=>k.productIds=o),multiple:"",filterable:"",placeholder:"请选择要应用模板的商品",style:{width:"100%"}},{default:a(()=>[(f(!0),v(F,null,z(G.value,o=>(f(),B(I,{key:o.id,label:o.title,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(i,{label:"应用方式"},{default:a(()=>[e(be,{modelValue:k.mode,"onUpdate:modelValue":l[24]||(l[24]=o=>k.mode=o)},{default:a(()=>[e(J,{label:"replace"},{default:a(()=>[...l[35]||(l[35]=[r("替换现有配置",-1)])]),_:1}),e(J,{label:"merge"},{default:a(()=>[...l[36]||(l[36]=[r("合并现有配置",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),gl=Ie(pl,[["__scopeId","data-v-32dec3ae"]]);export{gl as default};
