import{a5 as De,d as Ee,af as Ot,h as g,ag as Jt,D as gl,ah as Wt,ai as Gt,s as $e,r as U,c as f,o as r,b as l,a as o,g as z,R as L,n as Be,w as t,F as I,u as v,aE as Dl,b9 as Ht,U as qe,q as Zt,a7 as vl,N as _,$ as re,P as ve,a8 as el,Z as Qt,Q as Xt,_ as Yt,x as ll,e as i,E as yl,W as tl,aB as je,t as y,f as j,aQ as kl,aD as bl,aq as ea,aC as la,aP as ta,ba as hl,bb as Vl,G as wl,bc as aa,bd as al,be as Sl,aN as sa,a0 as xe}from"./index-CSDlNv8m.js";import{d as oa,u as na,c as ia,g as Ul,a as Cl,b as zl,e as ua}from"./product-Bmb3HVIk.js";import{c as ra}from"./cloakRule-D5-oLtWU.js";import{W as da}from"./index-BEKw3FZg.js";import{_ as Pl}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./upload-BMBE57eP.js";const ca=M=>De.get(`/admin/products/${M}/skus`),xl=M=>De.post("/admin/product-skus",M),pa=(M,oe)=>De.put(`/admin/product-skus/${M}`,oe),_a=M=>De.delete(`/admin/product-skus/${M}`),ma={class:"product-upload-box"},fa=["src"],ga={key:1,class:"upload-empty"},va={class:"el-upload__tip"},ya=Ee({name:"ProductUploadImg"}),ka=Ee({...ya,props:{imageUrl:{default:""},drag:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},fileSize:{default:2},fileType:{default:()=>["image/jpeg","image/png","image/gif","image/webp"]},height:{default:"150px"},width:{default:"150px"},borderRadius:{default:"8px"}},emits:["update:imageUrl","update:image-url"],setup(M,{emit:oe}){Ot(w=>({v5f6650a9:w.borderRadius,v6111d75b:w.width,b14bcb9c:w.height}));const Q=M,O=g("id-"+Jt()),Y=g(!1),J=gl(Wt,void 0),ee=gl(Gt,void 0),E=$e(()=>Q.disabled||(J==null?void 0:J.disabled)),ye=$e(()=>"https://gammtt.shop/admin/upload/image"),le=oe,ke=()=>{le("update:imageUrl",""),le("update:image-url","")},be=()=>{const w=document.querySelector(`#${O.value} .el-upload__input`);w&&w.dispatchEvent(new MouseEvent("click"))},X=w=>{const C=w.type.startsWith("image/"),B=w.size/1024/1024<Q.fileSize,K=Q.fileType.includes(w.type);return C?K?B?!0:(_.error(`图片大小不能超过 ${Q.fileSize}MB!`),!1):(_.error(`上传图片格式不正确，支持格式：${Q.fileType.join(", ")}`),!1):(_.error("只能上传图片文件!"),!1)},ne=w=>{w&&w.success&&w.data&&w.data.url?(le("update:imageUrl",w.data.url),le("update:image-url",w.data.url),_.success("图片上传成功!"),ee!=null&&ee.prop&&(J==null||J.validateField([ee.prop]))):_.error("图片上传失败: "+(w.error||"未知错误"))},W=()=>{_.error("图片上传失败，请重新上传!")};return(w,C)=>{const B=U("el-icon"),K=U("el-upload"),T=U("el-image-viewer");return r(),f("div",ma,[l(K,{id:O.value,action:ye.value,class:Be(["upload",E.value?"disabled":"",M.drag?"no-border":""]),multiple:!1,disabled:E.value,"show-file-list":!1,"before-upload":X,"on-success":ne,"on-error":W,drag:M.drag,accept:M.fileType.join(",")},{default:t(()=>[M.imageUrl?(r(),f(I,{key:0},[o("img",{src:M.imageUrl,class:"upload-image"},null,8,fa),o("div",{class:"upload-handle",onClick:C[1]||(C[1]=Zt(()=>{},["stop"]))},[E.value?L("",!0):(r(),f("div",{key:0,class:"handle-icon",onClick:be},[l(B,null,{default:t(()=>[l(v(Dl))]),_:1}),C[3]||(C[3]=o("span",null,"编辑",-1))])),o("div",{class:"handle-icon",onClick:C[0]||(C[0]=ie=>Y.value=!0)},[l(B,null,{default:t(()=>[l(v(Ht))]),_:1}),C[4]||(C[4]=o("span",null,"查看",-1))]),E.value?L("",!0):(r(),f("div",{key:1,class:"handle-icon",onClick:ke},[l(B,null,{default:t(()=>[l(v(qe))]),_:1}),C[5]||(C[5]=o("span",null,"删除",-1))]))])],64)):(r(),f("div",ga,[vl(w.$slots,"empty",{},()=>[l(B,null,{default:t(()=>[l(v(re))]),_:1}),C[6]||(C[6]=o("span",null,"请上传图片",-1))],!0)]))]),_:3},8,["id","action","class","disabled","drag","accept"]),o("div",va,[vl(w.$slots,"tip",{},void 0,!0)]),Y.value?(r(),z(T,{key:0,"url-list":[M.imageUrl],onClose:C[2]||(C[2]=ie=>Y.value=!1)},null,8,["url-list"])):L("",!0)])}}}),$l=Pl(ka,[["__scopeId","data-v-937c0afd"]]),ba={class:"product-management"},ha={class:"table-header"},Va={class:"table-title"},wa={class:"table-actions"},Sa={class:"product-info"},Ua=["src","alt"],Ca={class:"product-details"},za={class:"product-title"},xa={class:"product-subtitle"},$a={key:0,style:{"font-weight":"bold",color:"#ef3f52"}},Da={key:1,style:{color:"#999999"}},Pa={key:0,style:{color:"#666666","text-decoration":"line-through"}},Ma={key:1,style:{color:"#999999"}},Ka={key:1,style:{color:"#999999"}},Aa={key:0},Fa={key:0},Ta={key:1,style:{color:"#999999"}},Ia={key:1},La={key:2,style:{color:"#f56c6c"}},ja={key:0},Ba={key:1,style:{color:"#999999"}},qa={class:"count-info"},Ea={class:"count-info"},Ra={class:"time-info"},Na={class:"action-buttons"},Oa={class:"pagination-wrapper"},Ja={style:{display:"flex","align-items":"center","justify-content":"space-between"}},Wa={style:{"font-size":"12px",color:"#999999"}},Ga={style:{display:"flex","align-items":"center","justify-content":"space-between"}},Ha={class:"form-tip",style:{color:"#909399","font-size":"12px"}},Za={style:{display:"flex","align-items":"center",gap:"8px"}},Qa={style:{display:"flex","align-items":"center",gap:"8px"}},Xa={class:"editor-controls"},Ya={class:"dialog-footer"},es={class:"sku-management"},ls={class:"sku-list-section"},ts={class:"section-header"},as={class:"sku-actions"},ss=["src","alt"],os={class:"sku-attributes"},ns={class:"price"},is={key:1,style:{color:"#999999"}},us={class:"sort-header"},rs={class:"sort-actions"},ds={class:"sort-tabs"},cs={class:"attribute-sort-section"},ps={class:"attribute-list"},_s=["onDragstart","onDrop"],ms={class:"attribute-content"},fs={class:"sort-handle"},gs={class:"attribute-info"},vs={class:"attribute-name"},ys={class:"attribute-count"},ks={class:"sort-order"},bs={class:"value-sort-section"},hs={class:"section-title"},Vs={class:"value-list"},ws=["onDragstart","onDrop"],Ss={class:"value-content"},Us={class:"sort-handle"},Cs={class:"value-info"},zs={class:"value-name"},xs={class:"value-count"},$s={class:"sort-order"},Ds={class:"dialog-footer"},Ps={class:"batch-sku-generator"},Ms={style:{display:"flex","align-items":"center","justify-content":"space-between"}},Ks={key:0,class:"batch-preview"},As={class:"preview-grid"},Fs={class:"sku-info"},Ts={class:"sku-name"},Is={class:"sku-specs"},Ls={class:"dialog-footer"},js={class:"sku-specs"},Bs={class:"add-spec-form"},qs={key:0,class:"specs-list"},Es={class:"specs-grid"},Rs={class:"spec-content"},Ns={class:"spec-name"},Os={class:"spec-actions"},Js={class:"image-input-section"},Ws={class:"input-mode-selector"},Gs={key:0,class:"url-input-mode"},Hs={key:0,class:"url-preview"},Zs={class:"image-error"},Qs={key:1,class:"upload-mode"},Xs={class:"dialog-footer"},Ys={class:"fake-product-selection"},eo={key:0,class:"product-summary"},lo=["src","alt"],to={class:"product-info"},ao={class:"product-title"},so={class:"product-price"},oo={style:{display:"flex","align-items":"center","justify-content":"space-between"}},no={class:"search-section"},io={class:"fake-products-grid"},uo=["onClick"],ro=["src","alt"],co={class:"card-content"},po={class:"card-title"},_o={class:"card-price"},mo={class:"card-check"},fo={key:0,class:"empty-state"},go={key:0,class:"fake-pagination"},vo={class:"dialog-footer"},yo=Ee({name:"ProductList"}),ko=Ee({...yo,setup(M){const oe=g(!1),Q=g(!1),O=g(!1),Y=g(""),J=g(),ee=g(!1),E=g(!1),ye=g(""),le=g(!1),ke=g(!1),be=g(),X=g(null),ne=g([]),W=g(""),w=g(""),C=g([]),B=g("url"),K=ve({title:"",status:null,product_type:""}),T=ve({current:1,size:20,total:0}),ie=g([]),R=g([]),de=g(!1),d=ve({id:null,spu_id:"",title:"",sell_price:0,origin_price:0,discount:0,image_urls:[],rich_text_content:"",specification_list:[],variants:[],status:"active",product_type:"original",b_page_product_id:"",cloak_rule_id:null,country:"JA",template:"classic",page_primary_color:"#007d65",head_w_marquee:""}),Pe=g([]),Me=g([]),he=g(!1),ce=g(!1),$=g(null),Ke=g([]),Ae=g(!1),te=g(""),Fe=g(""),q=ve({current:1,size:12,total:0}),Ve=g(!1),Re=g(!1),V=ve({sell_price:0,origin_price:0,cost_price:0,discount_percent:0,stock_quantity:1e3,specs:[]}),N=g([]),we=g(!1),Ne=g(!1),sl=g("attribute"),ae=g([]),Se=g({}),pe=g(-1),_e=g(-1),Oe=g(""),ue=g(!1),me=g(!1),Ml=[{label:"日本",value:"JA"},{label:"中国",value:"ZH"},{label:"英国",value:"EN"},{label:"斯洛伐克",value:"SK"},{label:"斯洛文尼亚",value:"SI"},{label:"波兰",value:"PL"},{label:"葡萄牙",value:"PT"},{label:"匈牙利",value:"HU"},{label:"意大利",value:"IT"},{label:"西班牙",value:"ES"},{label:"捷克",value:"CZ"}],Kl=$e(()=>me.value?"calc(100vh - 200px)":"500px"),Al=$e(()=>({placeholder:"请输入商品描述内容...",MENU_CONF:{uploadImage:{server:ol.value,fieldName:"file",maxFileSize:2*1024*1024,allowedFileTypes:["image/*"]}}})),ol=$e(()=>"https://gammtt.shop/admin/upload/image"),m=ve({id:null,product_id:"",sku_code:"",sku_name:"",sell_price:0,origin_price:0,cost_price:0,discount_percent:0,stock_quantity:0,warning_stock:10,main_image:"",status:"active",attributes:[]}),Fl={title:[{required:!0,message:"请输入商品标题",trigger:"blur"},{min:2,max:500,message:"商品标题长度在 2 到 500 个字符",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"change"}],page_primary_color:[{pattern:/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,message:"请输入有效的颜色代码，如 #007d65",trigger:"blur"}]},Tl={sku_name:[{required:!0,message:"请输入SKU名称",trigger:"blur"}],sell_price:[{required:!0,message:"请输入销售价格",trigger:"blur"}],stock_quantity:[{required:!0,message:"请输入库存数量",trigger:"blur"}]},Il=()=>{if(m.origin_price>0&&m.sell_price>0){const s=Math.round((m.origin_price-m.sell_price)/m.origin_price*100);m.discount_percent=Math.max(0,Math.min(100,s))}else m.discount_percent=0};el(()=>[m.sell_price,m.origin_price],()=>{Il()},{deep:!0}),el(()=>[d.sell_price,d.origin_price],()=>{Ge()},{deep:!0});const Ll=s=>({active:"success",inactive:"danger",draft:"warning",deleted:"info"})[s]||"info",jl=s=>({active:"上架",inactive:"下架",draft:"草稿",deleted:"已删除"})[s]||s,Bl=s=>({active:"success",inactive:"danger",out_of_stock:"warning"})[s]||"info",ql=s=>({active:"正常",inactive:"禁用",out_of_stock:"缺货"})[s]||s,Je=()=>{T.current=1,G()},El=()=>{Object.assign(K,{title:"",status:null,product_type:""}),Je()},Rl=()=>{Y.value="添加商品",Object.assign(d,{id:null,spu_id:"",title:"",sell_price:0,origin_price:0,discount:0,image_urls:[],rich_text_content:"",specification_list:[],variants:[],status:"active",product_type:"original",b_page_product_id:"",cloak_rule_id:null,country:"JA"}),Pe.value=[],Me.value=[],R.value.length===0&&!de.value&&Qe(),R.value.length,R.value,O.value=!0},We=s=>{const n=`https://ofadaaferac.shop/product/${s.id}`;window.open(n,"_blank"),_.success("正在跳转到商品页面...")},Nl=s=>{Y.value="编辑商品",s.cloak_rule_id,s.cloak_rule_id;const e={...s,sell_price:parseFloat(s.sell_price)||0,origin_price:parseFloat(s.origin_price)||0,discount:parseFloat(s.discount)||0,product_type:s.product_type||"original",b_page_product_id:s.b_page_product_id||"",country:s.country||"JA",template:s.template||"classic",cloak_rule_id:s.cloak_rule_id||null};e.cloak_rule_id,Object.assign(d,e),Pe.value=(s.image_urls||[]).map((n,c)=>({name:`image_${c}.jpg`,url:n,response:{success:!0,data:{url:n,file_name:`image_${c}.jpg`}}})),R.value.length===0&&!de.value&&Qe(),R.value.length,d.cloak_rule_id,R.value,O.value=!0},Ol=s=>{xe.confirm(`确定要删除商品 "${s.title}" 吗？删除后无法恢复！`,"删除确认",{confirmButtonText:"确定删除",cancelButtonText:"取消",type:"warning",confirmButtonClass:"el-button--danger"}).then(async()=>{try{await oa(s.id),_.success("删除成功"),G()}catch{_.error("删除失败")}})},Jl=async()=>{J.value&&J.value.validate(async s=>{if(s){Q.value=!0;try{d.cloak_rule_id,d.cloak_rule_id,d.id?(d.id,await na(d.id,d),_.success("更新成功")):(await ia(d),_.success("添加成功")),O.value=!1,G()}catch(e){console.error("提交失败:",e),_.error(d.id?"更新失败":"添加失败")}finally{Q.value=!1}}})},Wl=s=>{T.size=s,G()},Gl=s=>{T.current=s,G()},Hl=s=>{const e=s.type.startsWith("image/"),n=s.size/1024/1024<2;return e?n?!0:(_.error("图片大小不能超过 2MB!"),!1):(_.error("只能上传图片文件!"),!1)},Zl=(s,e)=>{s&&s.success&&s.data&&s.data.url?(d.image_urls.push(s.data.url),e.fileName=s.data.file_name,_.success("图片上传成功")):_.error("图片上传失败: "+(s.error||"未知错误"))},Ql=s=>{if(s.response&&s.response.url){const e=d.image_urls.indexOf(s.response.url);e>-1&&d.image_urls.splice(e,1)}},Xl=()=>{_.error("图片上传失败")},Yl=()=>{me.value=!me.value},et=s=>{d.rich_text_content=s},lt=()=>{xe.confirm("确定要清空商品描述内容吗？","清空确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{d.rich_text_content="",_.success("内容已清空")})},G=async()=>{oe.value=!0;try{const s={page:T.current,size:T.size,title:K.title||void 0,status:K.status||void 0,product_type:K.product_type||void 0},{data:e}=await Ul(s);e.list[0],ie.value=e.list,T.total=e.total}catch{_.error("获取商品列表失败")}finally{oe.value=!1}},tt=async s=>{X.value=s,ee.value=!0,await Te(s.id)},Te=async s=>{le.value=!0;try{const{data:e}=await ca(s);ne.value=e}catch{_.error("获取SKU列表失败")}finally{le.value=!1}},at=()=>{if(!W.value.trim()||!w.value.trim()){_.warning("请输入规格名称和值");return}const s=W.value.trim(),e=w.value.trim();if(C.value.find(p=>p.name===s&&p.value===e)){_.warning(`规格 "${s}: ${e}" 已存在，请勿重复添加`);return}const c=C.value.find(p=>p.name===s);if(c){_.warning(`属性 "${s}" 已存在值 "${c.value}"，一个SKU的同一属性只能设置一个值。如需修改，请先删除现有规格。`);return}const u={name:s,value:e};C.value.push(u),W.value="",w.value="",_.success("规格添加成功")},st=s=>{C.value.splice(s,1),_.success("规格删除成功")},ot=s=>{const e=C.value[s];W.value=e.name,w.value=e.value,C.value.splice(s,1),_.info("请修改规格信息后点击添加按钮")},nt=()=>{var c;ye.value="添加SKU";const s=Date.now(),e=Math.floor(Math.random()*1e3).toString().padStart(3,"0"),n=`SKU${s}${e}`;Object.assign(m,{id:null,product_id:((c=X.value)==null?void 0:c.id)||"",sku_code:n,sku_name:"",sell_price:0,origin_price:0,cost_price:0,discount_percent:0,stock_quantity:0,warning_stock:10,main_image:"",status:"active",attributes:[]}),C.value=[],W.value="",w.value="",E.value=!0},it=s=>{ye.value="编辑SKU";const e={...s,sell_price:parseFloat(s.sell_price)||0,origin_price:parseFloat(s.origin_price)||0,cost_price:parseFloat(s.cost_price)||0,discount_percent:parseFloat(s.discount_percent)||0,stock_quantity:parseInt(s.stock_quantity)||0,warning_stock:parseInt(s.warning_stock)||10};Object.assign(m,e),C.value=s.attributes.map(n=>({name:n.attribute_name||n.display_name||"",value:n.value||n.display_value||"",attribute_id:n.attribute_id||null,attribute_value_id:n.attribute_value_id||null})),E.value=!0},ut=s=>{xe.confirm(`确定要删除SKU "${s.sku_name}" 吗？`,"删除确认",{confirmButtonText:"确定删除",cancelButtonText:"取消",type:"warning"}).then(async()=>{var e,n,c;try{await _a(s.id),_.success("删除成功"),await Te(((e=X.value)==null?void 0:e.id)||"")}catch(u){console.error("删除SKU失败:",u);let p="删除失败";(c=(n=u.response)==null?void 0:n.data)!=null&&c.message?p=u.response.data.message:u.message&&(p=u.message),_.error(p)}})},rt=()=>{const s=C.value.map(n=>n.name),e=s.filter((n,c)=>s.indexOf(n)!==c);if(e.length>0)throw _.error(`检测到重复的属性名: ${e.join(", ")}，请检查规格设置`),new Error("存在重复的属性名");return C.value.map(n=>n.attribute_id&&n.attribute_value_id?{attribute_id:n.attribute_id,attribute_value_id:n.attribute_value_id}:{attribute_name:n.name,value:n.value})},dt=async()=>{be.value&&be.value.validate(async s=>{var e;if(s){ke.value=!0;try{const n={...m,attributes:rt()};m.id?(await pa(m.id,n),_.success("更新成功")):(await xl(n),_.success("添加成功")),E.value=!1,await Te(((e=X.value)==null?void 0:e.id)||"")}catch(n){if(n.message==="存在重复的属性名")return;_.error(m.id?"更新失败":"添加失败")}finally{ke.value=!1}}})},ct=s=>{s!==B.value&&(m.main_image="")},pt=s=>{s==="original"?d.b_page_product_id="":s==="fake"&&(d.b_page_product_id||Ze())},Ge=()=>{const s=d.sell_price||0,e=d.origin_price||0;if(e>0&&s>0){const n=Math.round((e-s)/e*100);d.discount=Math.max(0,Math.min(100,n))}else(e===0||s===0)&&(d.discount=0)},_t=()=>{Object.assign(V,{sell_price:0,origin_price:0,cost_price:0,discount_percent:0,stock_quantity:1e3,specs:[]}),N.value=[],Ve.value=!0},nl=()=>{const s=V.origin_price||0,e=V.sell_price||0;if(s>0&&e>0){const n=Math.round((s-e)/s*100);V.discount_percent=Math.max(0,Math.min(100,n))}else V.discount_percent=0},mt=()=>{V.specs.push({name:"",values:""}),He()},ft=s=>{V.specs.splice(s,1),He()},He=()=>{const s=V.specs.filter(p=>p.name.trim()&&p.values.trim());if(s.length===0){N.value=[];return}const e=s.map(p=>p.name.trim()),n=e.filter((p,P)=>e.indexOf(p)!==P);if(n.length>0){_.warning(`检测到重复的规格名称: ${n.join(", ")}，请确保每个规格名称唯一`),N.value=[];return}const c=s.map(p=>({name:p.name.trim(),values:p.values.split(`
`).map(P=>P.trim()).filter(P=>P)})),u=il(c);N.value=u.map(p=>({sku_name:p.map(h=>`${h.name}:${h.value}`).join(" "),attributes:p}))},il=s=>{if(s.length===0)return[];if(s.length===1)return s[0].values.map(p=>[{name:s[0].name,value:p}]);const e=[],n=s[0],c=s.slice(1),u=il(c);for(const p of n.values)for(const P of u)e.push([{name:n.name,value:p},...P]);return e};el(()=>V.specs,()=>{He()},{deep:!0});const gt=async()=>{var c;if(N.value.length===0){_.warning("请配置规格信息");return}if(!V.sell_price||!V.stock_quantity){_.warning("请填写销售价格和库存数量");return}const e=V.specs.filter(u=>u.name.trim()&&u.values.trim()).map(u=>u.name.trim()),n=e.filter((u,p)=>e.indexOf(u)!==p);if(n.length>0){_.error(`检测到重复的规格名称: ${n.join(", ")}，请确保每个规格名称唯一`);return}Re.value=!0;try{const u=Date.now(),p=N.value.map(async(P,h)=>{var x;const k=u+h,fe=Math.floor(Math.random()*1e4).toString().padStart(4,"0"),se=()=>{const Z=V.origin_price||0,Ue=V.sell_price||0;if(Z>0&&Ue>0){const Le=Math.round((Z-Ue)/Z*100);return Math.max(0,Math.min(100,Le))}return 0},H={product_id:((x=X.value)==null?void 0:x.id)||"",sku_code:`SKU${k}${fe}`,sku_name:P.sku_name,sell_price:V.sell_price,origin_price:V.origin_price,cost_price:V.cost_price,discount_percent:se(),stock_quantity:V.stock_quantity,warning_stock:10,main_image:"",status:"active",attributes:P.attributes.map(Z=>({attribute_name:Z.name,value:Z.value}))};return xl(H)});await Promise.all(p),_.success(`成功生成 ${N.value.length} 个SKU`),Ve.value=!1,await Te(((c=X.value)==null?void 0:c.id)||"")}catch(u){console.error("批量生成SKU失败:",u),_.error("批量生成失败")}finally{Re.value=!1}},vt=()=>{kt(),ue.value=!1,we.value=!0},yt=()=>{ue.value=!ue.value},kt=()=>{const s=new Map;ne.value.forEach(e=>{e.attributes.forEach(n=>{const c=n.display_name||n.attribute_name,u=n.display_value||n.value;s.has(c)||s.set(c,new Map);const p=s.get(c);p.has(u)||p.set(u,[]),p.get(u).push(e)})}),ae.value=Array.from(s.keys()).map(e=>{const n=s.get(e),c=Array.from(n.values()).reduce((u,p)=>u+p.length,0);return{name:e,count:c,values:Array.from(n.keys())}}),Se.value={},s.forEach((e,n)=>{Se.value[n]=Array.from(e.keys()).map(c=>{const u=e.get(c);return{value:c,count:u.length,skus:u}})})},bt=s=>Se.value[s]||[],ht=(s,e)=>{pe.value=e,s.dataTransfer&&(s.dataTransfer.effectAllowed="move")},Vt=(s,e)=>{if(s.preventDefault(),pe.value===-1||pe.value===e)return;const n=ae.value[pe.value];ae.value.splice(pe.value,1),ae.value.splice(e,0,n),pe.value=-1},wt=(s,e,n)=>{_e.value=n,Oe.value=e,s.dataTransfer&&(s.dataTransfer.effectAllowed="move")},St=(s,e,n)=>{if(s.preventDefault(),_e.value===-1||Oe.value!==e||_e.value===n)return;const c=Se.value[e],u=c[_e.value];c.splice(_e.value,1),c.splice(n,0,u),_e.value=-1,Oe.value=""},ul=s=>{s.preventDefault(),s.dataTransfer&&(s.dataTransfer.dropEffect="move")},Ut=async()=>{if(ae.value.length===0){_.warning("没有属性需要排序");return}Ne.value=!0;try{const s=[];ae.value.forEach(e=>{Se.value[e.name].forEach(c=>{c.skus.forEach(u=>{s.find(p=>p.id===u.id)||s.push(u)})})}),ne.value=s,await Ct(s),_.success("排序保存成功"),we.value=!1}catch(s){console.error("保存排序失败:",s),_.error("保存排序失败")}finally{Ne.value=!1}},Ct=async s=>{try{const e=s.map((c,u)=>({sku_id:c.id,sort_order:u+1})),n=await De.put(`/admin/products/${X.value.id}/skus/sort`,{sort_data:e});if(n.code!==200)throw new Error(n.message||"保存排序失败")}catch(e){throw console.error("保存排序到后端失败:",e),e}},zt=()=>{const s=d.origin_price||0,e=d.discount||0;s>0&&e>=0&&(d.sell_price=Math.round(s*(1-e/100)*100)/100)},rl=()=>{const s=m.sell_price||0,e=m.origin_price||0;if(e>0&&s>0){const n=Math.round((e-s)/e*100);m.discount_percent=Math.max(0,Math.min(100,n))}else(e===0||s===0)&&(m.discount_percent=0)},xt=()=>{const s=m.origin_price||0,e=m.discount_percent||0;s>0&&e>=0&&(m.sell_price=Math.round(s*(1-e/100)*100)/100)},$t=async s=>{if(!s){await Ze();return}he.value=!0;try{const{data:e}=await Cl(s);Me.value=e}catch{_.error("搜索正品商品失败")}finally{he.value=!1}},Ze=async()=>{he.value=!0;try{const{data:s}=await Cl();Me.value=s}catch{_.error("加载正品商品列表失败")}finally{he.value=!1}},Dt=s=>{const e=ie.value.find(n=>n.id===s);return e?e.title:"未知商品"},dl=s=>ie.value.filter(e=>e.product_type==="fake"&&e.b_page_product_id===s),Pt=s=>{const e=ie.value.find(n=>n.id===s);e&&We(e)},Mt=s=>{$.value=s,te.value="",Fe.value="",q.current=1,ce.value=!0,Ie()},Ie=async()=>{Ae.value=!0;try{const s={page:q.current,size:q.size,product_type:"fake",title:Fe.value||void 0},{data:e}=await Ul(s);Ke.value=e.list.filter(n=>!n.b_page_product_id),q.total=e.total}catch{_.error("加载仿品商品列表失败")}finally{Ae.value=!1}},Kt=()=>{q.current=1,Ie()},At=s=>{q.size=s,Ie()},Ft=s=>{q.current=s,Ie()},Tt=async()=>{if(!(!te.value||!$.value))try{await zl(te.value,$.value.id),_.success("仿品关联成功"),ce.value=!1,G()}catch{_.error("仿品关联失败")}},It=async s=>{try{await xe.confirm(`确定要取消仿品 "${s.title}" 的关联吗？取消后该仿品将不再关联任何正品。`,"取消关联确认",{confirmButtonText:"确定取消",cancelButtonText:"取消",type:"warning",confirmButtonClass:"el-button--danger"}),s.id,await zl(s.id,null),_.success("取消关联成功"),G()}catch(e){e!=="cancel"&&_.error("取消关联失败")}},Lt=async s=>{try{await xe.confirm(`确定要取消商品 "${s.title}" 的斗篷规则设置吗？取消后该商品将不再使用任何斗篷规则。`,"取消斗篷规则确认",{confirmButtonText:"确定取消",cancelButtonText:"取消",type:"warning",confirmButtonClass:"el-button--danger"}),s.id,await ua(s.id,null),_.success("取消斗篷规则设置成功"),G()}catch(e){e!=="cancel"&&_.error("取消斗篷规则设置失败")}},jt=()=>{$.value&&(ce.value=!1,Y.value="基于正品创建仿品",Object.assign(d,{id:null,spu_id:"",title:`${$.value.title} - 仿品版`,sell_price:Math.round(($.value.sell_price||0)*.6),origin_price:$.value.sell_price||0,discount:40,image_urls:[...$.value.image_urls||[]],rich_text_content:$.value.rich_text_content||"",specification_list:[...$.value.specification_list||[]],variants:[...$.value.variants||[]],status:"draft",product_type:"fake",b_page_product_id:$.value.id,cloak_rule_id:null,country:$.value.country||"JA"}),Pe.value=($.value.image_urls||[]).map((s,e)=>({name:`image_${e}.jpg`,url:s,response:{success:!0,data:{url:s,file_name:`image_${e}.jpg`}}})),Ze(),O.value=!0,_.success(`已基于正品"${$.value.title}"创建仿品，请修改相关信息后保存`))},Qe=async()=>{if(!de.value)try{de.value=!0;const s=await ra.getCloakRules({page:1,size:1e3});if(s.code===200){const e=s.data.list,n=e.filter(c=>c.is_active===1);R.value=n,R.value}else console.error("斗篷规则API返回错误:",s)}catch(s){console.error("加载斗篷规则失败:",s),_.error("加载斗篷规则失败")}finally{de.value=!1}},cl=s=>({cloak:"warning",green:"success",open:"info",audit:"danger"})[s]||"info",pl=s=>({cloak:"斗篷",green:"绿色",open:"全开",audit:"审核"})[s]||s,Bt=s=>{d.cloak_rule_id=s,s&&(R.value.find(n=>n.id===s)||console.warn("未找到对应的斗篷规则，ID:",s))};return Qt(()=>{G(),Qe()}),(s,e)=>{const n=U("el-icon"),c=U("el-input"),u=U("el-form-item"),p=U("el-option"),P=U("el-select"),h=U("el-tag"),k=U("el-button"),fe=U("el-form"),se=U("el-card"),H=U("el-avatar"),x=U("el-table-column"),Z=U("el-tooltip"),Ue=U("el-table"),Le=U("el-pagination"),A=U("el-input-number"),S=U("el-col"),F=U("el-row"),Ce=U("el-radio"),_l=U("el-radio-group"),qt=U("el-upload"),ge=U("el-dialog"),Xe=U("el-alert"),ml=U("el-tab-pane"),Et=U("el-tabs"),fl=U("el-divider"),Rt=U("el-image"),Nt=U("el-empty"),Ye=Xt("loading");return r(),f("div",ba,[l(se,{class:"search-card",shadow:"never"},{default:t(()=>[l(fe,{model:K,inline:"",class:"search-form"},{default:t(()=>[l(u,{label:"商品标题"},{default:t(()=>[l(c,{modelValue:K.title,"onUpdate:modelValue":e[0]||(e[0]=a=>K.title=a),placeholder:"请输入商品标题",clearable:"",style:{width:"200px"},onKeyup:Yt(Je,["enter"])},{prefix:t(()=>[l(n,null,{default:t(()=>[l(v(ll))]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(u,{label:"状态"},{default:t(()=>[l(P,{modelValue:K.status,"onUpdate:modelValue":e[1]||(e[1]=a=>K.status=a),placeholder:"请选择状态",clearable:"",style:{width:"120px"}},{default:t(()=>[l(p,{label:"上架",value:"active"}),l(p,{label:"下架",value:"inactive"}),l(p,{label:"草稿",value:"draft"})]),_:1},8,["modelValue"])]),_:1}),l(u,{label:"商品类型"},{default:t(()=>[l(P,{modelValue:K.product_type,"onUpdate:modelValue":e[2]||(e[2]=a=>K.product_type=a),placeholder:"请选择类型",clearable:"",style:{width:"120px"}},{default:t(()=>[l(p,{label:"全部",value:""},{default:t(()=>[l(h,{type:"info",size:"small"},{default:t(()=>[...e[56]||(e[56]=[i("全部",-1)])]),_:1})]),_:1}),l(p,{label:"正品",value:"original"},{default:t(()=>[l(h,{type:"success",size:"small"},{default:t(()=>[...e[57]||(e[57]=[i("正品",-1)])]),_:1})]),_:1}),l(p,{label:"仿品",value:"fake"},{default:t(()=>[l(h,{type:"warning",size:"small"},{default:t(()=>[...e[58]||(e[58]=[i("仿品",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(u,null,{default:t(()=>[l(k,{type:"primary",onClick:Je},{default:t(()=>[l(n,null,{default:t(()=>[l(v(ll))]),_:1}),e[59]||(e[59]=i(" 搜索 ",-1))]),_:1}),l(k,{onClick:El},{default:t(()=>[l(n,null,{default:t(()=>[l(v(yl))]),_:1}),e[60]||(e[60]=i(" 重置 ",-1))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),l(se,{class:"table-card",shadow:"never"},{header:t(()=>[o("div",ha,[o("div",Va,[l(k,{type:"primary",onClick:Rl},{default:t(()=>[l(n,null,{default:t(()=>[l(v(re))]),_:1}),e[61]||(e[61]=i(" 添加商品 ",-1))]),_:1}),e[62]||(e[62]=o("span",null,"商品列表",-1)),l(h,{type:"info",size:"small"},{default:t(()=>[i(y(T.total)+" 条记录",1)]),_:1})]),o("div",wa,[l(k,{size:"small",onClick:G},{default:t(()=>[l(n,null,{default:t(()=>[l(v(yl))]),_:1}),e[63]||(e[63]=i(" 刷新 ",-1))]),_:1})])])]),default:t(()=>[tl((r(),z(Ue,{data:ie.value,stripe:"",border:"",style:{width:"100%"},"header-cell-style":{background:"#f8f9fa",color:"#606266"}},{default:t(()=>[l(x,{prop:"title",label:"商品标题","min-width":"200","show-overflow-tooltip":""},{default:t(({row:a})=>[o("div",Sa,[a.image_urls&&a.image_urls[0]?(r(),z(H,{key:0,size:40,class:"product-avatar"},{default:t(()=>[o("img",{src:a.image_urls[0],alt:a.title,style:{width:"100%",height:"100%","object-fit":"cover"}},null,8,Ua)]),_:2},1024)):(r(),z(H,{key:1,size:40,class:"product-avatar"},{default:t(()=>[l(n,null,{default:t(()=>[l(v(je))]),_:1})]),_:1})),o("div",Ca,[o("div",za,y(a.title),1),o("div",xa,y(a.sell_price?"¥"+a.sell_price:"暂未定价"),1)])])]),_:1}),l(x,{prop:"sell_price",label:"销售价",width:"90",align:"center"},{default:t(({row:a})=>[a.sell_price?(r(),f("span",$a," ¥"+y(a.sell_price),1)):(r(),f("span",Da,"--"))]),_:1}),l(x,{prop:"origin_price",label:"原价",width:"90",align:"center"},{default:t(({row:a})=>[a.origin_price&&a.origin_price>0?(r(),f("span",Pa," ¥"+y(a.origin_price),1)):(r(),f("span",Ma,"--"))]),_:1}),l(x,{prop:"discount",label:"折扣",width:"80",align:"center"},{default:t(({row:a})=>[a.discount&&a.discount>0?(r(),z(h,{key:0,type:"success",size:"small"},{default:t(()=>[i(y(a.discount)+"% OFF ",1)]),_:2},1024)):(r(),f("span",Ka,"--"))]),_:1}),l(x,{prop:"product_type",label:"类型",width:"100",align:"center"},{default:t(({row:a})=>[l(h,{type:a.product_type==="original"?"success":"warning",size:"small"},{default:t(()=>[i(y(a.product_type==="original"?"正品":"仿品"),1)]),_:2},1032,["type"])]),_:1}),l(x,{label:"关联关系",width:"150",align:"center"},{default:t(({row:a})=>[a.product_type==="original"?(r(),f("div",Aa,[dl(a.id).length>0?(r(),f("div",Fa,[(r(!0),f(I,null,j(dl(a.id),b=>(r(),z(Z,{key:b.id,content:`仿品: ${b.title}`,placement:"top"},{default:t(()=>[l(h,{type:"warning",size:"small",style:{margin:"2px",cursor:"pointer"},onClick:D=>We(b)},{default:t(()=>[...e[64]||(e[64]=[i(" 仿品 ",-1)])]),_:1},8,["onClick"])]),_:2},1032,["content"]))),128))])):(r(),f("span",Ta,"-"))])):a.b_page_product_id?(r(),f("div",Ia,[l(Z,{content:`关联正品: ${Dt(a.b_page_product_id)}`,placement:"top"},{default:t(()=>[l(h,{type:"info",size:"small",style:{cursor:"pointer"},onClick:b=>Pt(a.b_page_product_id)},{default:t(()=>[...e[65]||(e[65]=[i(" 已关联 ",-1)])]),_:1},8,["onClick"])]),_:2},1032,["content"]),l(k,{size:"small",type:"danger",link:"",onClick:b=>It(a),style:{"margin-left":"8px"}},{default:t(()=>[l(n,null,{default:t(()=>[l(v(kl))]),_:1}),e[66]||(e[66]=i(" 取消关联 ",-1))]),_:1},8,["onClick"])])):(r(),f("span",La,"未关联"))]),_:1}),l(x,{prop:"country",label:"国家",width:"80",align:"center"},{default:t(({row:a})=>[l(h,{type:"primary",size:"small"},{default:t(()=>[i(y(a.country||"JA"),1)]),_:2},1024)]),_:1}),l(x,{prop:"template",label:"展示模板",width:"120",align:"center"},{default:t(({row:a})=>[a.template==="shopline"?(r(),z(h,{key:0,type:"success",size:"small"},{default:t(()=>[...e[67]||(e[67]=[i(" Shopline ",-1)])]),_:1})):(r(),z(h,{key:1,type:"info",size:"small"},{default:t(()=>[...e[68]||(e[68]=[i(" Classic ",-1)])]),_:1}))]),_:1}),l(x,{prop:"cloak_rule_name",label:"斗篷规则",width:"200",align:"center"},{default:t(({row:a})=>[a.cloak_rule_name?(r(),f("div",ja,[l(Z,{content:`规则: ${a.cloak_rule_name}`,placement:"top"},{default:t(()=>[l(h,{type:cl(a.cloak_rule_mode),size:"small"},{default:t(()=>[i(y(a.cloak_rule_name),1)]),_:2},1032,["type"])]),_:2},1032,["content"]),l(k,{size:"small",type:"danger",link:"",onClick:b=>Lt(a),style:{"margin-left":"8px"}},{default:t(()=>[l(n,null,{default:t(()=>[l(v(kl))]),_:1}),e[69]||(e[69]=i(" 取消设置 ",-1))]),_:1},8,["onClick"])])):(r(),f("span",Ba,"未设置"))]),_:1}),l(x,{prop:"status",label:"状态",width:"100",align:"center"},{default:t(({row:a})=>[l(h,{type:Ll(a.status),size:"small",effect:"light"},{default:t(()=>[i(y(jl(a.status)),1)]),_:2},1032,["type"])]),_:1}),l(x,{prop:"view_count",label:"浏览量",width:"100",align:"center"},{default:t(({row:a})=>[o("div",qa,[l(n,{class:"count-icon"},{default:t(()=>[l(v(bl))]),_:1}),o("span",null,y(a.view_count||0),1)])]),_:1}),l(x,{prop:"sale_count",label:"销量",width:"100",align:"center"},{default:t(({row:a})=>[o("div",Ea,[l(n,{class:"count-icon"},{default:t(()=>[l(v(ea))]),_:1}),o("span",null,y(a.sale_count||0),1)])]),_:1}),l(x,{prop:"created_at",label:"创建时间",width:"180","show-overflow-tooltip":""},{default:t(({row:a})=>[o("div",Ra,[l(n,{class:"time-icon"},{default:t(()=>[l(v(la))]),_:1}),o("span",null,y(a.created_at),1)])]),_:1}),l(x,{label:"操作",width:"420",fixed:"right",align:"center"},{default:t(({row:a})=>[o("div",Na,[l(k,{size:"small",type:"primary",link:"",onClick:b=>We(a)},{default:t(()=>[l(n,null,{default:t(()=>[l(v(bl))]),_:1}),e[70]||(e[70]=i(" 查看 ",-1))]),_:1},8,["onClick"]),l(k,{size:"small",type:"success",link:"",onClick:b=>tt(a)},{default:t(()=>[l(n,null,{default:t(()=>[l(v(ta))]),_:1}),e[71]||(e[71]=i(" SKU管理 ",-1))]),_:1},8,["onClick"]),a.product_type==="original"?(r(),z(k,{key:0,size:"small",type:"info",link:"",onClick:b=>Mt(a)},{default:t(()=>[l(n,null,{default:t(()=>[l(v(re))]),_:1}),e[72]||(e[72]=i(" 关联仿品 ",-1))]),_:1},8,["onClick"])):L("",!0),l(k,{size:"small",type:"warning",link:"",onClick:b=>Nl(a)},{default:t(()=>[l(n,null,{default:t(()=>[l(v(Dl))]),_:1}),e[73]||(e[73]=i(" 编辑 ",-1))]),_:1},8,["onClick"]),l(k,{size:"small",type:"danger",link:"",onClick:b=>Ol(a)},{default:t(()=>[l(n,null,{default:t(()=>[l(v(qe))]),_:1}),e[74]||(e[74]=i(" 删除 ",-1))]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["data"])),[[Ye,oe.value]]),o("div",Oa,[l(Le,{"current-page":T.current,"onUpdate:currentPage":e[3]||(e[3]=a=>T.current=a),"page-size":T.size,"onUpdate:pageSize":e[4]||(e[4]=a=>T.size=a),"page-sizes":[10,20,50,100],total:T.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:Wl,onCurrentChange:Gl},null,8,["current-page","page-size","total"])])]),_:1}),l(ge,{modelValue:O.value,"onUpdate:modelValue":e[19]||(e[19]=a=>O.value=a),title:Y.value,fullscreen:!0,"close-on-click-modal":!1,"destroy-on-close":"",class:"product-dialog"},{footer:t(()=>[o("div",Ya,[l(k,{onClick:e[18]||(e[18]=a=>O.value=!1)},{default:t(()=>[...e[101]||(e[101]=[i("取消",-1)])]),_:1}),l(k,{type:"primary",onClick:Jl,loading:Q.value},{default:t(()=>[...e[102]||(e[102]=[i(" 确定 ",-1)])]),_:1},8,["loading"])])]),default:t(()=>[l(fe,{model:d,rules:Fl,ref_key:"formRef",ref:J,"label-width":"100px",class:"product-form"},{default:t(()=>[l(u,{label:"SPU ID"},{default:t(()=>[l(c,{modelValue:d.spu_id,"onUpdate:modelValue":e[5]||(e[5]=a=>d.spu_id=a),placeholder:"保存后生成",readonly:""},null,8,["modelValue"]),e[75]||(e[75]=o("div",{class:"form-tip"},"SPU ID由后端自动生成，创建商品后自动显示",-1))]),_:1}),l(u,{label:"商品标题",prop:"title"},{default:t(()=>[l(c,{modelValue:d.title,"onUpdate:modelValue":e[6]||(e[6]=a=>d.title=a),placeholder:"请输入商品标题"},null,8,["modelValue"])]),_:1}),l(F,{gutter:20},{default:t(()=>[l(S,{span:12},{default:t(()=>[l(u,{label:"销售价格",prop:"sell_price"},{default:t(()=>[l(A,{modelValue:d.sell_price,"onUpdate:modelValue":e[7]||(e[7]=a=>d.sell_price=a),precision:2,min:0,placeholder:"请输入销售价格",style:{width:"100%"},onChange:Ge},{append:t(()=>[...e[76]||(e[76]=[i("元",-1)])]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(S,{span:12},{default:t(()=>[l(u,{label:"原价",prop:"origin_price"},{default:t(()=>[l(A,{modelValue:d.origin_price,"onUpdate:modelValue":e[8]||(e[8]=a=>d.origin_price=a),precision:2,min:0,placeholder:"请输入原价",style:{width:"100%"},onChange:Ge},{append:t(()=>[...e[77]||(e[77]=[i("元",-1)])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(F,{gutter:20},{default:t(()=>[l(S,{span:12},{default:t(()=>[l(u,{label:"折扣(%)",prop:"discount"},{default:t(()=>[l(A,{modelValue:d.discount,"onUpdate:modelValue":e[9]||(e[9]=a=>d.discount=a),precision:0,min:0,max:100,placeholder:"自动计算",style:{width:"100%"},onChange:zt},{append:t(()=>[...e[78]||(e[78]=[i("%",-1)])]),_:1},8,["modelValue"]),e[79]||(e[79]=o("div",{class:"form-tip"},"输入销售价和原价后自动计算，或手动输入折扣",-1))]),_:1})]),_:1}),l(S,{span:12},{default:t(()=>[l(u,{label:"状态",prop:"status"},{default:t(()=>[l(P,{modelValue:d.status,"onUpdate:modelValue":e[10]||(e[10]=a=>d.status=a),style:{width:"100%"}},{default:t(()=>[l(p,{label:"上架",value:"active"},{default:t(()=>[l(h,{type:"success",size:"small"},{default:t(()=>[...e[80]||(e[80]=[i("上架",-1)])]),_:1})]),_:1}),l(p,{label:"下架",value:"inactive"},{default:t(()=>[l(h,{type:"danger",size:"small"},{default:t(()=>[...e[81]||(e[81]=[i("下架",-1)])]),_:1})]),_:1}),l(p,{label:"草稿",value:"draft"},{default:t(()=>[l(h,{type:"warning",size:"small"},{default:t(()=>[...e[82]||(e[82]=[i("草稿",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(F,{gutter:20},{default:t(()=>[l(S,{span:12},{default:t(()=>[l(u,{label:"商品类型",prop:"product_type"},{default:t(()=>[l(_l,{modelValue:d.product_type,"onUpdate:modelValue":e[11]||(e[11]=a=>d.product_type=a),onChange:pt},{default:t(()=>[l(Ce,{value:"original"},{default:t(()=>[l(h,{type:"success",size:"small"},{default:t(()=>[...e[83]||(e[83]=[i("正品",-1)])]),_:1}),e[84]||(e[84]=i(" 正品商品 ",-1))]),_:1}),l(Ce,{value:"fake"},{default:t(()=>[l(h,{type:"warning",size:"small"},{default:t(()=>[...e[85]||(e[85]=[i("仿品",-1)])]),_:1}),e[86]||(e[86]=i(" 仿品商品 ",-1))]),_:1})]),_:1},8,["modelValue"]),e[87]||(e[87]=o("div",{class:"form-tip"},"正品：用户默认看到的商品；仿品：替代展示的商品",-1))]),_:1})]),_:1}),l(S,{span:12},{default:t(()=>[d.product_type==="fake"?(r(),z(u,{key:0,label:"关联正品",prop:"b_page_product_id"},{default:t(()=>[l(P,{modelValue:d.b_page_product_id,"onUpdate:modelValue":e[12]||(e[12]=a=>d.b_page_product_id=a),placeholder:"请选择对应的正品商品",filterable:"",remote:"","remote-method":$t,loading:he.value,style:{width:"100%"}},{default:t(()=>[(r(!0),f(I,null,j(Me.value,a=>(r(),z(p,{key:a.id,label:`${a.title} - ¥${a.sell_price}`,value:a.id},{default:t(()=>[o("div",Ja,[o("span",null,y(a.title),1),o("span",Wa,"¥"+y(a.sell_price),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","loading"]),e[88]||(e[88]=o("div",{class:"form-tip"},"选择这个仿品对应的正品商品",-1))]),_:1})):L("",!0)]),_:1})]),_:1}),l(F,{gutter:20},{default:t(()=>[l(S,{span:12},{default:t(()=>[l(u,{label:"目标国家",prop:"country"},{default:t(()=>[l(P,{modelValue:d.country,"onUpdate:modelValue":e[13]||(e[13]=a=>d.country=a),placeholder:"请选择目标国家",style:{width:"100%"}},{default:t(()=>[(r(),f(I,null,j(Ml,a=>l(p,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),e[89]||(e[89]=o("div",{class:"form-tip"},"选择商品投放的目标国家/地区",-1))]),_:1})]),_:1}),l(S,{span:12},{default:t(()=>[l(u,{label:"斗篷规则",prop:"cloak_rule_id"},{default:t(()=>[l(P,{modelValue:d.cloak_rule_id,"onUpdate:modelValue":e[14]||(e[14]=a=>d.cloak_rule_id=a),placeholder:"请选择斗篷规则",clearable:"",filterable:"",style:{width:"100%"},onChange:Bt,loading:de.value},{default:t(()=>[(r(!0),f(I,null,j(R.value,a=>(r(),z(p,{key:a.id,label:`${a.name} (${pl(a.mode)})`,value:a.id},{default:t(()=>[o("div",Ga,[o("span",null,y(a.name),1),l(h,{type:cl(a.mode),size:"small"},{default:t(()=>[i(y(pl(a.mode)),1)]),_:2},1032,["type"])])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","loading"]),e[90]||(e[90]=o("div",{class:"form-tip"},"选择商品使用的斗篷规则，控制不同用户看到的内容",-1)),o("div",Ha,"当前加载了 "+y(R.value.length)+" 个斗篷规则",1)]),_:1})]),_:1})]),_:1}),l(F,{gutter:20},{default:t(()=>[l(S,{span:12},{default:t(()=>[l(u,{label:"展示模板",prop:"template"},{default:t(()=>[l(P,{modelValue:d.template,"onUpdate:modelValue":e[15]||(e[15]=a=>d.template=a),placeholder:"请选择展示模板",style:{width:"100%"}},{default:t(()=>[l(p,{label:"经典模板 (Classic)",value:"classic"},{default:t(()=>[o("div",Za,[l(h,{type:"info",size:"small"},{default:t(()=>[...e[91]||(e[91]=[i("Classic",-1)])]),_:1}),e[92]||(e[92]=o("span",null,"经典模板 - 单页表单设计",-1))])]),_:1}),l(p,{label:"现代模板 (Shopline)",value:"shopline"},{default:t(()=>[o("div",Qa,[l(h,{type:"success",size:"small"},{default:t(()=>[...e[93]||(e[93]=[i("Shopline",-1)])]),_:1}),e[94]||(e[94]=o("span",null,"现代模板 - 分离式结账设计",-1))])]),_:1})]),_:1},8,["modelValue"]),e[95]||(e[95]=o("div",{class:"form-tip"},[o("strong",null,"Classic:"),i(" 传统单页设计，商品详情和表单在同一页 "),o("br"),o("strong",null,"Shopline:"),i(" 现代化设计，商品展示和结账分离，纯黑白简洁风格 ")],-1))]),_:1})]),_:1})]),_:1}),l(F,{gutter:20},{default:t(()=>[l(S,{span:12},{default:t(()=>[l(u,{label:"页面主要颜色",prop:"page_primary_color"},{default:t(()=>[l(c,{modelValue:d.page_primary_color,"onUpdate:modelValue":e[16]||(e[16]=a=>d.page_primary_color=a),placeholder:"#007d65",style:{width:"100%"}},{prepend:t(()=>[...e[96]||(e[96]=[i("#",-1)])]),_:1},8,["modelValue"]),e[97]||(e[97]=o("div",{class:"form-tip"},"设置页面主要颜色，默认为主题色 #007d65",-1))]),_:1})]),_:1}),l(S,{span:12},{default:t(()=>[l(u,{label:"头部跑马灯内容",prop:"head_w_marquee"},{default:t(()=>[l(c,{modelValue:d.head_w_marquee,"onUpdate:modelValue":e[17]||(e[17]=a=>d.head_w_marquee=a),type:"textarea",rows:3,placeholder:"留空则显示产品标题",style:{width:"100%"}},null,8,["modelValue"]),e[98]||(e[98]=o("div",{class:"form-tip"},"设置头部跑马灯显示内容，留空则显示产品标题",-1))]),_:1})]),_:1})]),_:1}),l(u,{label:"商品图片",prop:"image_urls"},{default:t(()=>[l(qt,{class:"upload-demo",drag:"",action:ol.value,multiple:"","file-list":Pe.value,"before-upload":Hl,"on-success":Zl,"on-remove":Ql,"on-error":Xl,"list-type":"picture-card",accept:"image/*"},{default:t(()=>[l(n,{class:"el-icon--upload"},{default:t(()=>[l(v(hl))]),_:1}),e[99]||(e[99]=o("div",{class:"el-upload__text"},[i("将图片拖到此处，或"),o("em",null,"点击上传")],-1))]),_:1},8,["action","file-list"])]),_:1}),l(u,{label:"商品描述",prop:"rich_text_content"},{default:t(()=>[o("div",{class:Be(["wang-editor-wrapper",me.value?"fullscreen":""])},[l(da,{value:d.rich_text_content||"",height:Kl.value,"editor-config":Al.value,"onUpdate:value":et},null,8,["value","height","editor-config"]),o("div",Xa,[l(k,{size:"small",onClick:Yl,title:"调整编辑器大小"},{default:t(()=>[l(n,null,{default:t(()=>[me.value?(r(),z(v(Vl),{key:0})):(r(),z(v(wl),{key:1}))]),_:1}),i(" "+y(me.value?"恢复":"全屏编辑"),1)]),_:1}),l(k,{size:"small",onClick:lt,title:"清空内容"},{default:t(()=>[l(n,null,{default:t(()=>[l(v(qe))]),_:1}),e[100]||(e[100]=i(" 清空内容 ",-1))]),_:1})])],2)]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),l(ge,{modelValue:ee.value,"onUpdate:modelValue":e[20]||(e[20]=a=>ee.value=a),title:"SKU管理",width:"1200px","close-on-click-modal":!1,"destroy-on-close":""},{default:t(()=>[o("div",es,[o("div",ls,[o("div",ts,[e[106]||(e[106]=o("h3",null,"SKU列表",-1)),o("div",as,[l(k,{type:"success",onClick:_t},{default:t(()=>[l(n,null,{default:t(()=>[l(v(aa))]),_:1}),e[103]||(e[103]=i(" 批量生成SKU ",-1))]),_:1}),l(k,{type:"primary",onClick:nt},{default:t(()=>[l(n,null,{default:t(()=>[l(v(re))]),_:1}),e[104]||(e[104]=i(" 添加SKU ",-1))]),_:1}),ne.value.length>1?(r(),z(k,{key:0,type:"warning",onClick:vt},{default:t(()=>[l(n,null,{default:t(()=>[l(v(al))]),_:1}),e[105]||(e[105]=i(" 排序SKU ",-1))]),_:1})):L("",!0)])]),tl((r(),z(Ue,{data:ne.value,stripe:"",border:"",style:{width:"100%"}},{default:t(()=>[l(x,{label:"图片",width:"80",align:"center"},{default:t(({row:a})=>[a.main_image?(r(),z(H,{key:0,size:50,class:"sku-avatar"},{default:t(()=>[o("img",{src:a.main_image,alt:a.sku_name,style:{width:"100%",height:"100%","object-fit":"cover"}},null,8,ss)]),_:2},1024)):(r(),z(H,{key:1,size:50,class:"sku-avatar"},{default:t(()=>[l(n,null,{default:t(()=>[l(v(je))]),_:1})]),_:1}))]),_:1}),l(x,{prop:"sku_code",label:"SKU编码",width:"120"}),l(x,{prop:"sku_name",label:"SKU名称",width:"150"}),l(x,{label:"属性组合","min-width":"200"},{default:t(({row:a})=>[o("div",os,[(r(!0),f(I,null,j(a.attributes,b=>(r(),z(h,{key:b.attribute_name,size:"small",class:"attr-tag"},{default:t(()=>[i(y(b.display_name)+": "+y(b.display_value),1)]),_:2},1024))),128))])]),_:1}),l(x,{prop:"sell_price",label:"销售价格",width:"100",align:"center"},{default:t(({row:a})=>[o("span",ns,"¥"+y(a.sell_price),1)]),_:1}),l(x,{prop:"discount_percent",label:"折扣",width:"80",align:"center"},{default:t(({row:a})=>[a.discount_percent&&a.discount_percent>0?(r(),z(h,{key:0,type:"success",size:"small"},{default:t(()=>[i(y(a.discount_percent)+"% ",1)]),_:2},1024)):(r(),f("span",is,"--"))]),_:1}),l(x,{prop:"stock_quantity",label:"库存",width:"80",align:"center"}),l(x,{prop:"status",label:"状态",width:"100",align:"center"},{default:t(({row:a})=>[l(h,{type:Bl(a.status),size:"small"},{default:t(()=>[i(y(ql(a.status)),1)]),_:2},1032,["type"])]),_:1}),l(x,{label:"操作",width:"150",align:"center"},{default:t(({row:a})=>[l(k,{size:"small",type:"primary",link:"",onClick:b=>it(a)},{default:t(()=>[...e[107]||(e[107]=[i("编辑",-1)])]),_:1},8,["onClick"]),l(k,{size:"small",type:"danger",link:"",onClick:b=>ut(a)},{default:t(()=>[...e[108]||(e[108]=[i("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[Ye,le.value]])])])]),_:1},8,["modelValue"]),l(ge,{modelValue:we.value,"onUpdate:modelValue":e[25]||(e[25]=a=>we.value=a),title:"SKU分层排序",width:"1200px",fullscreen:ue.value,"close-on-click-modal":!1,"destroy-on-close":""},{footer:t(()=>[o("div",Ds,[l(k,{onClick:e[24]||(e[24]=a=>we.value=!1)},{default:t(()=>[...e[111]||(e[111]=[i("取消",-1)])]),_:1}),l(k,{type:"primary",onClick:Ut,loading:Ne.value},{default:t(()=>[...e[112]||(e[112]=[i(" 保存排序 ",-1)])]),_:1},8,["loading"])])]),default:t(()=>[o("div",{class:Be(["sku-sort-container",{fullscreen:ue.value}])},[o("div",us,[l(Xe,{title:"分层排序说明",type:"info",closable:!1,"show-icon":"",style:{"margin-bottom":"20px"}},{default:t(()=>[...e[109]||(e[109]=[o("div",null,[o("p",null,"• 第一层：按属性类型排序（如：size、color）"),o("p",null,"• 第二层：按属性值排序（如：size1、size2、size3）"),o("p",null,"• 拖拽项目可以调整显示顺序")],-1)])]),_:1}),o("div",rs,[l(k,{type:"primary",icon:ue.value?"ScaleToOriginal":"FullScreen",onClick:yt,circle:"",size:"small"},{default:t(()=>[l(n,null,{default:t(()=>[ue.value?(r(),z(v(Vl),{key:0})):(r(),z(v(wl),{key:1}))]),_:1})]),_:1},8,["icon"])])]),o("div",ds,[l(Et,{modelValue:sl.value,"onUpdate:modelValue":e[23]||(e[23]=a=>sl.value=a),type:"card"},{default:t(()=>[l(ml,{label:"属性类型排序",name:"attribute"},{default:t(()=>[o("div",cs,[e[110]||(e[110]=o("div",{class:"section-title"},"拖拽调整属性类型的显示顺序",-1)),o("div",ps,[(r(!0),f(I,null,j(ae.value,(a,b)=>(r(),f("div",{key:a.name,class:"attribute-item",draggable:!0,onDragstart:D=>ht(D,b),onDragover:e[21]||(e[21]=D=>ul(D)),onDrop:D=>Vt(D,b)},[o("div",ms,[o("div",fs,[l(n,null,{default:t(()=>[l(v(al))]),_:1})]),o("div",gs,[o("div",vs,y(a.name),1),o("div",ys,y(a.count)+"个SKU",1)]),o("div",ks,y(b+1),1)])],40,_s))),128))])])]),_:1}),(r(!0),f(I,null,j(ae.value,a=>(r(),z(ml,{key:a.name,label:`${a.name}排序`,name:a.name},{default:t(()=>[o("div",bs,[o("div",hs,y(a.name)+" 属性值排序",1),o("div",Vs,[(r(!0),f(I,null,j(bt(a.name),(b,D)=>(r(),f("div",{key:`${a.name}-${b.value}`,class:"value-item",draggable:!0,onDragstart:ze=>wt(ze,a.name,D),onDragover:e[22]||(e[22]=ze=>ul(ze)),onDrop:ze=>St(ze,a.name,D)},[o("div",Ss,[o("div",Us,[l(n,null,{default:t(()=>[l(v(al))]),_:1})]),o("div",Cs,[o("div",zs,y(b.value),1),o("div",xs,y(b.count)+"个SKU",1)]),o("div",$s,y(D+1),1)])],40,ws))),128))])])]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"])])],2)]),_:1},8,["modelValue","fullscreen"]),l(ge,{modelValue:Ve.value,"onUpdate:modelValue":e[33]||(e[33]=a=>Ve.value=a),title:"批量生成SKU",width:"900px","close-on-click-modal":!1,"destroy-on-close":""},{footer:t(()=>[o("div",Ls,[l(k,{onClick:e[32]||(e[32]=a=>Ve.value=!1)},{default:t(()=>[...e[120]||(e[120]=[i("取消",-1)])]),_:1}),l(k,{type:"primary",onClick:gt,loading:Re.value},{default:t(()=>[i(" 生成 "+y(N.value.length)+" 个SKU ",1)]),_:1},8,["loading"])])]),default:t(()=>[o("div",Ps,[l(Xe,{title:"批量生成说明",type:"info",closable:!1,"show-icon":"",style:{"margin-bottom":"20px"}},{default:t(()=>[...e[113]||(e[113]=[o("div",null,[o("p",null,"• 可以一次性为商品生成多个不同规格的SKU"),o("p",null,"• 系统会自动创建所有规格组合的SKU"),o("p",null,"• 规格值输入：每行输入一个值，系统自动识别"),o("p",null,"• 示例：颜色(红、蓝) × 尺寸(M、L) = 4个SKU")],-1)])]),_:1}),l(fe,{model:V,"label-width":"120px"},{default:t(()=>[l(se,{class:"form-card",shadow:"never"},{header:t(()=>[...e[114]||(e[114]=[o("span",{style:{"font-weight":"600"}},"基础信息",-1)])]),default:t(()=>[l(F,{gutter:20},{default:t(()=>[l(S,{span:12},{default:t(()=>[l(u,{label:"销售价格",required:""},{default:t(()=>[l(A,{modelValue:V.sell_price,"onUpdate:modelValue":e[26]||(e[26]=a=>V.sell_price=a),min:0,precision:2,style:{width:"100%"},onChange:nl},null,8,["modelValue"])]),_:1})]),_:1}),l(S,{span:12},{default:t(()=>[l(u,{label:"原价"},{default:t(()=>[l(A,{modelValue:V.origin_price,"onUpdate:modelValue":e[27]||(e[27]=a=>V.origin_price=a),min:0,precision:2,style:{width:"100%"},onChange:nl},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(F,{gutter:20},{default:t(()=>[l(S,{span:12},{default:t(()=>[l(u,{label:"折扣(%)",prop:"discount_percent"},{default:t(()=>[l(A,{modelValue:V.discount_percent,"onUpdate:modelValue":e[28]||(e[28]=a=>V.discount_percent=a),min:0,max:100,precision:0,style:{width:"100%"},disabled:""},{append:t(()=>[...e[115]||(e[115]=[i("%",-1)])]),_:1},8,["modelValue"]),e[116]||(e[116]=o("div",{class:"form-tip"},"根据销售价和原价自动计算",-1))]),_:1})]),_:1}),l(S,{span:12},{default:t(()=>[l(u,{label:"成本价"},{default:t(()=>[l(A,{modelValue:V.cost_price,"onUpdate:modelValue":e[29]||(e[29]=a=>V.cost_price=a),min:0,precision:2,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(F,{gutter:20},{default:t(()=>[l(S,{span:12},{default:t(()=>[l(u,{label:"库存数量",required:""},{default:t(()=>[l(A,{modelValue:V.stock_quantity,"onUpdate:modelValue":e[30]||(e[30]=a=>V.stock_quantity=a),min:0,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),l(S,{span:12},{default:t(()=>[l(u,{label:"成本价"},{default:t(()=>[l(A,{modelValue:V.cost_price,"onUpdate:modelValue":e[31]||(e[31]=a=>V.cost_price=a),min:0,precision:2,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),l(se,{class:"form-card",shadow:"never",style:{"margin-top":"20px"}},{header:t(()=>[o("div",Ms,[e[118]||(e[118]=o("span",{style:{"font-weight":"600"}},"规格配置",-1)),l(k,{type:"primary",size:"small",onClick:mt},{default:t(()=>[l(n,null,{default:t(()=>[l(v(re))]),_:1}),e[117]||(e[117]=i(" 添加规格 ",-1))]),_:1})])]),default:t(()=>[(r(!0),f(I,null,j(V.specs,(a,b)=>(r(),f("div",{key:b,class:"batch-spec-item"},[l(F,{gutter:10,style:{"margin-bottom":"10px"}},{default:t(()=>[l(S,{span:6},{default:t(()=>[l(c,{modelValue:a.name,"onUpdate:modelValue":D=>a.name=D,placeholder:"规格名称，如：颜色"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(S,{span:14},{default:t(()=>[l(c,{modelValue:a.values,"onUpdate:modelValue":D=>a.values=D,type:"textarea",rows:3,placeholder:`每行输入一个规格值，例如：
红色
蓝色
绿色`,style:{resize:"vertical"}},null,8,["modelValue","onUpdate:modelValue"]),e[119]||(e[119]=o("div",{class:"form-tip"},"每行输入一个规格值，系统会自动识别",-1))]),_:2},1024),l(S,{span:4},{default:t(()=>[l(k,{type:"danger",size:"small",onClick:D=>ft(b)},{default:t(()=>[l(n,null,{default:t(()=>[l(v(qe))]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]))),128)),N.value.length>0?(r(),f("div",Ks,[l(fl,{"content-position":"left"},{default:t(()=>[i("预览生成的SKU ("+y(N.value.length)+"个)",1)]),_:1}),o("div",As,[(r(!0),f(I,null,j(N.value,(a,b)=>(r(),f("div",{key:b,class:"preview-sku-item"},[o("div",Fs,[o("div",Ts,y(a.sku_name),1),o("div",Is,[(r(!0),f(I,null,j(a.attributes,D=>(r(),z(h,{key:D.name,size:"small",class:"spec-tag"},{default:t(()=>[i(y(D.name)+": "+y(D.value),1)]),_:2},1024))),128))])])]))),128))])])):L("",!0)]),_:1})]),_:1},8,["model"])])]),_:1},8,["modelValue"]),l(ge,{modelValue:E.value,"onUpdate:modelValue":e[49]||(e[49]=a=>E.value=a),title:ye.value,width:"800px","close-on-click-modal":!1,"destroy-on-close":""},{footer:t(()=>[o("div",Xs,[l(k,{onClick:e[48]||(e[48]=a=>E.value=!1)},{default:t(()=>[...e[133]||(e[133]=[i("取消",-1)])]),_:1}),l(k,{type:"primary",onClick:dt,loading:ke.value},{default:t(()=>[...e[134]||(e[134]=[i("确定",-1)])]),_:1},8,["loading"])])]),default:t(()=>[l(fe,{model:m,rules:Tl,ref_key:"skuFormRef",ref:be,"label-width":"100px"},{default:t(()=>[l(F,{gutter:20},{default:t(()=>[l(S,{span:12},{default:t(()=>[l(u,{label:"SKU编码",prop:"sku_code"},{default:t(()=>[l(c,{modelValue:m.sku_code,"onUpdate:modelValue":e[34]||(e[34]=a=>m.sku_code=a),placeholder:"自动生成"},null,8,["modelValue"])]),_:1})]),_:1}),l(S,{span:12},{default:t(()=>[l(u,{label:"SKU名称",prop:"sku_name"},{default:t(()=>[l(c,{modelValue:m.sku_name,"onUpdate:modelValue":e[35]||(e[35]=a=>m.sku_name=a),placeholder:"请输入SKU名称"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(F,{gutter:20},{default:t(()=>[l(S,{span:12},{default:t(()=>[l(u,{label:"销售价格",prop:"sell_price"},{default:t(()=>[l(A,{modelValue:m.sell_price,"onUpdate:modelValue":e[36]||(e[36]=a=>m.sell_price=a),min:0,precision:2,style:{width:"100%"},onChange:rl},null,8,["modelValue"])]),_:1})]),_:1}),l(S,{span:12},{default:t(()=>[l(u,{label:"原价",prop:"origin_price"},{default:t(()=>[l(A,{modelValue:m.origin_price,"onUpdate:modelValue":e[37]||(e[37]=a=>m.origin_price=a),min:0,precision:2,style:{width:"100%"},onChange:rl},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(F,{gutter:20},{default:t(()=>[l(S,{span:12},{default:t(()=>[l(u,{label:"折扣(%)",prop:"discount_percent"},{default:t(()=>[l(A,{modelValue:m.discount_percent,"onUpdate:modelValue":e[38]||(e[38]=a=>m.discount_percent=a),min:0,max:100,precision:0,style:{width:"100%"},onChange:xt},{append:t(()=>[...e[121]||(e[121]=[i("%",-1)])]),_:1},8,["modelValue"]),e[122]||(e[122]=o("div",{class:"form-tip"},"输入销售价和原价后自动计算，或手动输入折扣",-1))]),_:1})]),_:1}),l(S,{span:12},{default:t(()=>[l(u,{label:"成本价",prop:"cost_price"},{default:t(()=>[l(A,{modelValue:m.cost_price,"onUpdate:modelValue":e[39]||(e[39]=a=>m.cost_price=a),min:0,precision:2,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(F,{gutter:20},{default:t(()=>[l(S,{span:12},{default:t(()=>[l(u,{label:"库存数量",prop:"stock_quantity"},{default:t(()=>[l(A,{modelValue:m.stock_quantity,"onUpdate:modelValue":e[40]||(e[40]=a=>m.stock_quantity=a),min:0,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),l(S,{span:12},{default:t(()=>[l(u,{label:"预警库存",prop:"warning_stock"},{default:t(()=>[l(A,{modelValue:m.warning_stock,"onUpdate:modelValue":e[41]||(e[41]=a=>m.warning_stock=a),min:0,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(u,{label:"SKU图片",prop:"main_image"},{default:t(()=>[l($l,{"image-url":m.main_image,"onUpdate:imageUrl":e[42]||(e[42]=a=>m.main_image=a),"file-size":2,"file-type":["image/jpg","image/jpeg","image/png","image/gif","image/webp"],drag:!0,width:"120px",height:"120px"},null,8,["image-url"])]),_:1}),l(u,{label:"SKU规格",prop:"attributes"},{default:t(()=>[o("div",js,[l(Xe,{title:"SKU规格设置说明",type:"info",closable:!1,"show-icon":"",style:{"margin-bottom":"16px"}},{default:t(()=>[...e[123]||(e[123]=[o("div",null,[o("p",null,[i("• "),o("strong",null,"每个SKU代表一个具体的商品规格组合")]),o("p",null,"• 一个SKU的同一属性只能设置一个值（如：尺寸只能是M或L，不能同时是两种）"),o("p",null,"• 如需不同规格，请创建多个SKU"),o("p",null,"• 示例：红色M码为一个SKU，红色L码为另一个SKU"),o("p",null,'• 提示：使用"添加SKU"按钮为每个规格组合创建独立的SKU')],-1)])]),_:1}),o("div",Bs,[l(F,{gutter:10},{default:t(()=>[l(S,{span:8},{default:t(()=>[l(c,{modelValue:W.value,"onUpdate:modelValue":e[43]||(e[43]=a=>W.value=a),placeholder:"规格名称，如：尺寸",maxlength:20,"show-word-limit":""},null,8,["modelValue"])]),_:1}),l(S,{span:12},{default:t(()=>[l(c,{modelValue:w.value,"onUpdate:modelValue":e[44]||(e[44]=a=>w.value=a),placeholder:"规格值，如：M",maxlength:200,"show-word-limit":""},null,8,["modelValue"])]),_:1}),l(S,{span:4},{default:t(()=>[l(k,{type:"primary",onClick:at,disabled:!W.value||!w.value},{default:t(()=>[l(n,null,{default:t(()=>[l(v(re))]),_:1}),e[124]||(e[124]=i(" 添加 ",-1))]),_:1},8,["disabled"])]),_:1})]),_:1}),e[125]||(e[125]=o("div",{class:"form-tip",style:{"margin-top":"8px",color:"#909399","font-size":"12px"}}," 提示：每个SKU只能设置一个属性值，如需不同规格请创建多个SKU ",-1))]),C.value.length>0?(r(),f("div",qs,[l(fl,{"content-position":"left"},{default:t(()=>[...e[126]||(e[126]=[i("已添加的规格",-1)])]),_:1}),o("div",Es,[(r(!0),f(I,null,j(C.value,(a,b)=>(r(),f("div",{key:b,class:"spec-item"},[o("div",Rs,[o("span",Ns,y(a.name),1),l(h,{type:"primary",size:"small"},{default:t(()=>[i(y(a.value),1)]),_:2},1024)]),o("div",Os,[l(k,{size:"small",type:"primary",link:"",onClick:D=>ot(b),icon:"Edit"},{default:t(()=>[...e[127]||(e[127]=[i(" 编辑 ",-1)])]),_:1},8,["onClick"]),l(k,{size:"small",type:"danger",link:"",onClick:D=>st(b),icon:"Delete"},{default:t(()=>[...e[128]||(e[128]=[i(" 删除 ",-1)])]),_:1},8,["onClick"])])]))),128))])])):L("",!0)])]),_:1}),l(u,{label:"主图设置",prop:"main_image"},{default:t(()=>[o("div",Js,[o("div",Ws,[l(_l,{modelValue:B.value,"onUpdate:modelValue":e[45]||(e[45]=a=>B.value=a),onChange:ct},{default:t(()=>[l(Ce,{value:"url"},{default:t(()=>[l(n,null,{default:t(()=>[l(v(Sl))]),_:1}),e[129]||(e[129]=i(" URL输入 ",-1))]),_:1}),l(Ce,{value:"upload"},{default:t(()=>[l(n,null,{default:t(()=>[l(v(hl))]),_:1}),e[130]||(e[130]=i(" 文件上传 ",-1))]),_:1})]),_:1},8,["modelValue"])]),B.value==="url"?(r(),f("div",Gs,[l(c,{modelValue:m.main_image,"onUpdate:modelValue":e[46]||(e[46]=a=>m.main_image=a),placeholder:"请输入图片URL地址",clearable:""},{prepend:t(()=>[l(n,null,{default:t(()=>[l(v(Sl))]),_:1})]),_:1},8,["modelValue"]),m.main_image?(r(),f("div",Hs,[l(Rt,{src:m.main_image,fit:"cover",style:{width:"80px",height:"80px","border-radius":"4px"},"preview-src-list":[m.main_image],"preview-teleported":""},{error:t(()=>[o("div",Zs,[l(n,null,{default:t(()=>[l(v(sa))]),_:1}),e[131]||(e[131]=o("span",null,"加载失败",-1))])]),_:1},8,["src","preview-src-list"])])):L("",!0)])):L("",!0),B.value==="upload"?(r(),f("div",Qs,[l($l,{"image-url":m.main_image,"onUpdate:imageUrl":e[47]||(e[47]=a=>m.main_image=a),height:"120px",width:"120px","file-size":2,"file-type":["image/jpeg","image/png","image/gif","image/webp"]},{tip:t(()=>[...e[132]||(e[132]=[o("div",{class:"upload-tip"},"支持 JPG、PNG、GIF、WebP 格式，文件大小不超过 2MB",-1)])]),_:1},8,["image-url"])])):L("",!0)])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),l(ge,{modelValue:ce.value,"onUpdate:modelValue":e[55]||(e[55]=a=>ce.value=a),title:"选择关联仿品",width:"1000px","close-on-click-modal":!1,"destroy-on-close":""},{footer:t(()=>[o("div",vo,[l(k,{onClick:e[54]||(e[54]=a=>ce.value=!1)},{default:t(()=>[...e[140]||(e[140]=[i("取消",-1)])]),_:1}),l(k,{type:"primary",onClick:Tt,disabled:!te.value},{default:t(()=>[...e[141]||(e[141]=[i(" 确定关联 ",-1)])]),_:1},8,["disabled"])])]),default:t(()=>[o("div",Ys,[l(se,{class:"current-product-card",shadow:"never"},{header:t(()=>[...e[135]||(e[135]=[o("span",{style:{"font-weight":"600",color:"#409eff"}},"当前正品商品",-1)])]),default:t(()=>[$.value?(r(),f("div",eo,[$.value.image_urls&&$.value.image_urls[0]?(r(),z(H,{key:0,size:60},{default:t(()=>[o("img",{src:$.value.image_urls[0],alt:$.value.title,style:{width:"100%",height:"100%","object-fit":"cover"}},null,8,lo)]),_:1})):(r(),z(H,{key:1,size:60},{default:t(()=>[l(n,null,{default:t(()=>[l(v(je))]),_:1})]),_:1})),o("div",to,[o("div",ao,y($.value.title),1),o("div",so,"¥"+y($.value.sell_price),1),l(h,{type:"success",size:"small"},{default:t(()=>[...e[136]||(e[136]=[i("正品",-1)])]),_:1})])])):L("",!0)]),_:1}),l(se,{class:"fake-selection-card",shadow:"never"},{header:t(()=>[o("div",oo,[e[138]||(e[138]=o("span",{style:{"font-weight":"600"}},"选择要关联的仿品",-1)),l(k,{type:"primary",size:"small",onClick:jt},{default:t(()=>[l(n,null,{default:t(()=>[l(v(re))]),_:1}),e[137]||(e[137]=i(" 创建新仿品 ",-1))]),_:1})])]),default:t(()=>[o("div",no,[l(c,{modelValue:Fe.value,"onUpdate:modelValue":e[50]||(e[50]=a=>Fe.value=a),placeholder:"搜索仿品商品...",clearable:"",onInput:Kt,style:{width:"300px"}},{prefix:t(()=>[l(n,null,{default:t(()=>[l(v(ll))]),_:1})]),_:1},8,["modelValue"])]),tl((r(),f("div",io,[(r(!0),f(I,null,j(Ke.value,a=>(r(),f("div",{key:a.id,class:Be(["fake-product-card",{active:te.value===a.id}]),onClick:b=>te.value=a.id},[a.image_urls&&a.image_urls[0]?(r(),z(H,{key:0,size:28},{default:t(()=>[o("img",{src:a.image_urls[0],alt:a.title,style:{width:"100%",height:"100%","object-fit":"cover"}},null,8,ro)]),_:2},1024)):(r(),z(H,{key:1,size:28},{default:t(()=>[l(n,null,{default:t(()=>[l(v(je))]),_:1})]),_:1})),o("div",co,[o("div",po,y(a.title),1),o("div",_o,"¥"+y(a.sell_price),1),l(h,{type:"warning",size:"small",style:{padding:"1px 4px","font-size":"10px"}},{default:t(()=>[...e[139]||(e[139]=[i("仿品",-1)])]),_:1})]),o("div",mo,[l(Ce,{value:a.id,modelValue:te.value,"onUpdate:modelValue":e[51]||(e[51]=b=>te.value=b)},null,8,["value","modelValue"])])],10,uo))),128)),!Ae.value&&Ke.value.length===0?(r(),f("div",fo,[l(Nt,{description:"暂无可关联的仿品商品"})])):L("",!0)])),[[Ye,Ae.value]]),Ke.value.length>0?(r(),f("div",go,[l(Le,{"current-page":q.current,"onUpdate:currentPage":e[52]||(e[52]=a=>q.current=a),"page-size":q.size,"onUpdate:pageSize":e[53]||(e[53]=a=>q.size=a),"page-sizes":[12,24,48],total:q.total,layout:"total, sizes, prev, pager, next",onSizeChange:At,onCurrentChange:Ft,small:""},null,8,["current-page","page-size","total"])])):L("",!0)]),_:1})])]),_:1},8,["modelValue"])])}}}),Co=Pl(ko,[["__scopeId","data-v-b28bf7a2"]]);export{Co as default};
