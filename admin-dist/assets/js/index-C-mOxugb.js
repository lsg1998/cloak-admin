import{d as D,h as c,P as U,at as W,au as P,av as Q,aw as R,Z,r,Q as j,c as w,o as _,b as a,w as o,F as q,f as G,g,a as l,z as H,y as J,t as p,W as K,e as x,u as X,ax as ee,M as te,N as k}from"./index-DsqJDd-_.js";import"./index-BpCvQqaw.js";import{O as ae,a as oe,g as se}from"./order-b0MBQhpm.js";import{aU as z}from"./installCanvasRenderer-Bf4uGEF_.js";import{_ as le}from"./_plugin-vue_export-helper-DlAUqK2U.js";const re={class:"order-statistics"},ne={class:"stat-content"},ie={class:"stat-info"},ce={class:"stat-value"},de={class:"stat-label"},ue={class:"chart-header"},_e={class:"table-header"},pe={class:"amount"},me=D({name:"OrderStatistics"}),fe=D({...me,setup(ve){const f=c(!1),m=c([new Date(Date.now()-30*24*60*60*1e3).toISOString().slice(0,10),new Date().toISOString().slice(0,10)]),h=c(),y=c(),O=c(null),d=U([{key:"total",label:"总订单数",value:"0",icon:W,color:"#409EFF"},{key:"amount",label:"总销售额",value:"¥0",icon:P,color:"#67C23A"},{key:"pending",label:"待处理",value:"0",icon:Q,color:"#E6A23C"},{key:"completed",label:"已完成",value:"0",icon:R,color:"#67C23A"}]),b=c([]),A=e=>ae[e]||"info",F=e=>oe[e]||e,L=e=>{d[0].value=e.total_orders.toLocaleString(),d[1].value=`¥${e.total_amount.toLocaleString()}`,d[2].value=e.pending_orders.toLocaleString(),d[3].value=e.completed_orders.toLocaleString()},E=e=>{const t=z(h.value),i={title:{text:"订单趋势",left:"center",textStyle:{fontSize:14,color:"#666"}},tooltip:{trigger:"axis"},legend:{data:["订单数量","销售额"],bottom:0},xAxis:{type:"category",data:e.trend_data.dates},yAxis:[{type:"value",name:"订单数",position:"left"},{type:"value",name:"销售额",position:"right"}],series:[{name:"订单数量",type:"line",data:e.trend_data.order_counts,smooth:!0,itemStyle:{color:"#409EFF"}},{name:"销售额",type:"bar",yAxisIndex:1,data:e.trend_data.amounts,itemStyle:{color:"#67C23A"}}]};t.setOption(i),window.addEventListener("resize",()=>{t.resize()})},Y=e=>{const t=z(y.value),i={title:{text:"订单状态分布",left:"center",textStyle:{fontSize:14,color:"#666"}},tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},legend:{orient:"vertical",left:"left"},series:[{name:"订单状态",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"18",fontWeight:"bold"}},labelLine:{show:!1},data:e.status_distribution.map(n=>({value:n.value,name:n.name,itemStyle:{color:M(n.status)}}))}]};t.setOption(i),window.addEventListener("resize",()=>{t.resize()})},M=e=>({pending:"#E6A23C",confirmed:"#409EFF",processing:"#909399",shipped:"#67C23A",delivered:"#67C23A",cancelled:"#F56C6C",refunded:"#F56C6C"})[e]||"#909399",T=e=>{e&&S()},S=async()=>{f.value=!0;try{const{data:e}=await se({start_date:m.value[0],end_date:m.value[1],limit:10});O.value=e,b.value=e.recent_orders,L(e),await te(),E(e),Y(e),k.success("统计数据加载成功")}catch(e){console.error("加载统计数据失败:",e),k.error("加载统计数据失败")}finally{f.value=!1}};return Z(async()=>{await S()}),(e,t)=>{const i=r("el-icon"),n=r("el-card"),v=r("el-col"),C=r("el-row"),V=r("el-date-picker"),B=r("el-button"),u=r("el-table-column"),I=r("el-tag"),N=r("el-table"),$=j("loading");return _(),w("div",re,[a(C,{gutter:20,class:"stats-cards"},{default:o(()=>[(_(!0),w(q,null,G(d,s=>(_(),g(v,{xs:24,sm:12,md:6,key:s.key},{default:o(()=>[a(n,{class:"stat-card",shadow:"hover"},{default:o(()=>[l("div",ne,[l("div",{class:"stat-icon",style:H({backgroundColor:s.color})},[a(i,{size:24},{default:o(()=>[(_(),g(J(s.icon)))]),_:2},1024)],4),l("div",ie,[l("div",ce,p(s.value),1),l("div",de,p(s.label),1)])])]),_:2},1024)]),_:2},1024))),128))]),_:1}),a(C,{gutter:20,class:"charts-section"},{default:o(()=>[a(v,{xs:24,lg:12},{default:o(()=>[a(n,{class:"chart-card",shadow:"never"},{header:o(()=>[l("div",ue,[t[2]||(t[2]=l("span",null,"订单趋势",-1)),a(V,{modelValue:m.value,"onUpdate:modelValue":t[0]||(t[0]=s=>m.value=s),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",onChange:T,size:"small"},null,8,["modelValue"])])]),default:o(()=>[l("div",{ref_key:"orderTrendChart",ref:h,class:"chart-container"},null,512)]),_:1})]),_:1}),a(v,{xs:24,lg:12},{default:o(()=>[a(n,{class:"chart-card",shadow:"never"},{header:o(()=>[...t[3]||(t[3]=[l("span",null,"订单状态分布",-1)])]),default:o(()=>[l("div",{ref_key:"orderStatusChart",ref:y,class:"chart-container"},null,512)]),_:1})]),_:1})]),_:1}),a(n,{class:"table-card",shadow:"never"},{header:o(()=>[l("div",_e,[t[5]||(t[5]=l("span",null,"最近订单",-1)),a(B,{type:"primary",size:"small",onClick:t[1]||(t[1]=s=>e.$router.push("/order/list"))},{default:o(()=>[t[4]||(t[4]=x(" 查看全部 ",-1)),a(i,{class:"el-icon--right"},{default:o(()=>[a(X(ee))]),_:1})]),_:1})])]),default:o(()=>[K((_(),g(N,{data:b.value,stripe:""},{default:o(()=>[a(u,{prop:"order_number",label:"订单号",width:"180"}),a(u,{prop:"customer_name",label:"客户",width:"120"}),a(u,{prop:"total_amount",label:"金额",width:"100",align:"center"},{default:o(({row:s})=>[l("span",pe,p(s.total_amount)+" "+p(s.currency),1)]),_:1}),a(u,{prop:"status",label:"状态",width:"100",align:"center"},{default:o(({row:s})=>[a(I,{type:A(s.status),size:"small"},{default:o(()=>[x(p(F(s.status)),1)]),_:2},1032,["type"])]),_:1}),a(u,{prop:"created_at",label:"下单时间","show-overflow-tooltip":""})]),_:1},8,["data"])),[[$,f.value]])]),_:1})])}}}),Ce=le(fe,[["__scopeId","data-v-8e6b7f59"]]);export{Ce as default};
